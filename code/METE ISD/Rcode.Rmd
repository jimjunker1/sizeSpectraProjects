---
title: "Parametrized maximum entropy models predict variability of metabolic scaling across tree communities and populations"
author: "Meng Xu"
date: "November 07, 2019"
output: html_document
---
# Upload packages, function and data
```{r}
library(tidyverse)
library(fitdistrplus)
library(truncdist)
library(nleqslv)
library(nloptr)
library(NlcOptim)
library(MASS)
library(xlsx)
library(zipfR)  # calculate upper incomplete gamma function 
library(Hmisc)  # calculate binomial confidence interval
library(sads)   # fit SAD with various models
library(mc2d)   # simulate left-truncated Weibull random numbers
library(PerformanceAnalytics) # make scatterplot for pair-wise variables
library(nlme)   # fit mixed-effect models
library(AICcmodavg)   # compare mixed-effect models by AICc
library(MuMIn)  # calculate AICc weights
library(GGally)
library(ggpubr)

## samplepdf function (written by W. D. Brinda http://blog.quantitations.com/tutorial/2012/11/20/sampling-from-an-arbitrary-density. Last accessed on Jun 1, 2019)
endsign <- function(f, sign = 1) {
  b <- sign
  while (sign * f(b) < 0) b <- 10 * b
  return(b)
}

samplepdf <- function(n, pdf, ..., spdf.lower = -Inf, spdf.upper = Inf) {
  vpdf <- function(v) sapply(v, pdf, ...)  # vectorize
  cdf <- function(x) integrate(vpdf, spdf.lower, x)$value
  invcdf <- function(u) {
    subcdf <- function(t) cdf(t) - u
    if (spdf.lower == -Inf) 
      spdf.lower <- endsign(subcdf, -1)
    if (spdf.upper == Inf) 
      spdf.upper <- endsign(subcdf)
    return(uniroot(subcdf, c(spdf.lower, spdf.upper))$root)
  }
  sapply(runif(n), invcdf)
}
## end of samplepdf function

# Black Rock Forest (BRF) dbh data in 2007 (data will be published on Environmental Data Initiative)
oak = read.csv("BRf_NorthSlopeOaks2007.csv",header=T)
nonoak = read.csv("BRf_NorthSlopeNonOaks2007.csv",header=T)

oak_to_bind = data.frame("plot"=oak$Plot,"subplot"=oak$Subplot,"sp"=oak$Species,"dbh"=oak$DBH)
nonoak_to_bind = data.frame("plot"=nonoak$Plot,"subplot"=nonoak$Subplot,"sp"=nonoak$Species,"dbh"=nonoak$DBH)

alltree = as_tibble(rbind(oak_to_bind,nonoak_to_bind))
alltree$subplot = as.character(alltree$subplot)
alltree$subplot[alltree$subplot=="c"]<-"C"
alltree$subplot[alltree$subplot=="C OR S?"]<-"C"
alltree$subplot[alltree$subplot=="e"]<-"E"
alltree$subplot[alltree$subplot=="n"]<-"N"
alltree$subplot[alltree$subplot=="ne"]<-"NE"
alltree$subplot[alltree$subplot=="nw"]<-"NW"
alltree$subplot[alltree$subplot=="s"]<-"S"
alltree$subplot[alltree$subplot=="se"]<-"SE"
alltree$subplot[alltree$subplot=="sw"]<-"SW"
alltree$subplot[alltree$subplot=="w"]<-"W"

alltree$sp = as.character(alltree$sp)
alltree$sp[alltree$sp=="ba"]<-"BA"
alltree$sp[alltree$sp=="bb"]<-"BB"
alltree$sp[alltree$sp=="be"]<-"BE"
alltree$sp[alltree$sp=="bg"]<-"BG"
alltree$sp[alltree$sp=="dw"]<-"DW"
alltree$sp[alltree$sp=="hh"]<-"HH"
alltree$sp[alltree$sp=="hm"]<-"HM"
alltree$sp[alltree$sp=="ph"]<-"PH"
alltree$sp[alltree$sp=="rm"]<-"RM"
alltree$sp[alltree$sp=="sa"]<-"SA"
alltree$sp[alltree$sp=="sb"]<-"SB"
alltree$sp[alltree$sp=="sh"]<-"SH"
alltree$sp[alltree$sp=="sm"]<-"SM"
alltree$sp[alltree$sp=="tp"]<-"TP"
alltree$sp[alltree$sp=="vp"]<-"VP"
alltree$sp[alltree$sp=="wa"]<-"WA"
alltree$sp[alltree$sp=="ws"]<-"WS"

alltree$subplot = as.factor(alltree$subplot)
alltree$sp = as.factor(alltree$sp)
alltree$dbh = as.numeric(as.character(alltree$dbh))
alltree$id = seq(1,nrow(alltree))
alltree = alltree %>% filter(dbh>=2.4 & is.na(dbh)==F)
alltree_csub = alltree %>% filter(subplot=="C")  # take the alive trees in the central subplots only

# Barro Colorado Island (BCI) dbh data in 2015 (data available at Condit et al. (2019a,b))
bci_2015 = read.csv("BCI2015.csv",header=T)
bci_2015_live = bci_2015 %>% filter(Status=="alive")
```
# Models for the community-wide individual size distribution (ISD)
## Parametrized METE (approximate and partially-parametrized community-constrained interspecific metabolic scaling): first solve an approximation of beta using 7.27 (a simplified version of eqn 7.19) in Harte (2011), then use b=2 as the initial guess for the maximum likelihood estimate of b via community-wide ISD
```{r}
# BCI plot
(S_0 = length(unique(bci_2015_live$Latin)))  # total number of species
(N_0 = nrow(bci_2015_live)) # total number of individuals
n_seq = seq(1,N_0)
d_seq = bci_2015_live$DBH
(d_min = min(d_seq))
(d_max = max(d_seq))

BCI_quad = bci_2015_live %>% group_by(Quadrat) %>% summarise(N_0=n(),S_0=n_distinct(Latin))  # abundance and species richness for each quadrat community
beta_quad=BCI_quad %>% group_by(Quadrat) %>% do(beta=nleqslv(x=1/(.$N_0),fn=function (x) sum(exp(-x*seq(1,.$N_0)))/sum((exp(-x*seq(1,.$N_0)))/seq(1,.$N_0))-(.$N_0)/(.$S_0))$x) %>% unnest()  # beta estimate for each quadrat community
bci_2015_live = full_join(bci_2015_live,beta_quad,by="Quadrat")
bci_2015_live = full_join(bci_2015_live,BCI_quad,by="Quadrat")

negLL_com_2 = function(par,S0,N0,be,x,xmin,n){
  b = par[1]  # metabolic scaling exponent
  L2 = S0/(sum((x/xmin)^b)-N0) # lambda_2 by eqn 7.26 in Harte (2011)
  L1 = be-L2  # lambda_1
  # negLL_2 = -n*log(b*L2*beta)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))  # likelihood function from Table 7.3 item 6 (simplified form) in Harte (2011)
  negLL_2 = -n*log(b*L2)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))-sum(log(1-(n+1)*exp(-n*(L1+L2*(x/xmin)^b))+n*exp(-(n+1)*(L1+L2*(x/xmin)^b))))-n*be+n*log((1-exp(-be*n))/(1-exp(-be)))  # semifull likelihood function corresponding to Table 7.3 item 6 (eqn 7.22 + 7.24, omitting sigma) (approximate form) in Harte (2011)
  # negLL_2 = -n*log(b*L2)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))-sum(log(1-(n+1)*exp(-n*(L1+L2*(x/xmin)^b))+n*exp(-(n+1)*(L1+L2*(x/xmin)^b))))+n*(log(exp(-beta)*(1-exp(-beta*n))/(1-exp(-beta))-exp(-(L1+L2*sum((x/xmin)^b)))*(1-exp(-n*(L1+L2*sum((x/xmin)^b))))/(1-exp(-(L1+L2*sum((x/xmin)^b))))))  # full likelihood function corresponding to Table 7.3 item 6 (eqn 7.22 + 7.24) (exact form) in Harte (2011)
    return(negLL_2)
}

bci_result = bci_2015_live %>% group_by(Quadrat) %>% do(b=optim(par = 2,fn=negLL_com_2,S0=mean(.$S_0),N0=mean(.$N_0),be=mean(.$beta),x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10)$par,NLL=optim(par = 2,fn=negLL_com_2,S0=mean(.$S_0),N0=mean(.$N_0),be=mean(.$beta),x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10)$value) %>% unnest()  # solve for b


bci_2015_live_new = full_join(bci_2015_live,bci_result,by="Quadrat")
bci_result_new = bci_2015_live_new %>% group_by(Quadrat) %>% summarise(N_q=mean(N_0),S_q=mean(S_0),beta_q=mean(beta),b_q=mean(b),NLL_q=mean(NLL),L2_q=mean(S_0)/(sum((DBH/min(DBH))^mean(b))-mean(N_0)),L1_q=mean(beta)-mean(S_0)/(sum((DBH/min(DBH))^mean(b))-mean(N_0)),E_q=sum((DBH/min(DBH))^mean(b))) %>% mutate(aicc_pmete=2*1+2*NLL_q+(2*1^2+2*1)/(N_q-1-1)) # AICc for parametrized METE with parameter b
mete_bci = bci_2015_live_new %>% group_by(Quadrat) %>% do(aicc_mete=2*negLL_com_2(par=2,S0=mean(.$S_0),N0=mean(.$N_0),be=mean(.$beta),x=.$DBH,xmin=min(.$DBH),n=mean(.$N_0))) %>% unnest() # AICc for METE with b=2
bci_result_new2 = full_join(bci_result_new,mete_bci,by="Quadrat")

# BRF plot
alltree_csub_plot = alltree_csub %>% filter(plot=="A4")
(S_0 = length(unique(alltree_csub_plot$sp))) # total number of species
(N_0 = nrow(alltree_csub_plot)) # total number of individuals
n_seq = seq(1,N_0)
d_seq = alltree_csub_plot$dbh
(d_min = min(d_seq))
(d_max = max(d_seq))

eqn_beta = function (x) sum(exp(-x*n_seq))/sum((exp(-x*n_seq))/n_seq)-N_0/S_0	# approximate solution of beta by eqn 7.27 (simplified version of eqn 7.19)
sol_beta=nleqslv(x=1/N_0,fn=eqn_beta) # nonlinear equation solver
(beta=sol_beta$x)

negLL_com_2 = function(par,x,xmin,n){
  b = par[1]  # metabolic scaling exponent
  L2 = S_0/(sum((x/xmin)^b)-N_0) # lambda_2 by eqn 7.26
  L1 = beta-L2  # lambda_1
  # negLL_2 = -n*log(b*L2*beta)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))  # likelihood function from Table 7.3 item 6 (simplified form)
  negLL_2 = -n*log(b*L2)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))-sum(log(1-(n+1)*exp(-n*(L1+L2*(x/xmin)^b))+n*exp(-(n+1)*(L1+L2*(x/xmin)^b))))-n*beta+n*log((1-exp(-beta*n))/(1-exp(-beta)))  # semifull likelihood function corresponding to Table 7.3 item 6 (eqn 7.22 + 7.24, omitting sigma) (approximate form)
  # negLL_2 = -n*log(b*L2)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))-sum(log(1-(n+1)*exp(-n*(L1+L2*(x/xmin)^b))+n*exp(-(n+1)*(L1+L2*(x/xmin)^b))))+n*(log(exp(-beta)*(1-exp(-beta*n))/(1-exp(-beta))-exp(-(L1+L2*sum((x/xmin)^b)))*(1-exp(-n*(L1+L2*sum((x/xmin)^b))))/(1-exp(-(L1+L2*sum((x/xmin)^b))))))  # full likelihood function corresponding to Table 7.3 item 6 (eqn 7.22 + 7.24) (exact form)
    return(negLL_2)
}

(isd_c_mle_2 = nlm(negLL_com_2,p=2,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),iterlim=1000,gradtol = 1e-6))  # take initial guess of b (=2) from metabolic scaling theory
(result <- optim(par = 2,fn=negLL_com_2,x=bci_2015_live$DBH,n=length(bci_2015_live$DBH),xmin=min(bci_2015_live$DBH),method="Brent",lower=0,upper=10))

(b_com = result$par)
(L2_com = S_0/(sum((bci_2015_live$DBH/min(bci_2015_live$DBH))^b_com)-N_0))
(L1_com = beta-L2_com)
(E_0 = sum((bci_2015_live$DBH/min(bci_2015_live$DBH))^b_com))
(aicc_pmete = 2*1+2*result$value+(2*1^2+2*1)/(N_0-1-1))     # AICc for parametrized METE with parameter b
(aicc_mete = 2*negLL_com_2(par=2,x=d_seq,xmin=d_min,n=N_0)) # AICc for METE with b=2

b_com_boot = NULL
L2_com_boot = NULL
L1_com_boot = NULL

qmete_ci_func = function(d){
s = 100 # number of simulations (bootstrap samples)
for (i in 1:s){
    bci_2015_live_boot = d[sample(1:nrow(d),nrow(d),replace=T),]
    # bci_2015_live_boot = d
    S_0_boot = length(unique(bci_2015_live_boot$Latin))
    N_0_boot = nrow(bci_2015_live_boot)
    
    eqn_beta_boot=function (x) sum(exp(-x*seq(1,N_0_boot)))/sum((exp(-x*seq(1,N_0_boot)))/seq(1,N_0_boot))-N_0_boot/S_0_boot
    beta_boot = nleqslv(x=1/N_0_boot,fn=eqn_beta_boot)$x
    
    negLL_com_2_boot = function(par,x,xmin){
  b = par[1]  # metabolic scaling exponent
  L2 = S_0_boot/(sum((x/xmin)^b)-N_0_boot) # lambda_2 by eqn 7.26 in Harte (2011)
  L1 = beta_boot-L2  # lambda_1
  negLL_2_boot = -N_0_boot*log(b*L2)+(1-b)*sum(log(x/xmin))+sum(L1+L2*(x/xmin)^b)+sum(log((1-exp(-L1-L2*(x/xmin)^b))^2))-sum(log(1-(N_0_boot+1)*exp(-N_0_boot*(L1+L2*(x/xmin)^b))+N_0_boot*exp(-(N_0_boot+1)*(L1+L2*(x/xmin)^b))))-N_0_boot*beta+N_0_boot*log((1-exp(-beta_boot*N_0_boot))/(1-exp(-beta_boot)))  # semifull likelihood function corresponding to Table 7.3 item 6 (eqn 7.22 + 7.24, omitting sigma) in Harte (2011)
    return(negLL_2_boot)
}
    
    b_com_boot=c(b_com_boot,optim(par=2,negLL_com_2_boot,x=bci_2015_live_boot$DBH,xmin=min(bci_2015_live_boot$DBH),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
    L2_com_boot = c(L2_com_boot,S_0_boot/(sum((bci_2015_live_boot$DBH/min(bci_2015_live_boot$DBH))^b_com_boot[i])-N_0_boot))
    L1_com_boot = c(L1_com_boot,beta_boot-L2_com_boot[i])
}
  my_list = list(b_lower = quantile(b_com_boot,0.025,na.rm=T),b_mid = quantile(b_com_boot,0.5,na.rm=T),b_upper = quantile(b_com_boot,0.975,na.rm=T))
  return(my_list)
}

qmete_ci = bci_2015_live %>% group_by(Quadrat) %>% 
  do(b_quad=qmete_ci_func(.)$b_mid,b_quad_lo=qmete_ci_func(.)$b_lower,b_quad_up=qmete_ci_func(.)$b_upper) %>% unnest()

# quantile(b_com_boot, c(.025, .5, .975),na.rm=T)
# quantile(L1_com_boot, c(.025, .5, .975),na.rm=T)
# quantile(L2_com_boot, c(.025, .5, .975),na.rm=T)
```
## Phenomenological models of community individual size distribution (from Muller-Landau et al. (2006))
### 1. left-truncated exponential distribution
```{r}
# BCI
negLL_com_exp = function(par,x,xmin,n){
  lambda = par[1]  # metabolic scaling exponent
  negLL_exp = -n*log(lambda)-n*lambda+lambda*sum(x/xmin)
  return(negLL_exp)
}

bci_exp = bci_2015_live_new %>% group_by(Quadrat) %>% do(p_exp=optim(par=1,fn=negLL_com_exp,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),method="Brent",lower=0,upper=10)$par,aicc_exp=2*1+2*optim(par=1,fn=negLL_com_exp,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),method="Brent",lower=0,upper=10)$value+(2*1^2+2*1)/(mean(.$N_0)-1-1)) %>% unnest()

# BRF
alltree_csub_plot = alltree_csub %>% filter(plot=="C4")

negLL_com_exp = function(par,x,xmin,n){
  lambda = par[1]  # metabolic scaling exponent
  negLL_exp = -n*log(lambda)-n*lambda+lambda*sum(x/xmin)
  return(negLL_exp)
}

(isd_c_mle_exp = nlm(negLL_com_exp,p=1,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),iterlim=1000,gradtol = 1e-6))
(result <- optim(par = 1,fn=negLL_com_exp,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),method="Brent",lower=0,upper=10))
(aicc_exp = 2*1+2*result$value+(2*1^2+2*1)/(N_0-1-1))

lambda_com_boot = NULL
s = 5000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_csub_plot_boot = alltree_csub_plot[sample(1:nrow(alltree_csub_plot),nrow(alltree_csub_plot),replace=T),]
    lambda_com_boot=c(lambda_com_boot,optim(par=1,negLL_com_exp,x=alltree_csub_plot_boot$dbh,n=length(alltree_csub_plot_boot$dbh),xmin=min(alltree_csub_plot$dbh),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
}
quantile(lambda_com_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(lambda_com_boot,file="CommunityBootSampleResults_lambda_exp.xlsx",sheetName = "C4",append = T)
```
### 2. left-truncated power-law distribution
```{r}
# BCI
negLL_com_pow = function(par,x,xmin,n){
  k = par[1]  # power-law distribution parameter
  negLL_pow = -n*log(k)+(k+1)*sum(log(x/xmin))
  return(negLL_pow)
}

bci_pow = bci_2015_live_new %>% group_by(Quadrat) %>% do(p_pow=optim(par=1,fn=negLL_com_pow,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),method="Brent",lower=0,upper=10)$par,aicc_pow=2*1+2*optim(par=1,fn=negLL_com_pow,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),method="Brent",lower=0,upper=10)$value+(2*1^2+2*1)/(mean(.$N_0)-1-1)) %>% unnest()

# BRF
alltree_csub_plot = alltree_csub %>% filter(plot=="C4")

negLL_com_pow = function(par,x,xmin,n){
  k = par[1]  # power-law distribution parameter
  negLL_pow = -n*log(k)+(k+1)*sum(log(x/xmin))
  return(negLL_pow)
}

(isd_c_mle_pow = nlm(negLL_com_pow,p=2,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),iterlim=1000,gradtol = 1e-6))
(result <- optim(par = 2,fn=negLL_com_pow,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),method="Brent",lower=0,upper=10))
(aicc_pow = 2*1+2*result$value+(2*1^2+2*1)/(N_0-1-1))

k_com_boot = NULL
s = 5000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_csub_plot_boot = alltree_csub_plot[sample(1:nrow(alltree_csub_plot),nrow(alltree_csub_plot),replace=T),]
    k_com_boot=c(k_com_boot,optim(par=2,negLL_com_pow,x=alltree_csub_plot_boot$dbh,n=length(alltree_csub_plot_boot$dbh),xmin=min(alltree_csub_plot_boot$dbh),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
}
quantile(k_com_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(k_com_boot,file="CommunityBootSampleResults_k_pow.xlsx",sheetName = "C4",append = T)
```
### 3. left-truncated Weibull distribution
```{r}
# BCI
negLL_com_wei = function(par,x,xmin,n){
  al = par[1]  # Weibull distribution parameter alpha
  be = par[2]  # Weibull distribution parameter beta
  negLL_wei = -n*log(be)+be*n*log(al)-(be-1)*sum(log(x/xmin))-n*(1/al)^be+sum(((x/xmin)/al)^be)
  return(negLL_wei)
}

bci_wei = bci_2015_live_new %>% group_by(Quadrat) %>% do(p1_wei=optim(par=c(10,2),fn=negLL_com_wei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH))$par[1],p2_wei=optim(par=c(10,2),fn=negLL_com_wei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH))$par[2],aicc_wei=2*2+2*optim(par=c(10,2),fn=negLL_com_wei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH))$value+(2*2^2+2*2)/(mean(.$N_0)-2-1)) %>% unnest()

# BRF
alltree_csub_plot = alltree_csub %>% filter(plot=="C4")

negLL_com_wei = function(par,x,xmin,n){
  al = par[1]  # Weibull distribution parameter alpha
  be = par[2]  # Weibull distribution parameter beta
  negLL_wei = -n*log(be)+be*n*log(al)-(be-1)*sum(log(x/xmin))-n*(1/al)^be+sum(((x/xmin)/al)^be)
  return(negLL_wei)
}

(isd_c_mle_wei = nlm(negLL_com_wei,p=c(10,2),x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),iterlim=1000,gradtol = 1e-6))
(result <- optim(par = c(10,2),fn=negLL_com_wei,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh)))
(aicc_ltwei = 2*2+2*result$value+(2*2^2+2*2)/(N_0-2-1))

al_com_boot = NULL
be_com_boot = NULL
s = 5000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_csub_plot_boot = alltree_csub_plot[sample(1:nrow(alltree_csub_plot),nrow(alltree_csub_plot),replace=T),]
    wei_com_boot = optim(par=c(10,2),negLL_com_wei,x=alltree_csub_plot_boot$dbh,n=length(alltree_csub_plot_boot$dbh),xmin=min(alltree_csub_plot_boot$dbh),control=list(maxit=10000))
    al_com_boot=c(al_com_boot,wei_com_boot$par[1])
    be_com_boot=c(be_com_boot,wei_com_boot$par[2])
}
quantile(al_com_boot, c(.025, .5, .975),na.rm=T)
quantile(be_com_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(al_com_boot,file="CommunityBootSampleResults_al_wei.xlsx",sheetName = "C4",append = T)
# write.xlsx2(be_com_boot,file="CommunityBootSampleResults_be_wei.xlsx",sheetName = "C4",append = T)
```
### 4. left-truncated quasi-Weibull distribution
```{r}
# BCI
negLL_com_qwei = function(par,x,xmin,n){
  qal = par[1]  # quasi-Weibull distribution parameter alpha
  qbe = par[2]  # quasi-Weibull distribution parameter beta
  qga = par[3]  # quasi-Weibull distribution parameter gamma
  negLL_qwei = -n*log(qal+qga)+qal*n*log(qbe)+n*log(Igamma(qal/(qal+qga),(1/qbe)^(qal+qga),lower=F))-(qal-1)*sum(log(x/xmin))+sum(((x/xmin)/qbe)^(qal+qga))
  return(negLL_qwei)
}

bci_qwei = bci_2015_live_new %>% group_by(Quadrat) %>% do(p1_qwei=optim(par=c(2,2,2),fn=negLL_com_qwei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),control=list(maxit=10000))$par[1],p2_qwei=optim(par=c(2,2,2),fn=negLL_com_qwei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),control=list(maxit=10000))$par[2],p3_qwei=optim(par=c(2,2,2),fn=negLL_com_qwei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),control=list(maxit=10000))$par[3],aicc_qwei=2*3+2*optim(par=c(2,2,2),fn=negLL_com_wei,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH),control=list(maxit=10000))$value+(2*3^2+2*3)/(mean(.$N_0)-3-1)) %>% unnest()

bci_quad_com = full_join(bci_result_new2,bci_exp,by="Quadrat")
bci_quad_com = full_join(bci_quad_com,bci_pow,by="Quadrat")
bci_quad_com = full_join(bci_quad_com,bci_wei,by="Quadrat")
bci_quad_com = full_join(bci_quad_com,bci_qwei,by="Quadrat")

bci_quad_com_wt = bci_quad_com %>% group_by(Quadrat) %>% do(wt_pmete=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[1],wt_mete=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[2],wt_exp=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[3],wt_pow=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[4],wt_wei=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[5],wt_qwei=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[6]) %>% unnest()

bci_quad_com_wt_best = bci_quad_com_wt %>% group_by(Quadrat) %>%
  do(wt_best=max(.$wt_pmete,.$wt_mete,.$wt_exp,.$wt_pow,.$wt_wei,.$wt_qwei)) %>%
  unnest()

bci_quad_com_wt_best = full_join(bci_quad_com_wt,bci_quad_com_wt_best,by="Quadrat")

bci_quad_com_wt_best_mod = bci_quad_com_wt_best %>% group_by(Quadrat) %>% do(best_model=ifelse(.$wt_pmete==.$wt_best,"pmete",ifelse(.$wt_mete==.$wt_best,"mete",ifelse(.$wt_exp==.$wt_best,"exp",ifelse(.$wt_pow==.$wt_best,"pow",ifelse(.$wt_wei==.$wt_best,"wei","qwei")))))) %>% unnest()

bci_quad_com_best = full_join(bci_quad_com_wt_best,bci_quad_com_wt_best_mod,by="Quadrat")

bci_quad_com_all = full_join(bci_quad_com,bci_quad_com_best,by="Quadrat")

bci_quad_com_super = bci_quad_com_all %>% group_by(Quadrat) %>% do(super=ifelse(sort(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[2]-min(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei)>2,"super","not super")) %>% unnest()

bci_quad_com_all = full_join(bci_quad_com_all,bci_quad_com_super,by="Quadrat")

# > sum(bci_quad_com_all$best_model=="pmete" & bci_quad_com_all$super=="super")
# [1] 457
# > sum(bci_quad_com_all$best_model=="pmete" & bci_quad_com_all$super=="not super")
# [1] 466
# > sum(bci_quad_com_all$best_model=="wei" & bci_quad_com_all$super=="super")
# [1] 124
# > sum(bci_quad_com_all$best_model=="wei" & bci_quad_com_all$super=="not super")
# [1] 182

# BRF
alltree_csub_plot = alltree_csub %>% filter(plot=="C4")

negLL_com_qwei = function(par,x,xmin,n){
  qal = par[1]  # quasi-Weibull distribution parameter alpha
  qbe = par[2]  # quasi-Weibull distribution parameter beta
  qga = par[3]  # quasi-Weibull distribution parameter gamma
  negLL_qwei = -n*log(qal+qga)+qal*n*log(qbe)+n*log(Igamma(qal/(qal+qga),(1/qbe)^(qal+qga),lower=F))-(qal-1)*sum(log(x/xmin))+sum(((x/xmin)/qbe)^(qal+qga))
  return(negLL_qwei)
}

# (isd_c_mle_qwei = nlm(negLL_com_qwei,p=c(2,2,2),x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),iterlim=1000,gradtol = 1e-6))
(result <- optim(par = c(2,2,2),fn=negLL_com_qwei,x=alltree_csub_plot$dbh,n=length(alltree_csub_plot$dbh),xmin=min(alltree_csub_plot$dbh),control=list(maxit=10000)))
(aicc_qwei = 2*3+2*result$value+(2*3^2+2*3)/(N_0-3-1))

(Weights(c(aicc_pmete,aicc_mete,aicc_exp,aicc_pow,aicc_ltwei,aicc_qwei)))  # calculate AICc weights of 6 models

qal_com_boot = NULL
qbe_com_boot = NULL
qga_com_boot = NULL
s = 5000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_csub_plot_boot = alltree_csub_plot[sample(1:nrow(alltree_csub_plot),nrow(alltree_csub_plot),replace=T),]
    qwei_com_boot = optim(par=c(2,2,2),negLL_com_qwei,x=alltree_csub_plot_boot$dbh,n=length(alltree_csub_plot_boot$dbh),xmin=min(alltree_csub_plot_boot$dbh),control=list(maxit=10000))
    qal_com_boot=c(qal_com_boot,qwei_com_boot$par[1])
    qbe_com_boot=c(qbe_com_boot,qwei_com_boot$par[2])
    qga_com_boot=c(qga_com_boot,qwei_com_boot$par[3])
}
quantile(qal_com_boot, c(.025, .5, .975),na.rm=T)
quantile(qbe_com_boot, c(.025, .5, .975),na.rm=T)
quantile(qga_com_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(qal_com_boot,file="CommunityBootSampleResults_qal_qwei.xlsx",sheetName = "C4",append = T)
# write.xlsx2(qbe_com_boot,file="CommunityBootSampleResults_qbe_qwei.xlsx",sheetName = "C4",append = T)
# write.xlsx2(qga_com_boot,file="CommunityBootSampleResults_qga_qwei.xlsx",sheetName = "C4",append = T)
```
# Models for population-level ISD
## Parametrized METE: extract community-based lambda_1 and lambda_2 from above community-wide fitting, then use mete prediction of species-specific individual size distribution to estimate metabolic scaling rate b
```{r}
# BCI
negLL_sp_pmete_1 = function(par,x,xmin,n){
  b = par[1]  # metabolic scaling exponent
  L2 = 4.097359e-05   # community-level Lagrange multiplier
  negLL = -n*log(b*L2*n)+(1-b)*sum(log(x/xmin))+L2*n*sum((x/xmin)^b-1)  # approximate likelihood function from Table 7.3 item 7
  return(negLL)
}

negLL_sp_mete_1 = function(par,x,xmin,n){
  b = par[1]  # metabolic scaling exponent
  L2 = 1.476158e-05   # community-level Lagrange multiplier
  negLL = -n*log(b*L2*n)+(1-b)*sum(log(x/xmin))+L2*n*sum((x/xmin)^b-1)  # approximate likelihood function from Table 7.3 item 7
  return(negLL)
}

result_bci_sp_pmete_1 = bci_2015_live %>%
  group_by(Latin) %>%
  filter(n()>=100) %>%
  do(b_pmete=optim(par=2,negLL_sp_pmete_1,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par,pmete_nll=optim(par=2,negLL_sp_pmete_1,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10,control=list(maxit=10000))$value) %>% unnest()

result_bci_sp_abd = bci_2015_live %>%
  group_by(Latin)  %>%
  summarise(n_sp = n())  %>%
  filter(n_sp>=100)

result_bci_sp_pmete = full_join(result_bci_sp_pmete_1,result_bci_sp_abd,by="Latin") %>%
  mutate(aicc_pmete=2*1+2*pmete_nll+(2*1^2+2*1)/(n_sp-1-1))

result_bci_sp_mete = bci_2015_live %>%
  group_by(Latin)  %>%
  filter(n()>=100)  %>%
  do(aicc_mete=2*negLL_sp_mete_1(par=2,x=.$DBH,xmin=min(.$DBH),n=length(.$DBH))) %>%
  unnest()

result_bci_sp_1 = full_join(result_bci_sp_pmete,result_bci_sp_mete,by="Latin")

b_pop_boot = NULL

qmete_pop_ci_func = function(d){
s = 100 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_plot_sp_boot = d[sample(1:nrow(d),nrow(d),replace=T),]
    b_pop_boot=c(b_pop_boot,optim(p=2,negLL_sp_pmete_1,x=alltree_plot_sp_boot$DBH,n=length(alltree_plot_sp_boot$DBH),xmin=min(alltree_plot_sp_boot$DBH),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
}
my_list = list(b_lower = quantile(b_pop_boot,0.025,na.rm=T),b_mid = quantile(b_pop_boot,0.5,na.rm=T),b_upper = quantile(b_pop_boot,0.975,na.rm=T))
return(my_list)
}
qmete_pop_ci = bci_2015_live %>% group_by(Latin) %>% filter(n()>=100) %>%
   do(b_quad=qmete_pop_ci_func(.)$b_mid,b_quad_lo=qmete_pop_ci_func(.)$b_lower,b_quad_up=qmete_pop_ci_func(.)$b_upper) %>% unnest()

# BRF
alltree_plot_sp = alltree %>% filter(sp=="RM" & plot=="C4")
negLL_sp_1 = function(par,x,xmin,n,L2){
  b = par[1]  # metabolic scaling exponent
  # negLL = -n*log(b*L2*n)+(1-b)*sum(log(x/xmin))+L2*n*sum((x/xmin)^b)+n*log(exp(-n*L2)-exp(-n*L2*sum((x/xmin)^b)))  # exact likelihood function from eqn 7.25
  negLL = -n*log(b*L2*n)+(1-b)*sum(log(x/xmin))+L2*n*sum((x/xmin)^b-1)  # approximate likelihood function from Table 7.3 item 7
  return(negLL)
}
# (isd_s_mle = nlm(negLL_sp_1,p=2,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),L2=L2_com,iterlim=1000))  # take initial guess of b from metabolic scaling theory
result=optim(par=2,negLL_sp_1,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),L2=L2_com,method="Brent",lower=0,upper=10,control=list(maxit=10000))  # use optim (nelder method) when nlm fails to provide a solution
length(alltree_plot_sp$dbh)
(aicc_pmete = 2*1+2*result$value+(2*1^2+2*1)/(length(alltree_plot_sp$dbh)-1-1)) # aicc for parametrized METE
(aicc_mete = 2*negLL_sp_1(par=2,x=alltree_plot_sp$dbh,xmin=min(alltree_plot_sp$dbh),n=length(alltree_plot_sp$dbh),L2=S_0/(sum((d_seq/d_min)^2)-N_0)))  # aicc for METE

b_pop_boot = NULL
s = 1000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_plot_sp_boot = alltree_plot_sp[sample(1:nrow(alltree_plot_sp),nrow(alltree_plot_sp),replace=T),]
    # b_pop_boot=c(b_pop_boot,nlm(negLL_sp_1,p=2,x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),L2=L2_com,iterlim=1000,gradtol = 1e-6)$estimate)
    b_pop_boot=c(b_pop_boot,optim(p=2,negLL_sp_1,x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),L2=L2_com,method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
}
quantile(b_pop_boot, c(.025, .5, .975),na.rm=T)
# write.xlsx2(b_pop_boot,file="PopulationBootSampleResults_b_semiCISD_approxPISD.xlsx",sheetName ="C4_RO",append = T)
```
## Phenomelogical models of intraspecific individual size distribution (from Muller-Landau et al. (2006))
### 1. left-truncated exponential distribution
```{r}
# BCI
negLL_exp = function(par,x,xmin,n){
  lambda = par[1]  # metabolic scaling exponent
  negLL = -n*log(lambda)-n*lambda+lambda*sum(x/xmin)
  return(negLL)
}

result_bci_sp_exp = bci_2015_live %>%
  group_by(Latin)  %>%
  filter(n()>=100)  %>%
  do(p_exp=optim(par = 1,fn=negLL_exp,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10)$par,aicc_exp=2*1+2*optim(par = 1,fn=negLL_exp,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10)$value+(2*1^2+2*1)/(length(.$DBH)-1-1)) %>%
  unnest()

# BRF
alltree_plot_sp = alltree %>% filter(plot=="C3" & sp=="RO")

negLL_exp = function(par,x,xmin,n){
  lambda = par[1]  # metabolic scaling exponent
  negLL = -n*log(lambda)-n*lambda+lambda*sum(x/xmin)
  return(negLL)
}

# (isd_p_mle_exp = nlm(negLL_exp,p=1,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),iterlim=1000,gradtol = 1e-6))
result <- optim(par = 1,fn=negLL_exp,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),method="Brent",lower=0,upper=10)
(aicc_exp = 2*1+2*result$value+(2*1^2+2*1)/(length(alltree_plot_sp$dbh)-1-1))

lambda_pop_exp_boot = NULL
s = 1000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_plot_sp_boot = alltree_plot_sp[sample(1:nrow(alltree_plot_sp),nrow(alltree_plot_sp),replace=T),]
    lambda_pop_exp_boot=c(lambda_pop_exp_boot,optim(par=1,negLL_exp,x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
}
quantile(lambda_pop_exp_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(lambda_pop_exp_boot,file="PopulationBootSampleResults_lambda_exp.xlsx",sheetName = "C4_RO",append = T)
```
### 2. left-truncated power-law distribution
```{r}
# BCI
negLL_pow = function(par,x,xmin,n){
  k = par[1]  # power-law distribution parameter
  negLL = -n*log(k)+(k+1)*sum(log(x/xmin))
  return(negLL)
}

result_bci_sp_pow = bci_2015_live %>%
  group_by(Latin)  %>%
  filter(n()>=100)  %>%
  do(p_pow=optim(par = 1,fn=negLL_pow,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10)$par,aicc_pow=2*1+2*optim(par = 1,fn=negLL_pow,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),method="Brent",lower=0,upper=10)$value+(2*1^2+2*1)/(length(.$DBH)-1-1)) %>%
  unnest()
# BRF
alltree_plot_sp = alltree %>% filter(plot=="C3" & sp=="RO")

negLL_pow = function(par,x,xmin,n){
  k = par[1]  # power-law distribution parameter
  negLL = -n*log(k)+(k+1)*sum(log(x/xmin))
  return(negLL)
}

# (isd_p_mle_pow = nlm(negLL_pow,p=2,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),iterlim=1000,gradtol = 1e-6))
result <- optim(par = 2,fn=negLL_pow,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),method="Brent",lower=0,upper=10)
(aicc_pow = 2*1+2*result$value+(2*1^2+2*1)/(length(alltree_plot_sp$dbh)-1-1))

k_pop_pow_boot = NULL
s = 1000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_plot_sp_boot = alltree_plot_sp[sample(1:nrow(alltree_plot_sp),nrow(alltree_plot_sp),replace=T),]
    k_pop_pow_boot=c(k_pop_pow_boot,optim(par=2,negLL_pow,x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),method="Brent",lower=0,upper=10,control=list(maxit=10000))$par)
}
quantile(k_pop_pow_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(k_pop_pow_boot,file="PopulationBootSampleResults_k_pow.xlsx",sheetName = "C4_RO",append = T)
```
### 3. left-truncated Weibull distribution (equivalent to Table 7.3 item 7 in Harte (2011))
```{r}
# BCI
negLL_wei = function(par,x,n,xmin){
  a = par[1]  # scale parameter
  b = par[2]  # shape parameter
  negll = -n*log(b)+n*b*log(a)+(1-b)*sum(log(x/xmin))+sum(((x/xmin)/a)^b)-n*(1/a)^b
  return(negll)
}

result_bci_sp_wei = bci_2015_live %>%
  group_by(Latin)  %>%
  filter(n()>=100)  %>%
  do(p1_wei=optim(par=c(10,2),fn=negLL_wei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$par[1],p2_wei=optim(par=c(10,2),fn=negLL_wei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$par[2],aicc_wei=2*2+2*optim(par=c(10,2),fn=negLL_wei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$value+(2*2^2+2*2)/(length(.$DBH)-2-1)) %>%
  unnest()
# BRF
alltree_plot_sp = alltree %>% filter(plot=="C3" & sp=="RO")

negLL_wei = function(par,x,n,xmin){
  a = par[1]  # scale parameter
  b = par[2]  # shape parameter
  negll = -n*log(b)+n*b*log(a)+(1-b)*sum(log(x/xmin))+sum(((x/xmin)/a)^b)-n*(1/a)^b
  return(negll)
}

# equivalent method below using maximum likelihood optimization function nlm
# (ltw_mle = nlm(negLL_wei,p=c(10,2),x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),iterlim=500))
result=optim(par=c(10,2),negLL_wei,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),control=list(maxit=10000))  # use optim (nelder method) when nlm fails to provide a solution
(aicc_wei = 2*2+2*result$value+(2*2^2+2*2)/(length(alltree_plot_sp$dbh)-2-1))

a_pop_wei_boot = NULL
b_pop_wei_boot = NULL
s = 1000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_plot_sp_boot = alltree_plot_sp[sample(1:nrow(alltree_plot_sp),nrow(alltree_plot_sp),replace=T),]
    # b_pop_wei_boot=c(b_pop_wei_boot,tryCatch(nlm(negLL_LTW,p=c(10,2),x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),iterlim=1000,gradtol = 1e-6)$estimate[2],error=function(e) NA))
    result = optim(par=c(10,2),negLL_wei,x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),control=list(maxit=10000))
    a_pop_wei_boot=c(a_pop_wei_boot,result$par[1])
    b_pop_wei_boot=c(b_pop_wei_boot,result$par[2])
}
quantile(a_pop_wei_boot, c(.025, .5, .975),na.rm=T)
quantile(b_pop_wei_boot, c(.025, .5, .975),na.rm=T)
# write.xlsx2(a_pop_wei_boot,file="PopulationWeibullBootSampleResults_al_wei.xlsx",sheetName = "C4_RO",append = T)
# write.xlsx2(b_pop_wei_boot,file="PopulationWeibullBootSampleResults_be_wei.xlsx",sheetName = "C4_RO",append = T)
# n = length(alltree_plot_sp$dbh)
# d = alltree_plot_sp$dbh
# dmin = min(alltree_plot_sp$dbh)
# 
# eqn_b = function(x){
#   1/x-sum(((d/dmin)^x)*log(d/dmin))/(sum((d/dmin)^x-1))+(1/n)*sum(log(d/dmin))  # explicit solution of b (eqn 9 in Kizilersu, Kreer and Thomas 2016)
# }
# (b_mle <- uniroot(eqn_b, c(-1,1))$root)
# # solve for a and b using analytic equations
# (a_mle = ((1/n)*sum(d^b_mle-dmin^b_mle))^(1/b_mle))   # eqn 7 in Kizilersu, Kreer and Thomas 2016
```
### 4. left-truncated quasi-Weibull distribution
```{r}
#BCI
negLL_qwei = function(par,x,xmin,n){
  qal = par[1]  # quasi-Weibull distribution parameter alpha
  qbe = par[2]  # quasi-Weibull distribution parameter beta
  qga = par[3]  # quasi-Weibull distribution parameter gamma
  negLL = -n*log(qal+qga)+qal*n*log(qbe)+n*log(Igamma(qal/(qal+qga),(1/qbe)^(qal+qga),lower=F))-(qal-1)*sum(log(x/xmin))+sum(((x/xmin)/qbe)^(qal+qga))
  return(negLL)
}

result_bci_sp_qwei = bci_2015_live %>%
  group_by(Latin)  %>%
  filter(n()>=100)  %>%
  do(p1_qwei=optim(par=c(2,2,2),fn=negLL_qwei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$par[1],p2_qwei=optim(par=c(2,2,2),fn=negLL_qwei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$par[2],p3_qwei=optim(par=c(2,2,2),fn=negLL_qwei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$par[3],aicc_qwei=2*3+2*optim(par=c(2,2,2),fn=negLL_qwei,x=.$DBH,n=length(.$DBH),xmin=min(.$DBH),control=list(maxit=10000))$value+(2*3^2+2*3)/(length(.$DBH)-3-1)) %>%
  unnest()

result_bci_sp_2 = full_join(result_bci_sp_1,result_bci_sp_exp,by="Latin")
result_bci_sp_3 = full_join(result_bci_sp_2,result_bci_sp_pow,by="Latin")
result_bci_sp_4 = full_join(result_bci_sp_3,result_bci_sp_wei,by="Latin")
result_bci_sp = full_join(result_bci_sp_4,result_bci_sp_qwei,by="Latin")

result_bci_sp_wt = result_bci_sp %>% group_by(Latin) %>% do(wt_pmete=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[1],wt_mete=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[2],wt_exp=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[3],wt_pow=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[4],wt_wei=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[5],wt_qwei=Weights(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[6]) %>% unnest()

result_bci_sp_wt_best = result_bci_sp_wt %>% group_by(Latin) %>%
  do(wt_best=max(.$wt_pmete,.$wt_mete,.$wt_exp,.$wt_pow,.$wt_wei,.$wt_qwei)) %>%
  unnest()

result_bci_sp_wt_best = full_join(result_bci_sp_wt,result_bci_sp_wt_best,by="Latin")

result_bci_sp_wt_best_mod = result_bci_sp_wt_best %>% group_by(Latin) %>% do(best_model=ifelse(.$wt_pmete==.$wt_best,"pmete",ifelse(.$wt_mete==.$wt_best,"mete",ifelse(.$wt_exp==.$wt_best,"exp",ifelse(.$wt_pow==.$wt_best,"pow",ifelse(.$wt_wei==.$wt_best,"wei","qwei")))))) %>% unnest()

result_bci_sp_best = full_join(result_bci_sp_wt_best,result_bci_sp_wt_best_mod,by="Latin")

result_bci_sp_all = full_join(result_bci_sp,result_bci_sp_best,by="Latin")

result_bci_sp_super = result_bci_sp_all %>% group_by(Latin) %>% do(super=ifelse(sort(c(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei))[2]-min(.$aicc_pmete,.$aicc_mete,.$aicc_exp,.$aicc_pow,.$aicc_wei,.$aicc_qwei)>2,"super","not super")) %>% unnest()

result_bci_sp_all = full_join(result_bci_sp_all,result_bci_sp_super,by="Latin")

# write.csv(result_bci_sp_all,"BCI_sp_modelfit.csv")
 
# BRF
alltree_plot_sp = alltree %>% filter(plot=="C3" & sp=="RO")

negLL_qwei = function(par,x,xmin,n){
  qal = par[1]  # quasi-Weibull distribution parameter alpha
  qbe = par[2]  # quasi-Weibull distribution parameter beta
  qga = par[3]  # quasi-Weibull distribution parameter gamma
  negLL = -n*log(qal+qga)+qal*n*log(qbe)+n*log(Igamma(qal/(qal+qga),(1/qbe)^(qal+qga),lower=F))-(qal-1)*sum(log(x/xmin))+sum(((x/xmin)/qbe)^(qal+qga))
  return(negLL)
}

# (isd_c_mle_qwei = nlm(negLL_com_qwei,p=c(2,2,2),x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),iterlim=1000,gradtol = 1e-6))
result <- optim(par = c(2,2,2),fn=negLL_qwei,x=alltree_plot_sp$dbh,n=length(alltree_plot_sp$dbh),xmin=min(alltree_plot_sp$dbh),control=list(maxit=10000))
(aicc_qwei = 2*3+2*result$value+(2*3^2+2*3)/(length(alltree_plot_sp$dbh)-3-1))

(Weights(c(aicc_pmete,aicc_mete,aicc_exp,aicc_pow,aicc_wei,aicc_qwei)))  # calculate AICc weights of 6 models

qal_pop_qwei_boot = NULL
qbe_pop_qwei_boot = NULL
qga_pop_qwei_boot = NULL
s = 1000 # number of simulations (bootstrap samples)
for (i in 1:s){
    alltree_plot_sp_boot = alltree_plot_sp[sample(1:nrow(alltree_plot_sp),nrow(alltree_plot_sp),replace=T),]
    qwei_pop_boot = optim(par=c(2,2,2),negLL_qwei,x=alltree_plot_sp_boot$dbh,n=length(alltree_plot_sp_boot$dbh),xmin=min(alltree_plot_sp_boot$dbh),control=list(maxit=10000))
    qal_pop_qwei_boot=c(qal_pop_qwei_boot,qwei_pop_boot$par[1])
    qbe_pop_qwei_boot=c(qbe_pop_qwei_boot,qwei_pop_boot$par[2])
    qga_pop_qwei_boot=c(qga_pop_qwei_boot,qwei_pop_boot$par[3])
}
quantile(qal_pop_qwei_boot, c(.025, .5, .975),na.rm=T)
quantile(qbe_pop_qwei_boot, c(.025, .5, .975),na.rm=T)
quantile(qga_pop_qwei_boot, c(.025, .5, .975),na.rm=T)

# write.xlsx2(qal_pop_qwei_boot,file="PopulationBootSampleResults_qal_qwei.xlsx",sheetName = "C4_RO",append = T)
# write.xlsx2(qbe_pop_qwei_boot,file="PopulationBootSampleResults_qbe_qwei.xlsx",sheetName = "C4_RO",append = T)
# write.xlsx2(qga_pop_qwei_boot,file="PopulationBootSampleResults_qga_qwei.xlsx",sheetName = "C4_RO",append = T)
```
# Modeling variations in b
## Simulation models with various S_0 and N_0
```{r}
### Step 1: suppose S_0 as a Poisson random variable. calculate parameter lambda as the average of 12 subplot community species richness (number of unique species in each subplot)
sp_rich = alltree_csub %>% group_by(plot) %>% summarise(richness=n_distinct(sp),abd_total=length(dbh))
lambda = median(sp_rich$richness);total_abd_md=median(sp_rich$abd_total)

#### compare Poisson model with data and normal model
fit.norm=fitdist(sp_rich$richness,"norm")
fit.pois=fitdist(sp_rich$richness,"pois")
ks.test(sp_rich$richness,"ppois",lambda=fit.pois$estimate)
ks.test(sp_rich$richness,"pnorm",mean=fit.norm$estimate['mean'],sd=fit.norm$estimate['sd'])
(fit.norm.aicc=fit.norm$aic+(2*2^2+2*2)/(12-2-1))
(fit.pois.aicc=fit.pois$aic+(2*1^2+1*2)/(12-1-1))

### Step 2: suppose n_j (j=1,2,...,S_0) follow a log-series distribution
sp_abd = alltree_csub %>% group_by(plot,sp) %>% summarise(abd_sp = n()) %>% ungroup() %>% arrange(plot,abd_sp) %>% mutate(order = row_number())
ggplot(sp_abd,aes(-order,abd_sp))+geom_bar(stat="identity")+facet_wrap(~plot,scales="free")+scale_x_continuous(breaks = -sp_abd$order,labels = sp_abd$sp,expand=c(0,0))+theme(axis.title=element_text(size=14),axis.text.x=element_text(angle=45))+labs(x="species",y="number of trees",cex=1.5)

#### compare four competing models of SAD for each plot
alltree_csub_plot = alltree_csub %>% filter(plot=="A3")
sp_abd = alltree_csub_plot %>% group_by(sp) %>% summarise(abd_sp=n()) %>% ungroup() %>% arrange(-abd_sp) %>% mutate(order=row_number())
sad_logs = fitsad(sp_abd$abd_sp,sad="ls")
sad_nb = fitsad(sp_abd$abd_sp,sad="nbinom")
sad_pln = fitsad(sp_abd$abd_sp,sad="poilog")
sad_zipf = fitrad(sp_abd$abd_sp,rad="zipf")
AICctab(sad_logs, sad_nb, sad_zipf, sad_pln, nobs=length(sp_abd$abd_sp), weights=TRUE)

alpha_logs_md = median(c(3.769317,2.940115,2.129773,2.554062,4.302348,2.903779,2.914719,1.095643,2.765129,1.546304,2.765129,2.290594))  # median of alpha of log series fit to sad in each of 12 plot 

#### mle of Weibull alpha and beta for each plot and each species
alpha_wei_BB = c(2.102415,3.092030,2.524625,2.155874)
beta_wei_BB = c(1.720339,1.661206,1.514095,1.402434)

alpha_wei_BE = c(0.5895321)
beta_wei_BE = c(0.4789815)

alpha_wei_BG = c(2.370114,1.321315,2.871910,2.408508,1.849078)
beta_wei_BG = c(1.254709,1.140842,1.180397,1.864105,1.037458)

alpha_wei_BO = c(2.570006,0.971211)
beta_wei_BO = c(3.470214,1.828624)

alpha_wei_RO = c(1.957329,2.428443,3.374498,9.351228,3.089733,2.101412,7.677649,3.2683686,2.141671,1.940132,2.099587,3.8906190)
beta_wei_RO = c(5.178310,4.530740,3.580272,2.751040,5.794737,4.774965,3.714760,0.8478008,4.188993,5.021362,3.486228,0.8078659)

alpha_wei_SM = c(2.847681,5.170375e-18,1.262792e-06,0.03994191,5.020038)
beta_wei_SM = c(1.013207,8.190525e-02,1.487059e-01,0.35054134,1.322610)

alpha_wei_WO = c(1.276267,1.8711206,8.869936)
beta_wei_WO = c(4.221170,0.7514602,2.327280)

alpha_wei_CO = c(6.481476,3.069216,7.572749,6.376294,4.270184,6.920126,1.428554,7.583264)
beta_wei_CO = c(1.613095,2.990917,3.635706,1.492998,2.968223,1.098824,3.635858,1.540256)

alpha_wei_RM = c(1.345680,2.679557,0.9613768,1.758613,0.4770594,2.575398,1.396749)
beta_wei_RM = c(1.024168,1.951610,0.8590239,1.909059,0.8125715,1.906675,1.361598)

par_wei_md = data.frame(species=c("BB","BE","BG","BO","RO","SM","WO","CO","RM"),alpha_wei_md=c(median(alpha_wei_BB),median(alpha_wei_BE),median(alpha_wei_BG),median(alpha_wei_BO),median(alpha_wei_RO),median(alpha_wei_SM),median(alpha_wei_WO),median(alpha_wei_CO),median(alpha_wei_RM)),beta_wei_md=c(median(beta_wei_BB),median(beta_wei_BE),median(beta_wei_BG),median(beta_wei_BO),median(beta_wei_RO),median(beta_wei_SM),median(beta_wei_WO),median(beta_wei_CO),median(beta_wei_RM)))

### Step 3: simulate S_0, N_0, and dbh within a community, which is fitted by the community ISD predictions from METE
S_0_sim_all = NULL
N_0_sim_all = NULL
n_0_sim_all = NULL
b_sim_com_all = NULL
b_sim_pop_all = NULL

for (s in 1:5000){
(S_0_sim = rpois(1,lambda)) # Possion random number of distinct species
  if (S_0_sim == 0){
    N_0_sim = 0
    n_0_sim = 0
    b_sim_com = NA
    b_sim_pop = NA
  }
  else {
(sp_abd_sim = sads::rls(S_0_sim,total_abd_md,alpha_logs_md))  # log-series random number of species abundance
(N_0_sim = sum(sp_abd_sim)) # total species abundance
(n_seq_sim = seq(1,N_0_sim))
eqn_beta_sim = function (x) sum(exp(-x*n_seq_sim))/sum((exp(-x*n_seq_sim))/n_seq_sim)-N_0_sim/S_0_sim	# approximate solution of beta by eqn 7.27 (simplified version of eqn 7.19)
sol_beta_sim=nleqslv(x=1/N_0_sim,fn=eqn_beta_sim) # nonlinear equation solver
(beta_sim=sol_beta_sim$x)

negLL_com_sim = function(par,x,xmin,n){
  b_sim = par[1]  # metabolic scaling exponent
  L2_sim = S_0_sim/(sum((x/xmin)^b_sim)-N_0_sim) # lambda_2 by eqn 7.26
  L1_sim = beta_sim-L2_sim  # lambda_1
  negLL_com = -n*log(b_sim*L2_sim)+(1-b_sim)*sum(log(x/xmin))+sum(L1_sim+L2_sim*(x/xmin)^b_sim)+sum(log((1-exp(-L1_sim-L2_sim*(x/xmin)^b_sim))^2))-sum(log(1-(n+1)*exp(-n*(L1_sim+L2_sim*(x/xmin)^b_sim))+n*exp(-(n+1)*(L1_sim+L2_sim*(x/xmin)^b_sim))))  # semifull likelihood function corresponding to Table 7.3 item 6 (eqn 7.22 + 7.24, omitting sigma)
    return(negLL_com)
}

dbh_allsp_sim = NULL
for (j in 1:S_0_sim){
par_wei_md_rand = par_wei_md[sample(nrow(par_wei_md),1),]
dbh_allsp_sim = c(dbh_allsp_sim,rtrunc(rweibull,n=sp_abd_sim[j],linf=1,shape=par_wei_md_rand$beta_wei_md,scale=par_wei_md_rand$alpha_wei_md))
}

res_sim_com=optim(par = 2,fn=negLL_com_sim,x=dbh_allsp_sim,n=length(dbh_allsp_sim),xmin=min(dbh_allsp_sim),method="Brent",lower=0,upper=10)
b_sim_com = res_sim_com$par

L2_sim = S_0_sim/(sum((dbh_allsp_sim/min(dbh_allsp_sim))^b_sim_com)-N_0_sim)

# simulate population-level n and dbh, then fitted by eqn 4
n_0_sim = sp_abd_sim[S_0_sim]
    if (n_0_sim==0){
      b_sim_pop = NA
    }
    else {
dbh_onesp_sim = rtrunc(rweibull,n=n_0_sim,linf=1,shape=par_wei_md_rand$beta_wei_md,scale=par_wei_md_rand$alpha_wei_md)

negLL_pop_sim = function(par,x,xmin,n,L2){
  b = par[1]  # metabolic scaling exponent
  negLL_pop = -n*log(b*L2*n)+(1-b)*sum(log(x/xmin))+L2*n*sum((x/xmin)^b-1)  # approximate likelihood function from Table 7.3 item 7
  return(negLL_pop)
}
res_sim_pop=optim(par=2,negLL_pop_sim,x=dbh_onesp_sim,n=length(dbh_onesp_sim),xmin=min(dbh_onesp_sim),L2=L2_sim,method="Brent",lower=0,upper=10,control=list(maxit=10000))
b_sim_pop = res_sim_pop$par
    }
  }
S_0_sim_all = c(S_0_sim_all,S_0_sim)
N_0_sim_all = c(N_0_sim_all,N_0_sim)
n_0_sim_all = c(n_0_sim_all,n_0_sim)
b_sim_com_all = c(b_sim_com_all,b_sim_com)
b_sim_pop_all = c(b_sim_pop_all,b_sim_pop)
}
table_sim_com = tibble(S0_sim=S_0_sim_all,N0_sim=N_0_sim_all,b_sim_com_mle=b_sim_com_all)
table_sim_pop = tibble(n_sim=n_0_sim_all,b_sim_pop_mle=b_sim_pop_all)

# chart.Correlation(table_sim_com, histogram=TRUE, pch=19)
# chart.Correlation(table_sim_pop, histogram=TRUE, pch=19)
# Figure S37 and S38
lowerFn <- function(data, mapping, method = "loess", ...) {
  p <- ggplot(data = data, mapping = mapping) +
    geom_point(colour = "black") +
    geom_smooth(method = method, color = "red", ...)
  p
}

ggpairs(table_sim_com, columns = c("S0_sim","N0_sim", "b_sim_com_mle"), columnLabels = c("simulated number of species (S0)", "simulated number of individuals (N0)", "b from simulated community"),lower = list(continuous = wrap(lowerFn, method = "loess",se=FALSE)),  diag = list(continuous = wrap("densityDiag", colour = "black")),  upper = list(continuous = wrap("cor", size = 10)))

ggpairs(table_sim_pop, columns = c("n_sim","b_sim_pop_mle"), columnLabels = c("simulated number of individuals per species (n)", "b from simulated population"),lower = list(continuous = wrap(lowerFn, method = "loess",se=FALSE)),  diag = list(continuous = wrap("densityDiag", colour = "black")),  upper = list(continuous = wrap("cor", size = 10)))

# Figure S35 and S36
b_com_BCI_quad = read.csv("BCI_quadcom_modelfit.csv",header=T)
ggplot(b_com_BCI_quad,aes(x=best_model))+geom_bar()+labs(x="model",y="frequency")
ggplot(b_com_BCI_quad,aes(x=b_q))+geom_histogram(color="black", fill="white")+labs(x="b",y="frequency")
```
## Mixed-effect models with species and spatial scale
```{r}
b_iISD=c(1.40,2.11,1.27,6.069,1.10,1.42,0.87,1.54,1.096,1.73,1.25,2.51,1.39,3.33,2.079,2.11,1.52,0.81,2.025,0.72,1.35,1.45,3.95,0.96,1.64,1.068,1.10,1.071,2.37,1.30,1.71,0.98,0.75,2.085,0.43,2.30,0.74,2.29,0.88,2.28,1.60,0.83,5.13,1.26,0.34,1.35,0.33)  # METE b estimate for iISD (per plot and species pair)
plot_iISD = c("A1","A1","A1","A1","A2","A2","A2","A2","A2","A2","A2","A3","A3","A3","A3","A3","A4","A4","A4","A4","B1","B1","B1","B1","B1","B1","B1","B2","B2","B2","B2","B2","B3","B3","B3","B4","B4","B4","B4","C1","C1","C2","C3","C3","C4","C4","C4")
species_iISD = c("BG","RO","SM","WO","BB","BG","CO","RM","RO","SM","WO","BB","BE","BO","CO","RO","BG","CO","RM","RO","BB","BG","BO","CO","RM","RO","SM","BG","RM","RO","SM","WO","CO","RM","RO","BB","CO","RM","RO","RO","SM","RO","CO","RO","CO","RM","RO")
scale_iISD = c("S","L","S","L","S","S","L","S","L","S","L","S","S","L","L","L","S","L","S","L","S","S","L","L","S","L","S","S","S","L","S","L","L","S","L","S","L","S","L","L","S","L","L","L","L","S","L")
abd_iISD = c(25,41,19,13,44,29,18,19,51,15,12,13,37,16,45,38,20,46,18,47,18,20,10,13,14,33,16,40,16,67,10,14,46,20,62,30,128,35,126,67,15,65,10,81,85,41,104)

iISD_b = tibble(plot=plot_iISD,sp=species_iISD,scale=scale_iISD,abd=abd_iISD,b=b_iISD)
iISD_b_BCI = read.csv("qmete_ci_BCI_sp.csv",header=T)

fig2a=ggplot(iISD_b,aes(x=b_iISD))+geom_histogram(color="#000000", fill="#CC79A7",bins = 10)+geom_vline(xintercept = 1.39, colour="#000000",size=1,linetype="longdash")+labs(x="",y="Frequency")+theme(axis.text=element_text(size=6),axis.title=element_text(size=8))+ annotate("text", x = 3, y = 18, label = "median = 1.39",size = 4)+theme_classic()
fig2b=ggplot(iISD_b_BCI,aes(x=b_quad))+geom_histogram(color="#000000", fill="#CC79A7",bins = 10)+geom_vline(xintercept = 1.81, colour="#000000",size=1,linetype="longdash")+labs(x="b for intraspecific population",y="Frequency")+theme(axis.text=element_text(size=6),axis.title=element_text(size=8))+ annotate("text", x = 4.5, y = 80, label = "median = 1.81",size = 4)+ theme_classic()
ggarrange(fig2a, fig2b, ncol = 1, nrow = 2,labels = c('a', 'b'),font.label = list(size = 14, face = "plain"))
ggsave("Figure 2.pdf",width = 3, height = 6, units = "in",dpi = 600)

glm1 = gls(b ~ scale + abd,method = "ML",data=iISD_b)
glm2 = gls(b ~ scale,method = "ML",data=iISD_b)
glm3 = gls(b ~ abd,method = "ML",data=iISD_b)
summary(glm1)

lmm1 <- lme(b ~ scale + abd, random=~1|sp, data=iISD_b,method="ML")
lmm2 <- lme(b ~ scale + abd, random=~1|plot, data=iISD_b,method="ML")
lmm3 <- lme(b ~ scale + abd, random=list(sp=~1,plot=~1),data=iISD_b,method="ML")

lmm4 <- lme(b ~ scale, random=~1|sp, data=iISD_b,method="ML")
lmm5 <- lme(b ~ scale, random=~1|plot, data=iISD_b,method="ML")
lmm6 <- lme(b ~ scale, random=list(sp=~1,plot=~1),data=iISD_b,method="ML")

lmm7 <- lme(b ~ abd, random=~1|sp, data=iISD_b,method="ML")
lmm8 <- lme(b ~ abd, random=~1|plot, data=iISD_b,method="ML")
lmm9 <- lme(b ~ abd, random=list(sp=~1,plot=~1),data=iISD_b,method="ML")

lmm10 <- lme(b ~ 1, random=~1|sp, data=iISD_b,method="ML")
lmm11 <- lme(b ~ 1, random=~1|plot, data=iISD_b,method="ML")
lmm12 <- lme(b ~ 1, random=list(sp=~1,plot=~1),data=iISD_b,method="ML")

mod_set = list(glm1,glm2,glm3,lmm1,lmm2,lmm3,lmm4,lmm5,lmm6,lmm7,lmm8,lmm9,lmm10,lmm11,lmm12)
mod_set_glm = list(glm1,glm2,glm3)
mod_set_lmm = list(lmm1,lmm2,lmm3,lmm4,lmm5,lmm6,lmm7,lmm8,lmm9,lmm10,lmm11,lmm12)
anova(glm1,glm2,glm3,lmm1,lmm2,lmm3,lmm4,lmm5,lmm6,lmm7,lmm8,lmm9,lmm10,lmm11,lmm12)
aictab(cand.set=mod_set_lmm,sort=T,second.ord = T)

glm1_refit = gls(b ~ scale + abd,method = "REML",data=iISD_b)
glm3_refit = gls(b ~ abd,method = "REML",data=iISD_b)
lmm1_refit = lme(b ~ scale + abd, random=~1|sp, data=iISD_b,method="REML")
lmm2_refit = lme(b ~ scale + abd, random=~1|plot, data=iISD_b,method="REML")
lmm7_refit = lme(b ~ abd, random=~1|sp, data=iISD_b,method="REML")
lmm8_refit = lme(b ~ abd, random=~1|plot, data=iISD_b,method="REML")
summary(lmm1_refit);summary(lmm2_refit);summary(lmm7_refit);summary(lmm8_refit)
```
# Plotting
## Community-level individual size distribution
```{r}
# BCI
pdf("Figure 3.pdf",width=3,height=2.5) 

par(mfrow=c(1,1),pin=c(3,2.5),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

x_bci = bci_2015_live$DBH/min(bci_2015_live$DBH)
x_bci_dbh = seq(min(x_bci),max(x_bci),length=3000000)

plot(sort(x_bci, decreasing=TRUE), 1:length(x_bci), log="xy", xlab="d", ylab=expression(paste("Number of ", trees>=d)),mgp=mgpVals,xlim=c(min(x_bci),max(x_bci)),ylim=c(1,length(x_bci)),cex=1,cex.axis=1,cex.lab=1.3)

fx_bci = function(x){
  b_com = 1.70382
  L1_com = 9.233038e-05
  L2_com = 4.097359e-05
  N_0 = 248835
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2) # parametrized mete community-level isd
  return(pdf_com) 
}

gx_bci = function(x){
  S_0 = 296
  N_0 = 248835
  b_com = 2
  be_com = 0.000133304
  L2_com = S_0/(sum(x_bci^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_bci = function(x){
  al_com = 0.004398291
  be_com = 3.544376870
  ga_com = 0.602548292
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

y_bci_PMETE = (1-cumsum(fx_bci(x_bci_dbh)*(max(x_bci)-min(x_bci))/3000000))*length(x_bci) # parametrized mete prediction
y_bci_METE = (1-cumsum(gx_bci(x_bci_dbh)*(max(x_bci)-min(x_bci))/3000000))*length(x_bci) # mete prediction
y_bci_EXP = exp(-0.2753954*(x_bci_dbh-min(x_bci_dbh)))*length(x_bci)  # exponential distribution
y_bci_POW = ((x_bci_dbh)^(-0.939106))*length(x_bci) # power function distribution
y_bci_WEI = (exp(1/(0.1158758^0.3331203)-(x_bci_dbh/0.1158758)^0.3331203))*length(x_bci) # Weibull distribution
y_bci_QWEI = (1-cumsum(qwei_bci(x_bci_dbh)*(max(x_bci)-min(x_bci))/3000000))*length(x_bci) # quasi_Weibull distribution

lines(x_bci_dbh, y_bci_PMETE, col="#000000",lwd=2) #, lty=5) # black
lines(x_bci_dbh, y_bci_METE, col="#999999",lwd=2) #, lty=5) # grey
lines(x_bci_dbh, y_bci_EXP, col="#D55E00",lwd=2) #, lty=5)  # dark orange
lines(x_bci_dbh, y_bci_POW, col="#009E73",lwd=2) #, lty=5)  # Dark cyan - lime green
lines(x_bci_dbh, y_bci_WEI, col="#CC79A7",lwd=2) #, lty=5)  # Slightly desaturated pink
lines(x_bci_dbh, y_bci_QWEI, col="#0072B2",lwd=2) #, lty=5) # Dark blue
# legend("topright", "BCI", bty="n", inset=inset,cex=1.5)
dev.off()

# BRF
pdf("Figure 1.pdf",width=8.75,height=5.25) 
S0_com_all = c(11,11,8,8,13,10,9,5,7,4,7,8)
N0_com_all = c(66,121,89,56,84,88,61,104,32,19,32,73)
b_com_all = c(1.645942,1.212367,1.746833,1.582128,1.454121,1.332341,1.144735,1.665723,1.73136,1.080575,1.679971,1.288757)
com_emp = tibble(S_0=S0_com_all,N_0=N0_com_all,b=b_com_all)

par(mfrow=c(3,4),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)
# plot A1
x_A1_s = subset(alltree_csub,plot=="A1")$dbh/min(subset(alltree_csub,plot=="A1")$dbh)
x_A1_dbh = seq(min(x_A1_s),max(x_A1_s),length=1000)

plot(sort(x_A1_s, decreasing=TRUE), 1:length(x_A1_s), log="xy", xlab="", ylab=expression( paste("Number of ", trees>=d)),mgp=mgpVals,xlim=c(min(x_A1_s),max(x_A1_s)),ylim=c(1,length(x_A1_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)
# xLim = 10^par("usr")[1:2]
# yLim = 10^par("usr")[3:4]
# logTicks(xLim, yLim, xLabelSmall = c(5, 50, 500))   # Tick marks.

# plot 1-F(x) of individual size in a community requires solving the cumulative integral of the corresponding density function from eqns 7.22 and 7.24 of Harte 2011
fx_A1 = function(x){
  b_com = 1.645942
  L1_com = 0.04305715
  L2_com = 0.01031206
  N_0 = 66
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_A1 = function(x){
  S_0 = 11
  N_0 = 66
  b_com = 2
  be_com = 0.05336921
  L2_com = S_0/(sum(x_A1_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_A1 = function(x){
  al_com = 0.5544081
  be_com = 3.7047643
  ga_com = 0.2884441
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_A1 = Vectorize(fx_A1)
# qwei_A1 = Vectorize(qwei_A1)
y_A1_PMETE = (1-cumsum(fx_A1(x_A1_dbh)*(max(x_A1_s)-min(x_A1_s))/1000))*length(x_A1_s) # parametrized mete prediction
y_A1_METE = (1-cumsum(gx_A1(x_A1_dbh)*(max(x_A1_s)-min(x_A1_s))/1000))*length(x_A1_s) # mete prediction
y_A1_EXP = exp(-0.2821406*(x_A1_dbh-min(x_A1_dbh)))*length(x_A1_s)  # exponential distribution
y_A1_POW = ((x_A1_dbh)^(-0.8311646))*length(x_A1_s) # power function distribution
y_A1_WEI = (exp(1/(2.2941292^0.7314334)-(x_A1_dbh/2.2941292)^0.7314334))*length(x_A1_s) # Weibull distribution
y_A1_QWEI = (1-cumsum(qwei_A1(x_A1_dbh)*(max(x_A1_s)-min(x_A1_s))/1000))*length(x_A1_s) # quasi_Weibull distribution

lines(x_A1_dbh, y_A1_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A1_dbh, y_A1_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A1_dbh, y_A1_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A1_dbh, y_A1_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A1_dbh, y_A1_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A1_dbh, y_A1_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "A1", bty="n", inset=inset,cex=1.8)
# legend(1,6,legend=c("METE","exp","pow","Wei","qWei"),col=c("black","orange","green","red","blue"),lwd=2, ncol=1)

# plot A2
x_A2_s = subset(alltree_csub,plot=="A2")$dbh/min(subset(alltree_csub,plot=="A2")$dbh)
x_A2_dbh = seq(min(x_A2_s),max(x_A2_s),length=1000)

plot(sort(x_A2_s, decreasing=TRUE), 1:length(x_A2_s), log="xy",
     xlab="",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A2_s), max(x_A2_s)), ylim = c(1, length(x_A2_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_A2 = function(x){
  b_com = 1.212367
  L1_com = 0.005799022
  L2_com = 0.01613823
  N_0 = 121
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_A2 = function(x){
  S_0 = 11
  N_0 = 121
  b_com = 2
  be_com = 0.02193725
  L2_com = S_0/(sum(x_A2_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_A2 = function(x){
  al_com = 0.0002012628
  be_com = 0.0283485292
  ga_com = 0.2607116447
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_A2 = Vectorize(fx_A2)
# qwei_A2 = Vectorize(qwei_A2)
y_A2_PMETE = (1-cumsum(fx_A2(x_A2_dbh)*(max(x_A2_s)-min(x_A2_s))/1000))*length(x_A2_s) # parametrized mete prediction
y_A2_METE = (1-cumsum(gx_A2(x_A2_dbh)*(max(x_A2_s)-min(x_A2_s))/1000))*length(x_A2_s) # mete prediction
y_A2_EXP = exp(-0.3128299*(x_A2_dbh-min(x_A2_dbh)))*length(x_A2_s)  # exponential distribution
y_A2_POW = ((x_A2_dbh)^(-1.046679))*length(x_A2_s) # power function distribution
y_A2_WEI = (exp(1/(0.0005881614^0.1992186768)-(x_A2_dbh/0.0005881614)^0.1992186768))*length(x_A2_s) # Weibull distribution
y_A2_QWEI = (1-cumsum(qwei_A2(x_A2_dbh)*(max(x_A2_s)-min(x_A2_s))/1000))*length(x_A2_s) # quasi_Weibull distribution

lines(x_A2_dbh, y_A2_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_dbh, y_A2_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_dbh, y_A2_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_dbh, y_A2_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_dbh, y_A2_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_dbh, y_A2_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "A2", bty="n", inset=inset,cex=1.8)

# plot A3
x_A3_s = subset(alltree_csub,plot=="A3")$dbh/min(subset(alltree_csub,plot=="A3")$dbh)
x_A3_dbh = seq(min(x_A3_s),max(x_A3_s),length=1000)

plot(sort(x_A3_s, decreasing=TRUE), 1:length(x_A3_s), log="xy",
     xlab="",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A3_s), max(x_A3_s)), ylim = c(1, length(x_A3_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_A3 = function(x){
  b_com = 1.746833
  L1_com = 0.0153348
  L2_com = 0.002781908
  N_0 = 89
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_A3 = function(x){
  S_0 = 8
  N_0 = 89
  b_com = 2
  be_com = 0.01811671
  L2_com = S_0/(sum(x_A3_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_A3 = function(x){
  al_com = 0.1089232
  be_com = 18.5641813
  ga_com = 3.0984991
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_A3 = Vectorize(fx_A3)
# qwei_A3 = Vectorize(qwei_A3)
y_A3_PMETE = (1-cumsum(fx_A3(x_A3_dbh)*(max(x_A3_s)-min(x_A3_s))/1000))*length(x_A3_s) # parametrized mete prediction
y_A3_METE = (1-cumsum(gx_A3(x_A3_dbh)*(max(x_A3_s)-min(x_A3_s))/1000))*length(x_A3_s) # mete prediction
y_A3_EXP = exp(-0.1981653*(x_A3_dbh-min(x_A3_dbh)))*length(x_A3_s)  # exponential distribution
y_A3_POW = ((x_A3_dbh)^(-0.6795782))*length(x_A3_s) # power function distribution
y_A3_WEI = (exp(1/(4.6168473^0.9122437)-(x_A3_dbh/4.6168473)^0.9122437))*length(x_A3_s) # Weibull distribution
y_A3_QWEI = (1-cumsum(qwei_A3(x_A3_dbh)*(max(x_A3_s)-min(x_A3_s))/1000))*length(x_A3_s) # quasi_Weibull distribution

lines(x_A3_dbh, y_A3_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A3_dbh, y_A3_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A3_dbh, y_A3_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A3_dbh, y_A3_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A3_dbh, y_A3_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A3_dbh, y_A3_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "A3", bty="n", inset=inset,cex=1.8)

# plot A4
x_A4_s = subset(alltree_csub,plot=="A4")$dbh/min(subset(alltree_csub,plot=="A4")$dbh)
x_A4_dbh = seq(min(x_A4_s),max(x_A4_s),length=1000)

plot(sort(x_A4_s, decreasing=TRUE), 1:length(x_A4_s), log="xy",
     xlab="",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A4_s), max(x_A4_s)), ylim = c(1, length(x_A4_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_A4 = function(x){
  b_com = 1.582128
  L1_com = 0.03075834
  L2_com = 0.007243553
  N_0 = 56
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_A4 = function(x){
  S_0 = 8
  N_0 = 56
  b_com = 2
  be_com = 0.03800189
  L2_com = S_0/(sum(x_A4_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_A4 = function(x){
  al_com = 0.6187275
  be_com = 4.2122699
  ga_com = 0.1852879
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_A4 = Vectorize(fx_A4)
# qwei_A4 = Vectorize(qwei_A4)
y_A4_PMETE = (1-cumsum(fx_A4(x_A4_dbh)*(max(x_A4_s)-min(x_A4_s))/1000))*length(x_A4_s) # parametrized mete prediction
y_A4_METE = (1-cumsum(gx_A4(x_A4_dbh)*(max(x_A4_s)-min(x_A4_s))/1000))*length(x_A4_s) # mete prediction
y_A4_EXP = exp(-0.2209596*(x_A4_dbh-min(x_A4_dbh)))*length(x_A4_s)  # exponential distribution
y_A4_POW = ((x_A4_dbh)^(-0.7389408))*length(x_A4_s) # power function distribution
y_A4_WEI = (exp(1/(3.0404542^0.7340992)-(x_A4_dbh/3.0404542)^0.7340992))*length(x_A4_s) # Weibull distribution
y_A4_QWEI = (1-cumsum(qwei_A4(x_A4_dbh)*(max(x_A4_s)-min(x_A4_s))/1000))*length(x_A4_s) # quasi_Weibull distribution

lines(x_A4_dbh, y_A4_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A4_dbh, y_A4_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A4_dbh, y_A4_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A4_dbh, y_A4_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A4_dbh, y_A4_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A4_dbh, y_A4_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "A4", bty="n", inset=inset,cex=1.8)

# plot B1
x_B1_s = subset(alltree_csub,plot=="B1")$dbh/min(subset(alltree_csub,plot=="B1")$dbh)
x_B1_dbh = seq(min(x_B1_s),max(x_B1_s),length=1000)

plot(sort(x_B1_s, decreasing=TRUE), 1:length(x_B1_s), log="xy",
     xlab="",
     ylab=expression(paste("Number of ", trees>=d)), mgp=mgpVals,
     xlim = c(min(x_B1_s), max(x_B1_s)), ylim = c(1, length(x_B1_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_B1 = function(x){
  b_com = 1.454121
  L1_com = 0.03096479
  L2_com = 0.0178904
  N_0 = 84
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_B1 = function(x){
  S_0 = 13
  N_0 = 84
  b_com = 2
  be_com = 0.04885519
  L2_com = S_0/(sum(x_B1_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_B1 = function(x){
  al_com = 8.857434e-05
  be_com = 3.482404
  ga_com = 6.802908e-01
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_B1 = Vectorize(fx_B1)
# qwei_B1 = Vectorize(qwei_B1)
y_B1_PMETE = (1-cumsum(fx_B1(x_B1_dbh)*(max(x_B1_s)-min(x_B1_s))/1000))*length(x_B1_s) # parametrized mete prediction
y_B1_METE = (1-cumsum(gx_B1(x_B1_dbh)*(max(x_B1_s)-min(x_B1_s))/1000))*length(x_B1_s) # mete prediction
y_B1_EXP = exp(-0.3468685*(x_B1_dbh-min(x_B1_dbh)))*length(x_B1_s)  # exponential distribution
y_B1_POW = ((x_B1_dbh)^(-0.9924965))*length(x_B1_s) # power function distribution
y_B1_WEI = (exp(1/(0.4478669^0.4586477)-(x_B1_dbh/0.4478669)^0.4586477))*length(x_B1_s) # Weibull distribution
y_B1_QWEI = (1-cumsum(qwei_B1(x_B1_dbh)*(max(x_B1_s)-min(x_B1_s))/1000))*length(x_B1_s) # quasi_Weibull distribution

lines(x_B1_dbh, y_B1_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_dbh, y_B1_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_dbh, y_B1_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_dbh, y_B1_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_dbh, y_B1_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_dbh, y_B1_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "B1", bty="n", inset=inset,cex=1.8)

# plot B2
x_B2_s = subset(alltree_csub,plot=="B2")$dbh/min(subset(alltree_csub,plot=="B2")$dbh)
x_B2_dbh = seq(min(x_B2_s),max(x_B2_s),length=1000)

plot(sort(x_B2_s, decreasing=TRUE), 1:length(x_B2_s), log="xy",
     xlab="",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B2_s), max(x_B2_s)), ylim = c(1, length(x_B2_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_B2 = function(x){
  b_com = 1.332341
  L1_com = 0.01706657
  L2_com = 0.01237152
  N_0 = 88
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_B2 = function(x){
  S_0 = 10
  N_0 = 88
  b_com = 2
  be_com = 0.02943809
  L2_com = S_0/(sum(x_B2_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_B2 = function(x){
  al_com = 0.003554904
  be_com = 5.133807780
  ga_com = 0.647653726
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_B2 = Vectorize(fx_B2)
# qwei_B2 = Vectorize(qwei_B2)
y_B2_PMETE = (1-cumsum(fx_B2(x_B2_dbh)*(max(x_B2_s)-min(x_B2_s))/1000))*length(x_B2_s) # parametrized mete prediction
y_B2_METE = (1-cumsum(gx_B2(x_B2_dbh)*(max(x_B2_s)-min(x_B2_s))/1000))*length(x_B2_s) # mete prediction
y_B2_EXP = exp(-0.2589187*(x_B2_dbh-min(x_B2_dbh)))*length(x_B2_s)  # exponential distribution
y_B2_POW = ((x_B2_dbh)^(-0.8742808))*length(x_B2_s) # power function distribution
y_B2_WEI = (exp(1/(0.4723739^0.4188754)-(x_B2_dbh/0.4723739)^0.4188754))*length(x_B2_s) # Weibull distribution
y_B2_QWEI = (1-cumsum(qwei_B2(x_B2_dbh)*(max(x_B2_s)-min(x_B2_s))/1000))*length(x_B2_s) # quasi_Weibull distribution

lines(x_B2_dbh, y_B2_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B2_dbh, y_B2_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B2_dbh, y_B2_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B2_dbh, y_B2_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B2_dbh, y_B2_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B2_dbh, y_B2_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "B2", bty="n", inset=inset,cex=1.8)

# plot B3
x_B3_s = subset(alltree_csub,plot=="B3")$dbh/min(subset(alltree_csub,plot=="B3")$dbh)
x_B3_dbh = seq(min(x_B3_s),max(x_B3_s),length=1000)

plot(sort(x_B3_s, decreasing=TRUE), 1:length(x_B3_s), log="xy",
     xlab="",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B3_s), max(x_B3_s)), ylim = c(1, length(x_B3_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_B3 = function(x){
  b_com = 1.144735
  L1_com = 0.02693191
  L2_com = 0.01520995
  N_0 = 61
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_B3 = function(x){
  S_0 = 9
  N_0 = 61
  b_com = 2
  be_com = 0.04214186
  L2_com = S_0/(sum(x_B3_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_B3 = function(x){
  al_com = 0.000134957
  be_com = 26.292618087
  ga_com = 1.512956454
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_B3 = Vectorize(fx_B3)
# qwei_B3 = Vectorize(qwei_B3)
y_B3_PMETE = (1-cumsum(fx_B3(x_B3_dbh)*(max(x_B3_s)-min(x_B3_s))/1000))*length(x_B3_s) # parametrized mete prediction
y_B3_METE = (1-cumsum(gx_B3(x_B3_dbh)*(max(x_B3_s)-min(x_B3_s))/1000))*length(x_B3_s) # mete prediction
y_B3_EXP = exp(-0.1542677*(x_B3_dbh-min(x_B3_dbh)))*length(x_B3_s)  # exponential distribution
y_B3_POW = ((x_B3_dbh)^(-0.6608143))*length(x_B3_s) # power function distribution
y_B3_WEI = (exp(1/(2.9628762^0.5814931)-(x_B3_dbh/2.9628762)^0.5814931))*length(x_B3_s) # Weibull distribution
y_B3_QWEI = (1-cumsum(qwei_B3(x_B3_dbh)*(max(x_B3_s)-min(x_B3_s))/1000))*length(x_B3_s) # quasi_Weibull distribution

lines(x_B3_dbh, y_B3_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B3_dbh, y_B3_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B3_dbh, y_B3_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B3_dbh, y_B3_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B3_dbh, y_B3_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B3_dbh, y_B3_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "B3", bty="n", inset=inset,cex=1.8)

# plot B4
x_B4_s = subset(alltree_csub,plot=="B4")$dbh/min(subset(alltree_csub,plot=="B4")$dbh)
x_B4_dbh = seq(min(x_B4_s),max(x_B4_s),length=1000)

plot(sort(x_B4_s, decreasing=TRUE), 1:length(x_B4_s), log="xy",
     xlab="",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B4_s), max(x_B4_s)), ylim = c(1, length(x_B4_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_B4 = function(x){
  b_com = 1.665723
  L1_com = -0.00400071
  L2_com = 0.002649025
  N_0 = 104
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_B4 = function(x){
  S_0 = 5
  N_0 = 104
  b_com = 2
  be_com = -0.001351685
  L2_com = S_0/(sum(x_B4_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_B4 = function(x){
  al_com = 2.886853788
  be_com = 0.004016362
  ga_com = -2.554664369
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_B4 = Vectorize(fx_B4)
# qwei_B4 = Vectorize(qwei_B4)
y_B4_PMETE = (1-cumsum(fx_B4(x_B4_dbh)*(max(x_B4_s)-min(x_B4_s))/1000))*length(x_B4_s) # parametrized mete prediction
y_B4_METE = (1-cumsum(gx_B4(x_B4_dbh)*(max(x_B4_s)-min(x_B4_s))/1000))*length(x_B4_s) # mete prediction
y_B4_EXP = exp(-0.2754529*(x_B4_dbh-min(x_B4_dbh)))*length(x_B4_s)  # exponential distribution
y_B4_POW = ((x_B4_dbh)^(-0.8185709))*length(x_B4_s) # power function distribution
y_B4_WEI = (exp(1/(2.3465926^0.7315375)-(x_B4_dbh/2.3465926)^0.7315375))*length(x_B4_s) # Weibull distribution
y_B4_QWEI = (1-cumsum(qwei_B4(x_B4_dbh)*(max(x_B4_s)-min(x_B4_s))/1000))*length(x_B4_s) # quasi_Weibull distribution

lines(x_B4_dbh, y_B4_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B4_dbh, y_B4_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B4_dbh, y_B4_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B4_dbh, y_B4_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B4_dbh, y_B4_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B4_dbh, y_B4_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "B4", bty="n", inset=inset,cex=1.8)

# plot C1
x_C1_s = subset(alltree_csub,plot=="C1")$dbh/min(subset(alltree_csub,plot=="C1")$dbh)
x_C1_dbh = seq(min(x_C1_s),max(x_C1_s),length=1000)

plot(sort(x_C1_s, decreasing=TRUE), 1:length(x_C1_s), log="xy",
     xlab=expression(paste("d")),
     ylab=expression( paste("Number of ", trees>=d)), mgp=mgpVals,
     xlim = c(min(x_C1_s), max(x_C1_s)), ylim = c(1, length(x_C1_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_C1 = function(x){
  b_com = 1.73136
  L1_com = 0.06801613
  L2_com = 0.004071871
  N_0 = 32
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_C1 = function(x){
  S_0 = 7
  N_0 = 32
  b_com = 2
  be_com = 0.072088
  L2_com = S_0/(sum(x_C1_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_C1 = function(x){
  al_com = 0.3530468
  be_com = 22.5455854
  ga_com = 238.8118229
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_C1 = Vectorize(fx_C1)
# qwei_C1 = Vectorize(qwei_C1)
y_C1_PMETE = (1-cumsum(fx_C1(x_C1_dbh)*(max(x_C1_s)-min(x_C1_s))/1000))*length(x_C1_s) # parametrized mete prediction
y_C1_METE = (1-cumsum(gx_C1(x_C1_dbh)*(max(x_C1_s)-min(x_C1_s))/1000))*length(x_C1_s) # mete prediction
y_C1_EXP = exp(-0.1321505*(x_C1_dbh-min(x_C1_dbh)))*length(x_C1_s)  # exponential distribution
y_C1_POW = ((x_C1_dbh)^(-0.54595))*length(x_C1_s) # power function distribution
y_C1_WEI = (exp(1/(8.371149^1.175010)-(x_C1_dbh/8.371149)^1.175010))*length(x_C1_s) # Weibull distribution
y_C1_QWEI = (1-cumsum(qwei_C1(x_C1_dbh)*(max(x_C1_s)-min(x_C1_s))/1000))*length(x_C1_s) # quasi_Weibull distribution

lines(x_C1_dbh, y_C1_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C1_dbh, y_C1_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C1_dbh, y_C1_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C1_dbh, y_C1_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C1_dbh, y_C1_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C1_dbh, y_C1_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "C1", bty="n", inset=inset,cex=1.8)

# plot C2
x_C2_s = subset(alltree_csub,plot=="C2")$dbh/min(subset(alltree_csub,plot=="C2")$dbh)
x_C2_dbh = seq(min(x_C2_s),max(x_C2_s),length=1000)

plot(sort(x_C2_s, decreasing=TRUE), 1:length(x_C2_s), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_C2_s), max(x_C2_s)), ylim = c(1, length(x_C2_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_C2 = function(x){
  b_com = 1.080575
  L1_com = -0.000955934
  L2_com = 0.02725915
  N_0 = 19
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_C2 = function(x){
  S_0 = 4
  N_0 = 19
  b_com = 2
  be_com = 0.02630321
  L2_com = S_0/(sum(x_C2_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_C2 = function(x){
  al_com = 6.151469e-03
  be_com = 2.048118e+01
  ga_com = 2.467664e+02
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_C2 = Vectorize(fx_C2)
# qwei_C2 = Vectorize(qwei_C2)
y_C2_PMETE = (1-cumsum(fx_C2(x_C2_dbh)*(max(x_C2_s)-min(x_C2_s))/1000))*length(x_C2_s) # parametrized mete prediction
y_C2_METE = (1-cumsum(gx_C2(x_C2_dbh)*(max(x_C2_s)-min(x_C2_s))/1000))*length(x_C2_s) # mete prediction
y_C2_EXP = exp(-0.1612304*(x_C2_dbh-min(x_C2_dbh)))*length(x_C2_s)  # exponential distribution
y_C2_POW = ((x_C2_dbh)^(-0.6566523))*length(x_C2_s) # power function distribution
y_C2_WEI = (exp(1/(3.8300891^0.6773887)-(x_C2_dbh/3.8300891)^0.6773887))*length(x_C2_s) # Weibull distribution
y_C2_QWEI = (1-cumsum(qwei_C2(x_C2_dbh)*(max(x_C2_s)-min(x_C2_s))/1000))*length(x_C2_s) # quasi_Weibull distribution

lines(x_C2_dbh, y_C2_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C2_dbh, y_C2_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C2_dbh, y_C2_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C2_dbh, y_C2_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C2_dbh, y_C2_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C2_dbh, y_C2_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "C2", bty="n", inset=inset,cex=1.8)

# plot C3
x_C3_s = subset(alltree_csub,plot=="C3")$dbh/min(subset(alltree_csub,plot=="C3")$dbh)
x_C3_dbh = seq(min(x_C3_s),max(x_C3_s),length=1000)

plot(sort(x_C3_s, decreasing=TRUE), 1:length(x_C3_s), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_C3_s), max(x_C3_s)), ylim = c(1, length(x_C3_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_C3 = function(x){
  b_com = 1.679971
  L1_com = 0.06189702
  L2_com = 0.01019098
  N_0 = 32
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_C3 = function(x){
  S_0 = 7
  N_0 = 32
  b_com = 2
  be_com = 0.072088
  L2_com = S_0/(sum(x_C3_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_C3 = function(x){
  al_com = 1.0558240
  be_com = 3.8684789
  ga_com = -0.1096179
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_C3 = Vectorize(fx_C3)
# gx_C3 = Vectorize(gx_C3)
# qwei_C3 = Vectorize(qwei_C3)
y_C3_PMETE = (1-cumsum(fx_C3(x_C3_dbh)*(max(x_C3_s)-min(x_C3_s))/1000))*length(x_C3_s) # parametrized mete prediction
y_C3_METE = (1-cumsum(gx_C3(x_C3_dbh)*(max(x_C3_s)-min(x_C3_s))/1000))*length(x_C3_s) # mete prediction
y_C3_EXP = exp(-0.2237328*(x_C3_dbh-min(x_C3_dbh)))*length(x_C3_s)  # exponential distribution
y_C3_POW = ((x_C3_dbh)^(-0.7123007))*length(x_C3_s) # power function distribution
y_C3_WEI = (exp(1/(4.60068^1.03396)-(x_C3_dbh/4.60068)^1.03396))*length(x_C3_s) # Weibull distribution
y_C3_QWEI = (1-cumsum(qwei_C3(x_C3_dbh)*(max(x_C3_s)-min(x_C3_s))/1000))*length(x_C3_s) # quasi_Weibull distribution

lines(x_C3_dbh, y_C3_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C3_dbh, y_C3_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C3_dbh, y_C3_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C3_dbh, y_C3_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C3_dbh, y_C3_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C3_dbh, y_C3_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "C3", bty="n", inset=inset,cex=1.8)

# plot C4
x_C4_s = subset(alltree_csub,plot=="C4")$dbh/min(subset(alltree_csub,plot=="C4")$dbh)
x_C4_dbh = seq(min(x_C4_s),max(x_C4_s),length=1000)

plot(sort(x_C4_s, decreasing=TRUE), 1:length(x_C4_s), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_C4_s), max(x_C4_s)), ylim = c(1, length(x_C4_s)),cex=1.5,cex.axis=1.3,cex.lab=1.5)

fx_C4 = function(x){
  b_com = 1.288757
  L1_com = 0.009175526
  L2_com = 0.01568359
  N_0 = 73
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}

gx_C4 = function(x){
  S_0 = 8
  N_0 = 73
  b_com = 2
  be_com = 0.02485911
  L2_com = S_0/(sum(x_C4_s^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  # pdf_com = L2_com*beta*b_com*(x^(b_com-1))*exp(-ga_com)/((1-exp(-ga_com))^2)
  return(pdf_com)
}

qwei_C4 = function(x){
  al_com = 0.001426712
  be_com = 3.818828852
  ga_com = 0.627703492
  pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
  return(pdf_qwei_com)
}

# fx_C4 = Vectorize(fx_C4)
# gx_C4 = Vectorize(gx_C4)
# qwei_C4 = Vectorize(qwei_C4)
y_C4_PMETE = (1-cumsum(fx_C4(x_C4_dbh)*(max(x_C4_s)-min(x_C4_s))/1000))*length(x_C4_s) # parametrized mete prediction
y_C4_METE = (1-cumsum(gx_C4(x_C4_dbh)*(max(x_C4_s)-min(x_C4_s))/1000))*length(x_C4_s) # mete prediction
y_C4_EXP = exp(-0.2891313*(x_C4_dbh-min(x_C4_dbh)))*length(x_C4_s)  # exponential distribution
y_C4_POW = ((x_C4_dbh)^(-0.9141697))*length(x_C4_s) # power function distribution
y_C4_WEI = (exp(1/(0.4061179^0.4177299)-(x_C4_dbh/0.4061179)^0.4177299))*length(x_C4_s) # Weibull distribution
y_C4_QWEI = (1-cumsum(qwei_C4(x_C4_dbh)*(max(x_C4_s)-min(x_C4_s))/1000))*length(x_C4_s) # quasi_Weibull distribution

lines(x_C4_dbh, y_C4_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C4_dbh, y_C4_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C4_dbh, y_C4_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C4_dbh, y_C4_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C4_dbh, y_C4_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C4_dbh, y_C4_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("topright", "C4", bty="n", inset=inset,cex=1.8)
dev.off()
```
## Population-level individual size distribution
### BCI (order=Arecales)
```{r}
result_bci_sp_all = read.csv("BCI_sp_modelfit.csv",header=T)
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Astrocaryum standleyanum
BCI_ASST = subset(bci_2015_live,Latin=="Astrocaryum standleyanum")
x_ASST = BCI_ASST$DBH/min(BCI_ASST$DBH)
length(x_ASST)
x_ASST_dbh = seq(min(x_ASST),max(x_ASST),length=10*length(x_ASST))
result_ASST = subset(result_bci_sp_all,Latin=="Astrocaryum standleyanum")

plot(sort(x_ASST, decreasing=TRUE), 1:length(x_ASST), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ASST), max(x_ASST)), ylim = c(1, length(x_ASST)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ASST = function(x){
  b_pop = result_ASST$b_pmete
  n_pop = result_ASST$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ASST = function(x){
  b_pop = 2
  n_pop = result_ASST$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ASST = function(x){
  al_pop = result_ASST$p1_qwei
  be_pop = result_ASST$p2_qwei
  ga_pop = result_ASST$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ASST_PMETE = (1-cumsum(fx_ASST(x_ASST_dbh)*(max(x_ASST)-min(x_ASST))/length(x_ASST_dbh)))*length(x_ASST) # parametrized mete prediction
y_ASST_METE = (1-cumsum(gx_ASST(x_ASST_dbh)*(max(x_ASST)-min(x_ASST))/length(x_ASST_dbh)))*length(x_ASST) # mete prediction
y_ASST_EXP = exp(-(result_ASST$p_exp)*(x_ASST_dbh-min(x_ASST_dbh)))*length(x_ASST)  # exponential distribution
y_ASST_POW = ((x_ASST_dbh)^(-(result_ASST$p_pow)))*length(x_ASST) # power function distribution
y_ASST_WEI = (exp(1/((result_ASST$p1_wei)^(result_ASST$p2_wei))-(x_ASST_dbh/(result_ASST$p1_wei))^(result_ASST$p2_wei)))*length(x_ASST) # Weibull distribution
y_ASST_QWEI = (1-cumsum(qwei_ASST(x_ASST_dbh)*(max(x_ASST)-min(x_ASST))/length(x_ASST_dbh)))*length(x_ASST) # quasi_Weibull distribution

lines(x_ASST_dbh, y_ASST_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ASST_dbh, y_ASST_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ASST_dbh, y_ASST_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ASST_dbh, y_ASST_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ASST_dbh, y_ASST_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ASST_dbh, y_ASST_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ASST", bty="n",cex=1.5)

#### Bactris major
BCI_BAMA = subset(bci_2015_live,Latin=="Bactris major")
x_BAMA = BCI_BAMA$DBH/min(BCI_BAMA$DBH)
length(x_BAMA)
x_BAMA_dbh = seq(min(x_BAMA),max(x_BAMA),length=10*length(x_BAMA))
result_BAMA = subset(result_bci_sp_all,Latin=="Bactris major")

plot(sort(x_BAMA, decreasing=TRUE), 1:length(x_BAMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_BAMA), max(x_BAMA)), ylim = c(1, length(x_BAMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_BAMA = function(x){
  b_pop = result_BAMA$b_pmete
  n_pop = result_BAMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_BAMA = function(x){
  b_pop = 2
  n_pop = result_BAMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_BAMA = function(x){
  al_pop = result_BAMA$p1_qwei
  be_pop = result_BAMA$p2_qwei
  ga_pop = result_BAMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_BAMA_PMETE = (1-cumsum(fx_BAMA(x_BAMA_dbh)*(max(x_BAMA)-min(x_BAMA))/length(x_BAMA_dbh)))*length(x_BAMA) # parametrized mete prediction
y_BAMA_METE = (1-cumsum(gx_BAMA(x_BAMA_dbh)*(max(x_BAMA)-min(x_BAMA))/length(x_BAMA_dbh)))*length(x_BAMA) # mete prediction
y_BAMA_EXP = exp(-(result_BAMA$p_exp)*(x_BAMA_dbh-min(x_BAMA_dbh)))*length(x_BAMA)  # exponential distribution
y_BAMA_POW = ((x_BAMA_dbh)^(-(result_BAMA$p_pow)))*length(x_BAMA) # power function distribution
y_BAMA_WEI = (exp(1/((result_BAMA$p1_wei)^(result_BAMA$p2_wei))-(x_BAMA_dbh/(result_BAMA$p1_wei))^(result_BAMA$p2_wei)))*length(x_BAMA) # Weibull distribution
y_BAMA_QWEI = (1-cumsum(qwei_BAMA(x_BAMA_dbh)*(max(x_BAMA)-min(x_BAMA))/length(x_BAMA_dbh)))*length(x_BAMA) # quasi_Weibull distribution

lines(x_BAMA_dbh, y_BAMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_BAMA_dbh, y_BAMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_BAMA_dbh, y_BAMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_BAMA_dbh, y_BAMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_BAMA_dbh, y_BAMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_BAMA_dbh, y_BAMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BAMA", bty="n",cex=1.5)

#### Oenocarpus mapora
BCI_OEMA = subset(bci_2015_live,Latin=="Oenocarpus mapora")
x_OEMA = BCI_OEMA$DBH/min(BCI_OEMA$DBH)
length(x_OEMA)
x_OEMA_dbh = seq(min(x_OEMA),max(x_OEMA),length=10*length(x_OEMA))
result_OEMA = subset(result_bci_sp_all,Latin=="Oenocarpus mapora")

plot(sort(x_OEMA, decreasing=TRUE), 1:length(x_OEMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_OEMA), max(x_OEMA)), ylim = c(1, length(x_OEMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_OEMA = function(x){
  b_pop = result_OEMA$b_pmete
  n_pop = result_OEMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_OEMA = function(x){
  b_pop = 2
  n_pop = result_OEMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_OEMA = function(x){
  al_pop = result_OEMA$p1_qwei
  be_pop = result_OEMA$p2_qwei
  ga_pop = result_OEMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_OEMA_PMETE = (1-cumsum(fx_OEMA(x_OEMA_dbh)*(max(x_OEMA)-min(x_OEMA))/length(x_OEMA_dbh)))*length(x_OEMA) # parametrized mete prediction
y_OEMA_METE = (1-cumsum(gx_OEMA(x_OEMA_dbh)*(max(x_OEMA)-min(x_OEMA))/length(x_OEMA_dbh)))*length(x_OEMA) # mete prediction
y_OEMA_EXP = exp(-(result_OEMA$p_exp)*(x_OEMA_dbh-min(x_OEMA_dbh)))*length(x_OEMA)  # exponential distribution
y_OEMA_POW = ((x_OEMA_dbh)^(-(result_OEMA$p_pow)))*length(x_OEMA) # power function distribution
y_OEMA_WEI = (exp(1/((result_OEMA$p1_wei)^(result_OEMA$p2_wei))-(x_OEMA_dbh/(result_OEMA$p1_wei))^(result_OEMA$p2_wei)))*length(x_OEMA) # Weibull distribution
y_OEMA_QWEI = (1-cumsum(qwei_OEMA(x_OEMA_dbh)*(max(x_OEMA)-min(x_OEMA))/length(x_OEMA_dbh)))*length(x_OEMA) # quasi_Weibull distribution

lines(x_OEMA_dbh, y_OEMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_OEMA_dbh, y_OEMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_OEMA_dbh, y_OEMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_OEMA_dbh, y_OEMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_OEMA_dbh, y_OEMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_OEMA_dbh, y_OEMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "OEMA", bty="n",cex=1.5)

#### Socratea exorrhiza
BCI_SOEX = subset(bci_2015_live,Latin=="Socratea exorrhiza")
x_SOEX = BCI_SOEX$DBH/min(BCI_SOEX$DBH)
length(x_SOEX)
x_SOEX_dbh = seq(min(x_SOEX),max(x_SOEX),length=10*length(x_SOEX))
result_SOEX = subset(result_bci_sp_all,Latin=="Socratea exorrhiza")

plot(sort(x_SOEX, decreasing=TRUE), 1:length(x_SOEX), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SOEX), max(x_SOEX)), ylim = c(1, length(x_SOEX)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SOEX = function(x){
  b_pop = result_SOEX$b_pmete
  n_pop = result_SOEX$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SOEX = function(x){
  b_pop = 2
  n_pop = result_SOEX$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SOEX = function(x){
  al_pop = result_SOEX$p1_qwei
  be_pop = result_SOEX$p2_qwei
  ga_pop = result_SOEX$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SOEX_PMETE = (1-cumsum(fx_SOEX(x_SOEX_dbh)*(max(x_SOEX)-min(x_SOEX))/length(x_SOEX_dbh)))*length(x_SOEX) # parametrized mete prediction
y_SOEX_METE = (1-cumsum(gx_SOEX(x_SOEX_dbh)*(max(x_SOEX)-min(x_SOEX))/length(x_SOEX_dbh)))*length(x_SOEX) # mete prediction
y_SOEX_EXP = exp(-(result_SOEX$p_exp)*(x_SOEX_dbh-min(x_SOEX_dbh)))*length(x_SOEX)  # exponential distribution
y_SOEX_POW = ((x_SOEX_dbh)^(-(result_SOEX$p_pow)))*length(x_SOEX) # power function distribution
y_SOEX_WEI = (exp(1/((result_SOEX$p1_wei)^(result_SOEX$p2_wei))-(x_SOEX_dbh/(result_SOEX$p1_wei))^(result_SOEX$p2_wei)))*length(x_SOEX) # Weibull distribution
y_SOEX_QWEI = (1-cumsum(qwei_SOEX(x_SOEX_dbh)*(max(x_SOEX)-min(x_SOEX))/length(x_SOEX_dbh)))*length(x_SOEX) # quasi_Weibull distribution

lines(x_SOEX_dbh, y_SOEX_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SOEX_dbh, y_SOEX_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SOEX_dbh, y_SOEX_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SOEX_dbh, y_SOEX_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SOEX_dbh, y_SOEX_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SOEX_dbh, y_SOEX_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SOEX", bty="n",cex=1.5)
```
### BCI (order=Boraginales)
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Cordia alliodora
BCI_COAL = subset(bci_2015_live,Latin=="Cordia alliodora")
x_COAL = BCI_COAL$DBH/min(BCI_COAL$DBH)
length(x_COAL)
x_COAL_dbh = seq(min(x_COAL),max(x_COAL),length=10*length(x_COAL))
result_COAL = subset(result_bci_sp_all,Latin=="Cordia alliodora")

plot(sort(x_COAL, decreasing=TRUE), 1:length(x_COAL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COAL), max(x_COAL)), ylim = c(1, length(x_COAL)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COAL = function(x){
  b_pop = result_COAL$b_pmete
  n_pop = result_COAL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COAL = function(x){
  b_pop = 2
  n_pop = result_COAL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COAL = function(x){
  al_pop = result_COAL$p1_qwei
  be_pop = result_COAL$p2_qwei
  ga_pop = result_COAL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COAL_PMETE = (1-cumsum(fx_COAL(x_COAL_dbh)*(max(x_COAL)-min(x_COAL))/length(x_COAL_dbh)))*length(x_COAL) # parametrized mete prediction
y_COAL_METE = (1-cumsum(gx_COAL(x_COAL_dbh)*(max(x_COAL)-min(x_COAL))/length(x_COAL_dbh)))*length(x_COAL) # mete prediction
y_COAL_EXP = exp(-(result_COAL$p_exp)*(x_COAL_dbh-min(x_COAL_dbh)))*length(x_COAL)  # exponential distribution
y_COAL_POW = ((x_COAL_dbh)^(-(result_COAL$p_pow)))*length(x_COAL) # power function distribution
y_COAL_WEI = (exp(1/((result_COAL$p1_wei)^(result_COAL$p2_wei))-(x_COAL_dbh/(result_COAL$p1_wei))^(result_COAL$p2_wei)))*length(x_COAL) # Weibull distribution
y_COAL_QWEI = (1-cumsum(qwei_COAL(x_COAL_dbh)*(max(x_COAL)-min(x_COAL))/length(x_COAL_dbh)))*length(x_COAL) # quasi_Weibull distribution

lines(x_COAL_dbh, y_COAL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COAL_dbh, y_COAL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COAL_dbh, y_COAL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COAL_dbh, y_COAL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COAL_dbh, y_COAL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COAL_dbh, y_COAL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COAL", bty="n",cex=1.5)

#### Cordia bicolor
BCI_COBI = subset(bci_2015_live,Latin=="Cordia bicolor")
x_COBI = BCI_COBI$DBH/min(BCI_COBI$DBH)
length(x_COBI)
x_COBI_dbh = seq(min(x_COBI),max(x_COBI),length=10*length(x_COBI))
result_COBI = subset(result_bci_sp_all,Latin=="Cordia bicolor")

plot(sort(x_COBI, decreasing=TRUE), 1:length(x_COBI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COBI), max(x_COBI)), ylim = c(1, length(x_COBI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COBI = function(x){
  b_pop = result_COBI$b_pmete
  n_pop = result_COBI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COBI = function(x){
  b_pop = 2
  n_pop = result_COBI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COBI = function(x){
  al_pop = result_COBI$p1_qwei
  be_pop = result_COBI$p2_qwei
  ga_pop = result_COBI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COBI_PMETE = (1-cumsum(fx_COBI(x_COBI_dbh)*(max(x_COBI)-min(x_COBI))/length(x_COBI_dbh)))*length(x_COBI) # parametrized mete prediction
y_COBI_METE = (1-cumsum(gx_COBI(x_COBI_dbh)*(max(x_COBI)-min(x_COBI))/length(x_COBI_dbh)))*length(x_COBI) # mete prediction
y_COBI_EXP = exp(-(result_COBI$p_exp)*(x_COBI_dbh-min(x_COBI_dbh)))*length(x_COBI)  # exponential distribution
y_COBI_POW = ((x_COBI_dbh)^(-(result_COBI$p_pow)))*length(x_COBI) # power function distribution
y_COBI_WEI = (exp(1/((result_COBI$p1_wei)^(result_COBI$p2_wei))-(x_COBI_dbh/(result_COBI$p1_wei))^(result_COBI$p2_wei)))*length(x_COBI) # Weibull distribution
y_COBI_QWEI = (1-cumsum(qwei_COBI(x_COBI_dbh)*(max(x_COBI)-min(x_COBI))/length(x_COBI_dbh)))*length(x_COBI) # quasi_Weibull distribution

lines(x_COBI_dbh, y_COBI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COBI_dbh, y_COBI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COBI_dbh, y_COBI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COBI_dbh, y_COBI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COBI_dbh, y_COBI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COBI_dbh, y_COBI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COBI", bty="n",cex=1.5)

#### Cordia lasiocalyx
BCI_COLA = subset(bci_2015_live,Latin=="Cordia lasiocalyx")
x_COLA = BCI_COLA$DBH/min(BCI_COLA$DBH)
length(x_COLA)
x_COLA_dbh = seq(min(x_COLA),max(x_COLA),length=10*length(x_COLA))
result_COLA = subset(result_bci_sp_all,Latin=="Cordia lasiocalyx")

plot(sort(x_COLA, decreasing=TRUE), 1:length(x_COLA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COLA), max(x_COLA)), ylim = c(1, length(x_COLA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COLA = function(x){
  b_pop = result_COLA$b_pmete
  n_pop = result_COLA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COLA = function(x){
  b_pop = 2
  n_pop = result_COLA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COLA = function(x){
  al_pop = result_COLA$p1_qwei
  be_pop = result_COLA$p2_qwei
  ga_pop = result_COLA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COLA_PMETE = (1-cumsum(fx_COLA(x_COLA_dbh)*(max(x_COLA)-min(x_COLA))/length(x_COLA_dbh)))*length(x_COLA) # parametrized mete prediction
y_COLA_METE = (1-cumsum(gx_COLA(x_COLA_dbh)*(max(x_COLA)-min(x_COLA))/length(x_COLA_dbh)))*length(x_COLA) # mete prediction
y_COLA_EXP = exp(-(result_COLA$p_exp)*(x_COLA_dbh-min(x_COLA_dbh)))*length(x_COLA)  # exponential distribution
y_COLA_POW = ((x_COLA_dbh)^(-(result_COLA$p_pow)))*length(x_COLA) # power function distribution
y_COLA_WEI = (exp(1/((result_COLA$p1_wei)^(result_COLA$p2_wei))-(x_COLA_dbh/(result_COLA$p1_wei))^(result_COLA$p2_wei)))*length(x_COLA) # Weibull distribution
y_COLA_QWEI = (1-cumsum(qwei_COLA(x_COLA_dbh)*(max(x_COLA)-min(x_COLA))/length(x_COLA_dbh)))*length(x_COLA) # quasi_Weibull distribution

lines(x_COLA_dbh, y_COLA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COLA_dbh, y_COLA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COLA_dbh, y_COLA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COLA_dbh, y_COLA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COLA_dbh, y_COLA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COLA_dbh, y_COLA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COLA", bty="n",cex=1.5)
```
### BCI (order=Brassicales)
```{r}
par(mfrow=c(1,1),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Capparis frondosa
BCI_CAFR = subset(bci_2015_live,Latin=="Capparis frondosa")
x_CAFR = BCI_CAFR$DBH/min(BCI_CAFR$DBH)
length(x_CAFR)
x_CAFR_dbh = seq(min(x_CAFR),max(x_CAFR),length=10*length(x_CAFR))
result_CAFR = subset(result_bci_sp_all,Latin=="Capparis frondosa")

plot(sort(x_CAFR, decreasing=TRUE), 1:length(x_CAFR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CAFR), max(x_CAFR)), ylim = c(1, length(x_CAFR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CAFR = function(x){
  b_pop = result_CAFR$b_pmete
  n_pop = result_CAFR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CAFR = function(x){
  b_pop = 2
  n_pop = result_CAFR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CAFR = function(x){
  al_pop = result_CAFR$p1_qwei
  be_pop = result_CAFR$p2_qwei
  ga_pop = result_CAFR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CAFR_PMETE = (1-cumsum(fx_CAFR(x_CAFR_dbh)*(max(x_CAFR)-min(x_CAFR))/length(x_CAFR_dbh)))*length(x_CAFR) # parametrized mete prediction
y_CAFR_METE = (1-cumsum(gx_CAFR(x_CAFR_dbh)*(max(x_CAFR)-min(x_CAFR))/length(x_CAFR_dbh)))*length(x_CAFR) # mete prediction
y_CAFR_EXP = exp(-(result_CAFR$p_exp)*(x_CAFR_dbh-min(x_CAFR_dbh)))*length(x_CAFR)  # exponential distribution
y_CAFR_POW = ((x_CAFR_dbh)^(-(result_CAFR$p_pow)))*length(x_CAFR) # power function distribution
y_CAFR_WEI = (exp(1/((result_CAFR$p1_wei)^(result_CAFR$p2_wei))-(x_CAFR_dbh/(result_CAFR$p1_wei))^(result_CAFR$p2_wei)))*length(x_CAFR) # Weibull distribution
y_CAFR_QWEI = (1-cumsum(qwei_CAFR(x_CAFR_dbh)*(max(x_CAFR)-min(x_CAFR))/length(x_CAFR_dbh)))*length(x_CAFR) # quasi_Weibull distribution

lines(x_CAFR_dbh, y_CAFR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CAFR_dbh, y_CAFR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CAFR_dbh, y_CAFR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CAFR_dbh, y_CAFR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CAFR_dbh, y_CAFR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CAFR_dbh, y_CAFR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CAFR", bty="n",cex=1.5)
```
### BCI (order=Caryophyllales)
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Coccoloba coronata
BCI_COCO = subset(bci_2015_live,Latin=="Coccoloba coronata")
x_COCO = BCI_COCO$DBH/min(BCI_COCO$DBH)
length(x_COCO)
x_COCO_dbh = seq(min(x_COCO),max(x_COCO),length=10*length(x_COCO))
result_COCO = subset(result_bci_sp_all,Latin=="Coccoloba coronata")

plot(sort(x_COCO, decreasing=TRUE), 1:length(x_COCO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COCO), max(x_COCO)), ylim = c(1, length(x_COCO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COCO = function(x){
  b_pop = result_COCO$b_pmete
  n_pop = result_COCO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COCO = function(x){
  b_pop = 2
  n_pop = result_COCO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COCO = function(x){
  al_pop = result_COCO$p1_qwei
  be_pop = result_COCO$p2_qwei
  ga_pop = result_COCO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COCO_PMETE = (1-cumsum(fx_COCO(x_COCO_dbh)*(max(x_COCO)-min(x_COCO))/length(x_COCO_dbh)))*length(x_COCO) # parametrized mete prediction
y_COCO_METE = (1-cumsum(gx_COCO(x_COCO_dbh)*(max(x_COCO)-min(x_COCO))/length(x_COCO_dbh)))*length(x_COCO) # mete prediction
y_COCO_EXP = exp(-(result_COCO$p_exp)*(x_COCO_dbh-min(x_COCO_dbh)))*length(x_COCO)  # exponential distribution
y_COCO_POW = ((x_COCO_dbh)^(-(result_COCO$p_pow)))*length(x_COCO) # power function distribution
y_COCO_WEI = (exp(1/((result_COCO$p1_wei)^(result_COCO$p2_wei))-(x_COCO_dbh/(result_COCO$p1_wei))^(result_COCO$p2_wei)))*length(x_COCO) # Weibull distribution
y_COCO_QWEI = (1-cumsum(qwei_COCO(x_COCO_dbh)*(max(x_COCO)-min(x_COCO))/length(x_COCO_dbh)))*length(x_COCO) # quasi_Weibull distribution

lines(x_COCO_dbh, y_COCO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COCO_dbh, y_COCO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COCO_dbh, y_COCO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COCO_dbh, y_COCO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COCO_dbh, y_COCO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COCO_dbh, y_COCO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COCO", bty="n",cex=1.5)

#### Coccoloba manzinellensis
BCI_COMA = subset(bci_2015_live,Latin=="Coccoloba manzinellensis")
x_COMA = BCI_COMA$DBH/min(BCI_COMA$DBH)
length(x_COMA)
x_COMA_dbh = seq(min(x_COMA),max(x_COMA),length=10*length(x_COMA))
result_COMA = subset(result_bci_sp_all,Latin=="Coccoloba manzinellensis")

plot(sort(x_COMA, decreasing=TRUE), 1:length(x_COMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COMA), max(x_COMA)), ylim = c(1, length(x_COMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COMA = function(x){
  b_pop = result_COMA$b_pmete
  n_pop = result_COMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COMA = function(x){
  b_pop = 2
  n_pop = result_COMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COMA = function(x){
  al_pop = result_COMA$p1_qwei
  be_pop = result_COMA$p2_qwei
  ga_pop = result_COMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COMA_PMETE = (1-cumsum(fx_COMA(x_COMA_dbh)*(max(x_COMA)-min(x_COMA))/length(x_COMA_dbh)))*length(x_COMA) # parametrized mete prediction
y_COMA_METE = (1-cumsum(gx_COMA(x_COMA_dbh)*(max(x_COMA)-min(x_COMA))/length(x_COMA_dbh)))*length(x_COMA) # mete prediction
y_COMA_EXP = exp(-(result_COMA$p_exp)*(x_COMA_dbh-min(x_COMA_dbh)))*length(x_COMA)  # exponential distribution
y_COMA_POW = ((x_COMA_dbh)^(-(result_COMA$p_pow)))*length(x_COMA) # power function distribution
y_COMA_WEI = (exp(1/((result_COMA$p1_wei)^(result_COMA$p2_wei))-(x_COMA_dbh/(result_COMA$p1_wei))^(result_COMA$p2_wei)))*length(x_COMA) # Weibull distribution
y_COMA_QWEI = (1-cumsum(qwei_COMA(x_COMA_dbh)*(max(x_COMA)-min(x_COMA))/length(x_COMA_dbh)))*length(x_COMA) # quasi_Weibull distribution

lines(x_COMA_dbh, y_COMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COMA_dbh, y_COMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COMA_dbh, y_COMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COMA_dbh, y_COMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COMA_dbh, y_COMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COMA_dbh, y_COMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COMA", bty="n",cex=1.5)

#### Guapira standleyana
BCI_GUST = subset(bci_2015_live,Latin=="Guapira standleyana")
x_GUST = BCI_GUST$DBH/min(BCI_GUST$DBH)
length(x_GUST)
x_GUST_dbh = seq(min(x_GUST),max(x_GUST),length=10*length(x_GUST))
result_GUST = subset(result_bci_sp_all,Latin=="Guapira standleyana")

plot(sort(x_GUST, decreasing=TRUE), 1:length(x_GUST), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUST), max(x_GUST)), ylim = c(1, length(x_GUST)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUST = function(x){
  b_pop = result_GUST$b_pmete
  n_pop = result_GUST$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUST = function(x){
  b_pop = 2
  n_pop = result_GUST$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUST = function(x){
  al_pop = result_GUST$p1_qwei
  be_pop = result_GUST$p2_qwei
  ga_pop = result_GUST$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUST_PMETE = (1-cumsum(fx_GUST(x_GUST_dbh)*(max(x_GUST)-min(x_GUST))/length(x_GUST_dbh)))*length(x_GUST) # parametrized mete prediction
y_GUST_METE = (1-cumsum(gx_GUST(x_GUST_dbh)*(max(x_GUST)-min(x_GUST))/length(x_GUST_dbh)))*length(x_GUST) # mete prediction
y_GUST_EXP = exp(-(result_GUST$p_exp)*(x_GUST_dbh-min(x_GUST_dbh)))*length(x_GUST)  # exponential distribution
y_GUST_POW = ((x_GUST_dbh)^(-(result_GUST$p_pow)))*length(x_GUST) # power function distribution
y_GUST_WEI = (exp(1/((result_GUST$p1_wei)^(result_GUST$p2_wei))-(x_GUST_dbh/(result_GUST$p1_wei))^(result_GUST$p2_wei)))*length(x_GUST) # Weibull distribution
y_GUST_QWEI = (1-cumsum(qwei_GUST(x_GUST_dbh)*(max(x_GUST)-min(x_GUST))/length(x_GUST_dbh)))*length(x_GUST) # quasi_Weibull distribution

lines(x_GUST_dbh, y_GUST_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUST_dbh, y_GUST_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUST_dbh, y_GUST_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUST_dbh, y_GUST_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUST_dbh, y_GUST_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUST_dbh, y_GUST_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUST", bty="n",cex=1.5)

#### Triplaris cumingiana
BCI_TRCU = subset(bci_2015_live,Latin=="Triplaris cumingiana")
x_TRCU = BCI_TRCU$DBH/min(BCI_TRCU$DBH)
length(x_TRCU)
x_TRCU_dbh = seq(min(x_TRCU),max(x_TRCU),length=10*length(x_TRCU))
result_TRCU = subset(result_bci_sp_all,Latin=="Triplaris cumingiana")

plot(sort(x_TRCU, decreasing=TRUE), 1:length(x_TRCU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TRCU), max(x_TRCU)), ylim = c(1, length(x_TRCU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TRCU = function(x){
  b_pop = result_TRCU$b_pmete
  n_pop = result_TRCU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TRCU = function(x){
  b_pop = 2
  n_pop = result_TRCU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TRCU = function(x){
  al_pop = result_TRCU$p1_qwei
  be_pop = result_TRCU$p2_qwei
  ga_pop = result_TRCU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TRCU_PMETE = (1-cumsum(fx_TRCU(x_TRCU_dbh)*(max(x_TRCU)-min(x_TRCU))/length(x_TRCU_dbh)))*length(x_TRCU) # parametrized mete prediction
y_TRCU_METE = (1-cumsum(gx_TRCU(x_TRCU_dbh)*(max(x_TRCU)-min(x_TRCU))/length(x_TRCU_dbh)))*length(x_TRCU) # mete prediction
y_TRCU_EXP = exp(-(result_TRCU$p_exp)*(x_TRCU_dbh-min(x_TRCU_dbh)))*length(x_TRCU)  # exponential distribution
y_TRCU_POW = ((x_TRCU_dbh)^(-(result_TRCU$p_pow)))*length(x_TRCU) # power function distribution
y_TRCU_WEI = (exp(1/((result_TRCU$p1_wei)^(result_TRCU$p2_wei))-(x_TRCU_dbh/(result_TRCU$p1_wei))^(result_TRCU$p2_wei)))*length(x_TRCU) # Weibull distribution
y_TRCU_QWEI = (1-cumsum(qwei_TRCU(x_TRCU_dbh)*(max(x_TRCU)-min(x_TRCU))/length(x_TRCU_dbh)))*length(x_TRCU) # quasi_Weibull distribution

lines(x_TRCU_dbh, y_TRCU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TRCU_dbh, y_TRCU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TRCU_dbh, y_TRCU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TRCU_dbh, y_TRCU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TRCU_dbh, y_TRCU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TRCU_dbh, y_TRCU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TRCU", bty="n",cex=1.5)
```
### BCI (order=Celastrales)
```{r}
par(mfrow=c(1,1),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Maytenus schippii
BCI_MASC = subset(bci_2015_live,Latin=="Maytenus schippii")
x_MASC = BCI_MASC$DBH/min(BCI_MASC$DBH)
length(x_MASC)
x_MASC_dbh = seq(min(x_MASC),max(x_MASC),length=10*length(x_MASC))
result_MASC = subset(result_bci_sp_all,Latin=="Maytenus schippii")

plot(sort(x_MASC, decreasing=TRUE), 1:length(x_MASC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MASC), max(x_MASC)), ylim = c(1, length(x_MASC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MASC = function(x){
  b_pop = result_MASC$b_pmete
  n_pop = result_MASC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MASC = function(x){
  b_pop = 2
  n_pop = result_MASC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MASC = function(x){
  al_pop = result_MASC$p1_qwei
  be_pop = result_MASC$p2_qwei
  ga_pop = result_MASC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MASC_PMETE = (1-cumsum(fx_MASC(x_MASC_dbh)*(max(x_MASC)-min(x_MASC))/length(x_MASC_dbh)))*length(x_MASC) # parametrized mete prediction
y_MASC_METE = (1-cumsum(gx_MASC(x_MASC_dbh)*(max(x_MASC)-min(x_MASC))/length(x_MASC_dbh)))*length(x_MASC) # mete prediction
y_MASC_EXP = exp(-(result_MASC$p_exp)*(x_MASC_dbh-min(x_MASC_dbh)))*length(x_MASC)  # exponential distribution
y_MASC_POW = ((x_MASC_dbh)^(-(result_MASC$p_pow)))*length(x_MASC) # power function distribution
y_MASC_WEI = (exp(1/((result_MASC$p1_wei)^(result_MASC$p2_wei))-(x_MASC_dbh/(result_MASC$p1_wei))^(result_MASC$p2_wei)))*length(x_MASC) # Weibull distribution
y_MASC_QWEI = (1-cumsum(qwei_MASC(x_MASC_dbh)*(max(x_MASC)-min(x_MASC))/length(x_MASC_dbh)))*length(x_MASC) # quasi_Weibull distribution

lines(x_MASC_dbh, y_MASC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MASC_dbh, y_MASC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MASC_dbh, y_MASC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MASC_dbh, y_MASC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MASC_dbh, y_MASC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MASC_dbh, y_MASC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MASC", bty="n",cex=1.5)
```
### BCI (Order=Ericales)
```{r}
par(mfrow=c(3,3),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Ardisia standleyana
BCI_ARST = subset(bci_2015_live,Latin=="Ardisia standleyana")
x_ARST = BCI_ARST$DBH/min(BCI_ARST$DBH)
length(x_ARST)
x_ARST_dbh = seq(min(x_ARST),max(x_ARST),length=10*length(x_ARST))
result_ARST = subset(result_bci_sp_all,Latin=="Ardisia standleyana")

plot(sort(x_ARST, decreasing=TRUE), 1:length(x_ARST), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ARST), max(x_ARST)), ylim = c(1, length(x_ARST)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ARST = function(x){
  b_pop = result_ARST$b_pmete
  n_pop = result_ARST$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ARST = function(x){
  b_pop = 2
  n_pop = result_ARST$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ARST = function(x){
  al_pop = result_ARST$p1_qwei
  be_pop = result_ARST$p2_qwei
  ga_pop = result_ARST$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ARST_PMETE = (1-cumsum(fx_ARST(x_ARST_dbh)*(max(x_ARST)-min(x_ARST))/length(x_ARST_dbh)))*length(x_ARST) # parametrized mete prediction
y_ARST_METE = (1-cumsum(gx_ARST(x_ARST_dbh)*(max(x_ARST)-min(x_ARST))/length(x_ARST_dbh)))*length(x_ARST) # mete prediction
y_ARST_EXP = exp(-(result_ARST$p_exp)*(x_ARST_dbh-min(x_ARST_dbh)))*length(x_ARST)  # exponential distribution
y_ARST_POW = ((x_ARST_dbh)^(-(result_ARST$p_pow)))*length(x_ARST) # power function distribution
y_ARST_WEI = (exp(1/((result_ARST$p1_wei)^(result_ARST$p2_wei))-(x_ARST_dbh/(result_ARST$p1_wei))^(result_ARST$p2_wei)))*length(x_ARST) # Weibull distribution
y_ARST_QWEI = (1-cumsum(qwei_ARST(x_ARST_dbh)*(max(x_ARST)-min(x_ARST))/length(x_ARST_dbh)))*length(x_ARST) # quasi_Weibull distribution

lines(x_ARST_dbh, y_ARST_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ARST_dbh, y_ARST_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ARST_dbh, y_ARST_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ARST_dbh, y_ARST_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ARST_dbh, y_ARST_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ARST_dbh, y_ARST_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ARST", bty="n",cex=1.5)

#### Chrysophyllum argenteum
BCI_CHAR = subset(bci_2015_live,Latin=="Chrysophyllum argenteum")
x_CHAR = BCI_CHAR$DBH/min(BCI_CHAR$DBH)
length(x_CHAR)
x_CHAR_dbh = seq(min(x_CHAR),max(x_CHAR),length=10*length(x_CHAR))
result_CHAR = subset(result_bci_sp_all,Latin=="Chrysophyllum argenteum")

plot(sort(x_CHAR, decreasing=TRUE), 1:length(x_CHAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CHAR), max(x_CHAR)), ylim = c(1, length(x_CHAR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CHAR = function(x){
  b_pop = result_CHAR$b_pmete
  n_pop = result_CHAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CHAR = function(x){
  b_pop = 2
  n_pop = result_CHAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CHAR = function(x){
  al_pop = result_CHAR$p1_qwei
  be_pop = result_CHAR$p2_qwei
  ga_pop = result_CHAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CHAR_PMETE = (1-cumsum(fx_CHAR(x_CHAR_dbh)*(max(x_CHAR)-min(x_CHAR))/length(x_CHAR_dbh)))*length(x_CHAR) # parametrized mete prediction
y_CHAR_METE = (1-cumsum(gx_CHAR(x_CHAR_dbh)*(max(x_CHAR)-min(x_CHAR))/length(x_CHAR_dbh)))*length(x_CHAR) # mete prediction
y_CHAR_EXP = exp(-(result_CHAR$p_exp)*(x_CHAR_dbh-min(x_CHAR_dbh)))*length(x_CHAR)  # exponential distribution
y_CHAR_POW = ((x_CHAR_dbh)^(-(result_CHAR$p_pow)))*length(x_CHAR) # power function distribution
y_CHAR_WEI = (exp(1/((result_CHAR$p1_wei)^(result_CHAR$p2_wei))-(x_CHAR_dbh/(result_CHAR$p1_wei))^(result_CHAR$p2_wei)))*length(x_CHAR) # Weibull distribution
y_CHAR_QWEI = (1-cumsum(qwei_CHAR(x_CHAR_dbh)*(max(x_CHAR)-min(x_CHAR))/length(x_CHAR_dbh)))*length(x_CHAR) # quasi_Weibull distribution

lines(x_CHAR_dbh, y_CHAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CHAR_dbh, y_CHAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CHAR_dbh, y_CHAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CHAR_dbh, y_CHAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CHAR_dbh, y_CHAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CHAR_dbh, y_CHAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CHAR", bty="n",cex=1.5)

#### Chrysophyllum cainito
BCI_CHCA = subset(bci_2015_live,Latin=="Chrysophyllum cainito")
x_CHCA = BCI_CHCA$DBH/min(BCI_CHCA$DBH)
length(x_CHCA)
x_CHCA_dbh = seq(min(x_CHCA),max(x_CHCA),length=10*length(x_CHCA))
result_CHCA = subset(result_bci_sp_all,Latin=="Chrysophyllum cainito")

plot(sort(x_CHCA, decreasing=TRUE), 1:length(x_CHCA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CHCA), max(x_CHCA)), ylim = c(1, length(x_CHCA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CHCA = function(x){
  b_pop = result_CHCA$b_pmete
  n_pop = result_CHCA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CHCA = function(x){
  b_pop = 2
  n_pop = result_CHCA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CHCA = function(x){
  al_pop = result_CHCA$p1_qwei
  be_pop = result_CHCA$p2_qwei
  ga_pop = result_CHCA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CHCA_PMETE = (1-cumsum(fx_CHCA(x_CHCA_dbh)*(max(x_CHCA)-min(x_CHCA))/length(x_CHCA_dbh)))*length(x_CHCA) # parametrized mete prediction
y_CHCA_METE = (1-cumsum(gx_CHCA(x_CHCA_dbh)*(max(x_CHCA)-min(x_CHCA))/length(x_CHCA_dbh)))*length(x_CHCA) # mete prediction
y_CHCA_EXP = exp(-(result_CHCA$p_exp)*(x_CHCA_dbh-min(x_CHCA_dbh)))*length(x_CHCA)  # exponential distribution
y_CHCA_POW = ((x_CHCA_dbh)^(-(result_CHCA$p_pow)))*length(x_CHCA) # power function distribution
y_CHCA_WEI = (exp(1/((result_CHCA$p1_wei)^(result_CHCA$p2_wei))-(x_CHCA_dbh/(result_CHCA$p1_wei))^(result_CHCA$p2_wei)))*length(x_CHCA) # Weibull distribution
y_CHCA_QWEI = (1-cumsum(qwei_CHCA(x_CHCA_dbh)*(max(x_CHCA)-min(x_CHCA))/length(x_CHCA_dbh)))*length(x_CHCA) # quasi_Weibull distribution

lines(x_CHCA_dbh, y_CHCA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CHCA_dbh, y_CHCA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CHCA_dbh, y_CHCA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CHCA_dbh, y_CHCA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CHCA_dbh, y_CHCA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CHCA_dbh, y_CHCA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CHCA", bty="n",cex=1.5)

#### Diospyros artanthifolia
BCI_DIAR = subset(bci_2015_live,Latin=="Diospyros artanthifolia")
x_DIAR = BCI_DIAR$DBH/min(BCI_DIAR$DBH)
length(x_DIAR)
x_DIAR_dbh = seq(min(x_DIAR),max(x_DIAR),length=10*length(x_DIAR))
result_DIAR = subset(result_bci_sp_all,Latin=="Diospyros artanthifolia")

plot(sort(x_DIAR, decreasing=TRUE), 1:length(x_DIAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_DIAR), max(x_DIAR)), ylim = c(1, length(x_DIAR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_DIAR = function(x){
  b_pop = result_DIAR$b_pmete
  n_pop = result_DIAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_DIAR = function(x){
  b_pop = 2
  n_pop = result_DIAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_DIAR = function(x){
  al_pop = result_DIAR$p1_qwei
  be_pop = result_DIAR$p2_qwei
  ga_pop = result_DIAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_DIAR_PMETE = (1-cumsum(fx_DIAR(x_DIAR_dbh)*(max(x_DIAR)-min(x_DIAR))/length(x_DIAR_dbh)))*length(x_DIAR) # parametrized mete prediction
y_DIAR_METE = (1-cumsum(gx_DIAR(x_DIAR_dbh)*(max(x_DIAR)-min(x_DIAR))/length(x_DIAR_dbh)))*length(x_DIAR) # mete prediction
y_DIAR_EXP = exp(-(result_DIAR$p_exp)*(x_DIAR_dbh-min(x_DIAR_dbh)))*length(x_DIAR)  # exponential distribution
y_DIAR_POW = ((x_DIAR_dbh)^(-(result_DIAR$p_pow)))*length(x_DIAR) # power function distribution
y_DIAR_WEI = (exp(1/((result_DIAR$p1_wei)^(result_DIAR$p2_wei))-(x_DIAR_dbh/(result_DIAR$p1_wei))^(result_DIAR$p2_wei)))*length(x_DIAR) # Weibull distribution
y_DIAR_QWEI = (1-cumsum(qwei_DIAR(x_DIAR_dbh)*(max(x_DIAR)-min(x_DIAR))/length(x_DIAR_dbh)))*length(x_DIAR) # quasi_Weibull distribution

lines(x_DIAR_dbh, y_DIAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_DIAR_dbh, y_DIAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_DIAR_dbh, y_DIAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_DIAR_dbh, y_DIAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_DIAR_dbh, y_DIAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_DIAR_dbh, y_DIAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "DIAR", bty="n",cex=1.5)

#### Gustavia superba
BCI_GUSU = subset(bci_2015_live,Latin=="Gustavia superba")
x_GUSU = BCI_GUSU$DBH/min(BCI_GUSU$DBH)
length(x_GUSU)
x_GUSU_dbh = seq(min(x_GUSU),max(x_GUSU),length=10*length(x_GUSU))
result_GUSU = subset(result_bci_sp_all,Latin=="Gustavia superba")

plot(sort(x_GUSU, decreasing=TRUE), 1:length(x_GUSU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUSU), max(x_GUSU)), ylim = c(1, length(x_GUSU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUSU = function(x){
  b_pop = result_GUSU$b_pmete
  n_pop = result_GUSU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUSU = function(x){
  b_pop = 2
  n_pop = result_GUSU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUSU = function(x){
  al_pop = result_GUSU$p1_qwei
  be_pop = result_GUSU$p2_qwei
  ga_pop = result_GUSU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUSU_PMETE = (1-cumsum(fx_GUSU(x_GUSU_dbh)*(max(x_GUSU)-min(x_GUSU))/length(x_GUSU_dbh)))*length(x_GUSU) # parametrized mete prediction
y_GUSU_METE = (1-cumsum(gx_GUSU(x_GUSU_dbh)*(max(x_GUSU)-min(x_GUSU))/length(x_GUSU_dbh)))*length(x_GUSU) # mete prediction
y_GUSU_EXP = exp(-(result_GUSU$p_exp)*(x_GUSU_dbh-min(x_GUSU_dbh)))*length(x_GUSU)  # exponential distribution
y_GUSU_POW = ((x_GUSU_dbh)^(-(result_GUSU$p_pow)))*length(x_GUSU) # power function distribution
y_GUSU_WEI = (exp(1/((result_GUSU$p1_wei)^(result_GUSU$p2_wei))-(x_GUSU_dbh/(result_GUSU$p1_wei))^(result_GUSU$p2_wei)))*length(x_GUSU) # Weibull distribution
y_GUSU_QWEI = (1-cumsum(qwei_GUSU(x_GUSU_dbh)*(max(x_GUSU)-min(x_GUSU))/length(x_GUSU_dbh)))*length(x_GUSU) # quasi_Weibull distribution

lines(x_GUSU_dbh, y_GUSU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUSU_dbh, y_GUSU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUSU_dbh, y_GUSU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUSU_dbh, y_GUSU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUSU_dbh, y_GUSU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUSU_dbh, y_GUSU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUSU", bty="n",cex=1.5)

#### Pouteria reticulata
BCI_PORE = subset(bci_2015_live,Latin=="Pouteria reticulata")
x_PORE = BCI_PORE$DBH/min(BCI_PORE$DBH)
length(x_PORE)
x_PORE_dbh = seq(min(x_PORE),max(x_PORE),length=10*length(x_PORE))
result_PORE = subset(result_bci_sp_all,Latin=="Pouteria reticulata")

plot(sort(x_PORE, decreasing=TRUE), 1:length(x_PORE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PORE), max(x_PORE)), ylim = c(1, length(x_PORE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PORE = function(x){
  b_pop = result_PORE$b_pmete
  n_pop = result_PORE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PORE = function(x){
  b_pop = 2
  n_pop = result_PORE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PORE = function(x){
  al_pop = result_PORE$p1_qwei
  be_pop = result_PORE$p2_qwei
  ga_pop = result_PORE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PORE_PMETE = (1-cumsum(fx_PORE(x_PORE_dbh)*(max(x_PORE)-min(x_PORE))/length(x_PORE_dbh)))*length(x_PORE) # parametrized mete prediction
y_PORE_METE = (1-cumsum(gx_PORE(x_PORE_dbh)*(max(x_PORE)-min(x_PORE))/length(x_PORE_dbh)))*length(x_PORE) # mete prediction
y_PORE_EXP = exp(-(result_PORE$p_exp)*(x_PORE_dbh-min(x_PORE_dbh)))*length(x_PORE)  # exponential distribution
y_PORE_POW = ((x_PORE_dbh)^(-(result_PORE$p_pow)))*length(x_PORE) # power function distribution
y_PORE_WEI = (exp(1/((result_PORE$p1_wei)^(result_PORE$p2_wei))-(x_PORE_dbh/(result_PORE$p1_wei))^(result_PORE$p2_wei)))*length(x_PORE) # Weibull distribution
y_PORE_QWEI = (1-cumsum(qwei_PORE(x_PORE_dbh)*(max(x_PORE)-min(x_PORE))/length(x_PORE_dbh)))*length(x_PORE) # quasi_Weibull distribution

lines(x_PORE_dbh, y_PORE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PORE_dbh, y_PORE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PORE_dbh, y_PORE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PORE_dbh, y_PORE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PORE_dbh, y_PORE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PORE_dbh, y_PORE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PORE", bty="n",cex=1.5)

#### Stylogyne turbacensis
BCI_STTU = subset(bci_2015_live,Latin=="Stylogyne turbacensis")
x_STTU = BCI_STTU$DBH/min(BCI_STTU$DBH)
length(x_STTU)
x_STTU_dbh = seq(min(x_STTU),max(x_STTU),length=10*length(x_STTU))
result_STTU = subset(result_bci_sp_all,Latin=="Stylogyne turbacensis")

plot(sort(x_STTU, decreasing=TRUE), 1:length(x_STTU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_STTU), max(x_STTU)), ylim = c(1, length(x_STTU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_STTU = function(x){
  b_pop = result_STTU$b_pmete
  n_pop = result_STTU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_STTU = function(x){
  b_pop = 2
  n_pop = result_STTU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_STTU = function(x){
  al_pop = result_STTU$p1_qwei
  be_pop = result_STTU$p2_qwei
  ga_pop = result_STTU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_STTU_PMETE = (1-cumsum(fx_STTU(x_STTU_dbh)*(max(x_STTU)-min(x_STTU))/length(x_STTU_dbh)))*length(x_STTU) # parametrized mete prediction
y_STTU_METE = (1-cumsum(gx_STTU(x_STTU_dbh)*(max(x_STTU)-min(x_STTU))/length(x_STTU_dbh)))*length(x_STTU) # mete prediction
y_STTU_EXP = exp(-(result_STTU$p_exp)*(x_STTU_dbh-min(x_STTU_dbh)))*length(x_STTU)  # exponential distribution
y_STTU_POW = ((x_STTU_dbh)^(-(result_STTU$p_pow)))*length(x_STTU) # power function distribution
y_STTU_WEI = (exp(1/((result_STTU$p1_wei)^(result_STTU$p2_wei))-(x_STTU_dbh/(result_STTU$p1_wei))^(result_STTU$p2_wei)))*length(x_STTU) # Weibull distribution
y_STTU_QWEI = (1-cumsum(qwei_STTU(x_STTU_dbh)*(max(x_STTU)-min(x_STTU))/length(x_STTU_dbh)))*length(x_STTU) # quasi_Weibull distribution

lines(x_STTU_dbh, y_STTU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_STTU_dbh, y_STTU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_STTU_dbh, y_STTU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_STTU_dbh, y_STTU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_STTU_dbh, y_STTU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_STTU_dbh, y_STTU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "STTU", bty="n",cex=1.5)
```
### BCI (Order=Euphorbiales)
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Acalypha diversifolia
BCI_ACDI = subset(bci_2015_live,Latin=="Acalypha diversifolia")
x_ACDI = BCI_ACDI$DBH/min(BCI_ACDI$DBH)
length(x_ACDI)
x_ACDI_dbh = seq(min(x_ACDI),max(x_ACDI),length=10*length(x_ACDI))
result_ACDI = subset(result_bci_sp_all,Latin=="Acalypha diversifolia")

plot(sort(x_ACDI, decreasing=TRUE), 1:length(x_ACDI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ACDI), max(x_ACDI)), ylim = c(1, length(x_ACDI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ACDI = function(x){
  b_pop = result_ACDI$b_pmete
  n_pop = result_ACDI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ACDI = function(x){
  b_pop = 2
  n_pop = result_ACDI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ACDI = function(x){
  al_pop = result_ACDI$p1_qwei
  be_pop = result_ACDI$p2_qwei
  ga_pop = result_ACDI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ACDI_PMETE = (1-cumsum(fx_ACDI(x_ACDI_dbh)*(max(x_ACDI)-min(x_ACDI))/length(x_ACDI_dbh)))*length(x_ACDI) # parametrized mete prediction
y_ACDI_METE = (1-cumsum(gx_ACDI(x_ACDI_dbh)*(max(x_ACDI)-min(x_ACDI))/length(x_ACDI_dbh)))*length(x_ACDI) # mete prediction
y_ACDI_EXP = exp(-(result_ACDI$p_exp)*(x_ACDI_dbh-min(x_ACDI_dbh)))*length(x_ACDI)  # exponential distribution
y_ACDI_POW = ((x_ACDI_dbh)^(-(result_ACDI$p_pow)))*length(x_ACDI) # power function distribution
y_ACDI_WEI = (exp(1/((result_ACDI$p1_wei)^(result_ACDI$p2_wei))-(x_ACDI_dbh/(result_ACDI$p1_wei))^(result_ACDI$p2_wei)))*length(x_ACDI) # Weibull distribution
y_ACDI_QWEI = (1-cumsum(qwei_ACDI(x_ACDI_dbh)*(max(x_ACDI)-min(x_ACDI))/length(x_ACDI_dbh)))*length(x_ACDI) # quasi_Weibull distribution

lines(x_ACDI_dbh, y_ACDI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ACDI_dbh, y_ACDI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ACDI_dbh, y_ACDI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ACDI_dbh, y_ACDI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ACDI_dbh, y_ACDI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ACDI_dbh, y_ACDI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ACDI", bty="n",cex=1.5)

#### Acalypha macrostachya
BCI_ACMA = subset(bci_2015_live,Latin=="Acalypha macrostachya")
x_ACMA = BCI_ACMA$DBH/min(BCI_ACMA$DBH)
length(x_ACMA)
x_ACMA_dbh = seq(min(x_ACMA),max(x_ACMA),length=10*length(x_ACMA))
result_ACMA = subset(result_bci_sp_all,Latin=="Acalypha macrostachya")

plot(sort(x_ACMA, decreasing=TRUE), 1:length(x_ACMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ACMA), max(x_ACMA)), ylim = c(1, length(x_ACMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ACMA = function(x){
  b_pop = result_ACMA$b_pmete
  n_pop = result_ACMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ACMA = function(x){
  b_pop = 2
  n_pop = result_ACMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ACMA = function(x){
  al_pop = result_ACMA$p1_qwei
  be_pop = result_ACMA$p2_qwei
  ga_pop = result_ACMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ACMA_PMETE = (1-cumsum(fx_ACMA(x_ACMA_dbh)*(max(x_ACMA)-min(x_ACMA))/length(x_ACMA_dbh)))*length(x_ACMA) # parametrized mete prediction
y_ACMA_METE = (1-cumsum(gx_ACMA(x_ACMA_dbh)*(max(x_ACMA)-min(x_ACMA))/length(x_ACMA_dbh)))*length(x_ACMA) # mete prediction
y_ACMA_EXP = exp(-(result_ACMA$p_exp)*(x_ACMA_dbh-min(x_ACMA_dbh)))*length(x_ACMA)  # exponential distribution
y_ACMA_POW = ((x_ACMA_dbh)^(-(result_ACMA$p_pow)))*length(x_ACMA) # power function distribution
y_ACMA_WEI = (exp(1/((result_ACMA$p1_wei)^(result_ACMA$p2_wei))-(x_ACMA_dbh/(result_ACMA$p1_wei))^(result_ACMA$p2_wei)))*length(x_ACMA) # Weibull distribution
y_ACMA_QWEI = (1-cumsum(qwei_ACMA(x_ACMA_dbh)*(max(x_ACMA)-min(x_ACMA))/length(x_ACMA_dbh)))*length(x_ACMA) # quasi_Weibull distribution

lines(x_ACMA_dbh, y_ACMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ACMA_dbh, y_ACMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ACMA_dbh, y_ACMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ACMA_dbh, y_ACMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ACMA_dbh, y_ACMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ACMA_dbh, y_ACMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ACMA", bty="n",cex=1.5)

#### Adelia triloba
BCI_ADTR = subset(bci_2015_live,Latin=="Adelia triloba")
x_ADTR = BCI_ADTR$DBH/min(BCI_ADTR$DBH)
length(x_ADTR)
x_ADTR_dbh = seq(min(x_ADTR),max(x_ADTR),length=10*length(x_ADTR))
result_ADTR = subset(result_bci_sp_all,Latin=="Adelia triloba")

plot(sort(x_ADTR, decreasing=TRUE), 1:length(x_ADTR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ADTR), max(x_ADTR)), ylim = c(1, length(x_ADTR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ADTR = function(x){
  b_pop = result_ADTR$b_pmete
  n_pop = result_ADTR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ADTR = function(x){
  b_pop = 2
  n_pop = result_ADTR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ADTR = function(x){
  al_pop = result_ADTR$p1_qwei
  be_pop = result_ADTR$p2_qwei
  ga_pop = result_ADTR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ADTR_PMETE = (1-cumsum(fx_ADTR(x_ADTR_dbh)*(max(x_ADTR)-min(x_ADTR))/length(x_ADTR_dbh)))*length(x_ADTR) # parametrized mete prediction
y_ADTR_METE = (1-cumsum(gx_ADTR(x_ADTR_dbh)*(max(x_ADTR)-min(x_ADTR))/length(x_ADTR_dbh)))*length(x_ADTR) # mete prediction
y_ADTR_EXP = exp(-(result_ADTR$p_exp)*(x_ADTR_dbh-min(x_ADTR_dbh)))*length(x_ADTR)  # exponential distribution
y_ADTR_POW = ((x_ADTR_dbh)^(-(result_ADTR$p_pow)))*length(x_ADTR) # power function distribution
y_ADTR_WEI = (exp(1/((result_ADTR$p1_wei)^(result_ADTR$p2_wei))-(x_ADTR_dbh/(result_ADTR$p1_wei))^(result_ADTR$p2_wei)))*length(x_ADTR) # Weibull distribution
y_ADTR_QWEI = (1-cumsum(qwei_ADTR(x_ADTR_dbh)*(max(x_ADTR)-min(x_ADTR))/length(x_ADTR_dbh)))*length(x_ADTR) # quasi_Weibull distribution

lines(x_ADTR_dbh, y_ADTR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ADTR_dbh, y_ADTR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ADTR_dbh, y_ADTR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ADTR_dbh, y_ADTR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ADTR_dbh, y_ADTR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ADTR_dbh, y_ADTR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ADTR", bty="n",cex=1.5)

#### Alchornea costaricensis
BCI_ALCO = subset(bci_2015_live,Latin=="Alchornea costaricensis")
x_ALCO = BCI_ALCO$DBH/min(BCI_ALCO$DBH)
length(x_ALCO)
x_ALCO_dbh = seq(min(x_ALCO),max(x_ALCO),length=10*length(x_ALCO))
result_ALCO = subset(result_bci_sp_all,Latin=="Alchornea costaricensis")

plot(sort(x_ALCO, decreasing=TRUE), 1:length(x_ALCO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ALCO), max(x_ALCO)), ylim = c(1, length(x_ALCO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ALCO = function(x){
  b_pop = result_ALCO$b_pmete
  n_pop = result_ALCO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ALCO = function(x){
  b_pop = 2
  n_pop = result_ALCO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ALCO = function(x){
  al_pop = result_ALCO$p1_qwei
  be_pop = result_ALCO$p2_qwei
  ga_pop = result_ALCO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ALCO_PMETE = (1-cumsum(fx_ALCO(x_ALCO_dbh)*(max(x_ALCO)-min(x_ALCO))/length(x_ALCO_dbh)))*length(x_ALCO) # parametrized mete prediction
y_ALCO_METE = (1-cumsum(gx_ALCO(x_ALCO_dbh)*(max(x_ALCO)-min(x_ALCO))/length(x_ALCO_dbh)))*length(x_ALCO) # mete prediction
y_ALCO_EXP = exp(-(result_ALCO$p_exp)*(x_ALCO_dbh-min(x_ALCO_dbh)))*length(x_ALCO)  # exponential distribution
y_ALCO_POW = ((x_ALCO_dbh)^(-(result_ALCO$p_pow)))*length(x_ALCO) # power function distribution
y_ALCO_WEI = (exp(1/((result_ALCO$p1_wei)^(result_ALCO$p2_wei))-(x_ALCO_dbh/(result_ALCO$p1_wei))^(result_ALCO$p2_wei)))*length(x_ALCO) # Weibull distribution
y_ALCO_QWEI = (1-cumsum(qwei_ALCO(x_ALCO_dbh)*(max(x_ALCO)-min(x_ALCO))/length(x_ALCO_dbh)))*length(x_ALCO) # quasi_Weibull distribution

lines(x_ALCO_dbh, y_ALCO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ALCO_dbh, y_ALCO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ALCO_dbh, y_ALCO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ALCO_dbh, y_ALCO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ALCO_dbh, y_ALCO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ALCO_dbh, y_ALCO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ALCO", bty="n",cex=1.5)
```
### BCI (Order=Fabales)
```{r}
par(mfrow=c(4,5),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Andira inermis
BCI_ANIN = subset(bci_2015_live,Latin=="Andira inermis")
x_ANIN = BCI_ANIN$DBH/min(BCI_ANIN$DBH)
length(x_ANIN)
x_ANIN_dbh = seq(min(x_ANIN),max(x_ANIN),length=10*length(x_ANIN))
result_ANIN = subset(result_bci_sp_all,Latin=="Andira inermis")

plot(sort(x_ANIN, decreasing=TRUE), 1:length(x_ANIN), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ANIN), max(x_ANIN)), ylim = c(1, length(x_ANIN)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ANIN = function(x){
  b_pop = result_ANIN$b_pmete
  n_pop = result_ANIN$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ANIN = function(x){
  b_pop = 2
  n_pop = result_ANIN$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ANIN = function(x){
  al_pop = result_ANIN$p1_qwei
  be_pop = result_ANIN$p2_qwei
  ga_pop = result_ANIN$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ANIN_PMETE = (1-cumsum(fx_ANIN(x_ANIN_dbh)*(max(x_ANIN)-min(x_ANIN))/length(x_ANIN_dbh)))*length(x_ANIN) # parametrized mete prediction
y_ANIN_METE = (1-cumsum(gx_ANIN(x_ANIN_dbh)*(max(x_ANIN)-min(x_ANIN))/length(x_ANIN_dbh)))*length(x_ANIN) # mete prediction
y_ANIN_EXP = exp(-(result_ANIN$p_exp)*(x_ANIN_dbh-min(x_ANIN_dbh)))*length(x_ANIN)  # exponential distribution
y_ANIN_POW = ((x_ANIN_dbh)^(-(result_ANIN$p_pow)))*length(x_ANIN) # power function distribution
y_ANIN_WEI = (exp(1/((result_ANIN$p1_wei)^(result_ANIN$p2_wei))-(x_ANIN_dbh/(result_ANIN$p1_wei))^(result_ANIN$p2_wei)))*length(x_ANIN) # Weibull distribution
y_ANIN_QWEI = (1-cumsum(qwei_ANIN(x_ANIN_dbh)*(max(x_ANIN)-min(x_ANIN))/length(x_ANIN_dbh)))*length(x_ANIN) # quasi_Weibull distribution

lines(x_ANIN_dbh, y_ANIN_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ANIN_dbh, y_ANIN_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ANIN_dbh, y_ANIN_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ANIN_dbh, y_ANIN_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ANIN_dbh, y_ANIN_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ANIN_dbh, y_ANIN_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ANIN", bty="n",cex=1.5)

#### Inga acuminata
BCI_INAC = subset(bci_2015_live,Latin=="Inga acuminata")
x_INAC = BCI_INAC$DBH/min(BCI_INAC$DBH)
length(x_INAC)
x_INAC_dbh = seq(min(x_INAC),max(x_INAC),length=10*length(x_INAC))
result_INAC = subset(result_bci_sp_all,Latin=="Inga acuminata")

plot(sort(x_INAC, decreasing=TRUE), 1:length(x_INAC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INAC), max(x_INAC)), ylim = c(1, length(x_INAC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INAC = function(x){
  b_pop = result_INAC$b_pmete
  n_pop = result_INAC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INAC = function(x){
  b_pop = 2
  n_pop = result_INAC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INAC = function(x){
  al_pop = result_INAC$p1_qwei
  be_pop = result_INAC$p2_qwei
  ga_pop = result_INAC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INAC_PMETE = (1-cumsum(fx_INAC(x_INAC_dbh)*(max(x_INAC)-min(x_INAC))/length(x_INAC_dbh)))*length(x_INAC) # parametrized mete prediction
y_INAC_METE = (1-cumsum(gx_INAC(x_INAC_dbh)*(max(x_INAC)-min(x_INAC))/length(x_INAC_dbh)))*length(x_INAC) # mete prediction
y_INAC_EXP = exp(-(result_INAC$p_exp)*(x_INAC_dbh-min(x_INAC_dbh)))*length(x_INAC)  # exponential distribution
y_INAC_POW = ((x_INAC_dbh)^(-(result_INAC$p_pow)))*length(x_INAC) # power function distribution
y_INAC_WEI = (exp(1/((result_INAC$p1_wei)^(result_INAC$p2_wei))-(x_INAC_dbh/(result_INAC$p1_wei))^(result_INAC$p2_wei)))*length(x_INAC) # Weibull distribution
y_INAC_QWEI = (1-cumsum(qwei_INAC(x_INAC_dbh)*(max(x_INAC)-min(x_INAC))/length(x_INAC_dbh)))*length(x_INAC) # quasi_Weibull distribution

lines(x_INAC_dbh, y_INAC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INAC_dbh, y_INAC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INAC_dbh, y_INAC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INAC_dbh, y_INAC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INAC_dbh, y_INAC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INAC_dbh, y_INAC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INAC", bty="n",cex=1.5)

#### Inga goldmanii
BCI_INGO = subset(bci_2015_live,Latin=="Inga goldmanii")
x_INGO = BCI_INGO$DBH/min(BCI_INGO$DBH)
length(x_INGO)
x_INGO_dbh = seq(min(x_INGO),max(x_INGO),length=10*length(x_INGO))
result_INGO = subset(result_bci_sp_all,Latin=="Inga goldmanii")

plot(sort(x_INGO, decreasing=TRUE), 1:length(x_INGO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INGO), max(x_INGO)), ylim = c(1, length(x_INGO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INGO = function(x){
  b_pop = result_INGO$b_pmete
  n_pop = result_INGO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INGO = function(x){
  b_pop = 2
  n_pop = result_INGO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INGO = function(x){
  al_pop = result_INGO$p1_qwei
  be_pop = result_INGO$p2_qwei
  ga_pop = result_INGO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INGO_PMETE = (1-cumsum(fx_INGO(x_INGO_dbh)*(max(x_INGO)-min(x_INGO))/length(x_INGO_dbh)))*length(x_INGO) # parametrized mete prediction
y_INGO_METE = (1-cumsum(gx_INGO(x_INGO_dbh)*(max(x_INGO)-min(x_INGO))/length(x_INGO_dbh)))*length(x_INGO) # mete prediction
y_INGO_EXP = exp(-(result_INGO$p_exp)*(x_INGO_dbh-min(x_INGO_dbh)))*length(x_INGO)  # exponential distribution
y_INGO_POW = ((x_INGO_dbh)^(-(result_INGO$p_pow)))*length(x_INGO) # power function distribution
y_INGO_WEI = (exp(1/((result_INGO$p1_wei)^(result_INGO$p2_wei))-(x_INGO_dbh/(result_INGO$p1_wei))^(result_INGO$p2_wei)))*length(x_INGO) # Weibull distribution
y_INGO_QWEI = (1-cumsum(qwei_INGO(x_INGO_dbh)*(max(x_INGO)-min(x_INGO))/length(x_INGO_dbh)))*length(x_INGO) # quasi_Weibull distribution

lines(x_INGO_dbh, y_INGO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INGO_dbh, y_INGO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INGO_dbh, y_INGO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INGO_dbh, y_INGO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INGO_dbh, y_INGO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INGO_dbh, y_INGO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INGO", bty="n",cex=1.5)

#### Inga marginata
BCI_INMA = subset(bci_2015_live,Latin=="Inga marginata")
x_INMA = BCI_INMA$DBH/min(BCI_INMA$DBH)
length(x_INMA)
x_INMA_dbh = seq(min(x_INMA),max(x_INMA),length=10*length(x_INMA))
result_INMA = subset(result_bci_sp_all,Latin=="Inga marginata")

plot(sort(x_INMA, decreasing=TRUE), 1:length(x_INMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INMA), max(x_INMA)), ylim = c(1, length(x_INMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INMA = function(x){
  b_pop = result_INMA$b_pmete
  n_pop = result_INMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INMA = function(x){
  b_pop = 2
  n_pop = result_INMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INMA = function(x){
  al_pop = result_INMA$p1_qwei
  be_pop = result_INMA$p2_qwei
  ga_pop = result_INMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INMA_PMETE = (1-cumsum(fx_INMA(x_INMA_dbh)*(max(x_INMA)-min(x_INMA))/length(x_INMA_dbh)))*length(x_INMA) # parametrized mete prediction
y_INMA_METE = (1-cumsum(gx_INMA(x_INMA_dbh)*(max(x_INMA)-min(x_INMA))/length(x_INMA_dbh)))*length(x_INMA) # mete prediction
y_INMA_EXP = exp(-(result_INMA$p_exp)*(x_INMA_dbh-min(x_INMA_dbh)))*length(x_INMA)  # exponential distribution
y_INMA_POW = ((x_INMA_dbh)^(-(result_INMA$p_pow)))*length(x_INMA) # power function distribution
y_INMA_WEI = (exp(1/((result_INMA$p1_wei)^(result_INMA$p2_wei))-(x_INMA_dbh/(result_INMA$p1_wei))^(result_INMA$p2_wei)))*length(x_INMA) # Weibull distribution
y_INMA_QWEI = (1-cumsum(qwei_INMA(x_INMA_dbh)*(max(x_INMA)-min(x_INMA))/length(x_INMA_dbh)))*length(x_INMA) # quasi_Weibull distribution

lines(x_INMA_dbh, y_INMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INMA_dbh, y_INMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INMA_dbh, y_INMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INMA_dbh, y_INMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INMA_dbh, y_INMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INMA_dbh, y_INMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INMA", bty="n",cex=1.5)

#### Inga nobilis
BCI_INNO = subset(bci_2015_live,Latin=="Inga nobilis")
x_INNO = BCI_INNO$DBH/min(BCI_INNO$DBH)
length(x_INNO)
x_INNO_dbh = seq(min(x_INNO),max(x_INNO),length=10*length(x_INNO))
result_INNO = subset(result_bci_sp_all,Latin=="Inga nobilis")

plot(sort(x_INNO, decreasing=TRUE), 1:length(x_INNO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INNO), max(x_INNO)), ylim = c(1, length(x_INNO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INNO = function(x){
  b_pop = result_INNO$b_pmete
  n_pop = result_INNO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INNO = function(x){
  b_pop = 2
  n_pop = result_INNO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INNO = function(x){
  al_pop = result_INNO$p1_qwei
  be_pop = result_INNO$p2_qwei
  ga_pop = result_INNO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INNO_PMETE = (1-cumsum(fx_INNO(x_INNO_dbh)*(max(x_INNO)-min(x_INNO))/length(x_INNO_dbh)))*length(x_INNO) # parametrized mete prediction
y_INNO_METE = (1-cumsum(gx_INNO(x_INNO_dbh)*(max(x_INNO)-min(x_INNO))/length(x_INNO_dbh)))*length(x_INNO) # mete prediction
y_INNO_EXP = exp(-(result_INNO$p_exp)*(x_INNO_dbh-min(x_INNO_dbh)))*length(x_INNO)  # exponential distribution
y_INNO_POW = ((x_INNO_dbh)^(-(result_INNO$p_pow)))*length(x_INNO) # power function distribution
y_INNO_WEI = (exp(1/((result_INNO$p1_wei)^(result_INNO$p2_wei))-(x_INNO_dbh/(result_INNO$p1_wei))^(result_INNO$p2_wei)))*length(x_INNO) # Weibull distribution
y_INNO_QWEI = (1-cumsum(qwei_INNO(x_INNO_dbh)*(max(x_INNO)-min(x_INNO))/length(x_INNO_dbh)))*length(x_INNO) # quasi_Weibull distribution

lines(x_INNO_dbh, y_INNO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INNO_dbh, y_INNO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INNO_dbh, y_INNO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INNO_dbh, y_INNO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INNO_dbh, y_INNO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INNO_dbh, y_INNO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INNO", bty="n",cex=1.5)

#### Inga pezizifera
BCI_INPE = subset(bci_2015_live,Latin=="Inga pezizifera")
x_INPE = BCI_INPE$DBH/min(BCI_INPE$DBH)
length(x_INPE)
x_INPE_dbh = seq(min(x_INPE),max(x_INPE),length=10*length(x_INPE))
result_INPE = subset(result_bci_sp_all,Latin=="Inga pezizifera")

plot(sort(x_INPE, decreasing=TRUE), 1:length(x_INPE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INPE), max(x_INPE)), ylim = c(1, length(x_INPE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INPE = function(x){
  b_pop = result_INPE$b_pmete
  n_pop = result_INPE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INPE = function(x){
  b_pop = 2
  n_pop = result_INPE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INPE = function(x){
  al_pop = result_INPE$p1_qwei
  be_pop = result_INPE$p2_qwei
  ga_pop = result_INPE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INPE_PMETE = (1-cumsum(fx_INPE(x_INPE_dbh)*(max(x_INPE)-min(x_INPE))/length(x_INPE_dbh)))*length(x_INPE) # parametrized mete prediction
y_INPE_METE = (1-cumsum(gx_INPE(x_INPE_dbh)*(max(x_INPE)-min(x_INPE))/length(x_INPE_dbh)))*length(x_INPE) # mete prediction
y_INPE_EXP = exp(-(result_INPE$p_exp)*(x_INPE_dbh-min(x_INPE_dbh)))*length(x_INPE)  # exponential distribution
y_INPE_POW = ((x_INPE_dbh)^(-(result_INPE$p_pow)))*length(x_INPE) # power function distribution
y_INPE_WEI = (exp(1/((result_INPE$p1_wei)^(result_INPE$p2_wei))-(x_INPE_dbh/(result_INPE$p1_wei))^(result_INPE$p2_wei)))*length(x_INPE) # Weibull distribution
y_INPE_QWEI = (1-cumsum(qwei_INPE(x_INPE_dbh)*(max(x_INPE)-min(x_INPE))/length(x_INPE_dbh)))*length(x_INPE) # quasi_Weibull distribution

lines(x_INPE_dbh, y_INPE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INPE_dbh, y_INPE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INPE_dbh, y_INPE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INPE_dbh, y_INPE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INPE_dbh, y_INPE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INPE_dbh, y_INPE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INPE", bty="n",cex=1.5)

#### Inga sapindoides
BCI_INSA = subset(bci_2015_live,Latin=="Inga sapindoides")
x_INSA = BCI_INSA$DBH/min(BCI_INSA$DBH)
length(x_INSA)
x_INSA_dbh = seq(min(x_INSA),max(x_INSA),length=10*length(x_INSA))
result_INSA = subset(result_bci_sp_all,Latin=="Inga sapindoides")

plot(sort(x_INSA, decreasing=TRUE), 1:length(x_INSA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INSA), max(x_INSA)), ylim = c(1, length(x_INSA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INSA = function(x){
  b_pop = result_INSA$b_pmete
  n_pop = result_INSA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INSA = function(x){
  b_pop = 2
  n_pop = result_INSA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INSA = function(x){
  al_pop = result_INSA$p1_qwei
  be_pop = result_INSA$p2_qwei
  ga_pop = result_INSA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INSA_PMETE = (1-cumsum(fx_INSA(x_INSA_dbh)*(max(x_INSA)-min(x_INSA))/length(x_INSA_dbh)))*length(x_INSA) # parametrized mete prediction
y_INSA_METE = (1-cumsum(gx_INSA(x_INSA_dbh)*(max(x_INSA)-min(x_INSA))/length(x_INSA_dbh)))*length(x_INSA) # mete prediction
y_INSA_EXP = exp(-(result_INSA$p_exp)*(x_INSA_dbh-min(x_INSA_dbh)))*length(x_INSA)  # exponential distribution
y_INSA_POW = ((x_INSA_dbh)^(-(result_INSA$p_pow)))*length(x_INSA) # power function distribution
y_INSA_WEI = (exp(1/((result_INSA$p1_wei)^(result_INSA$p2_wei))-(x_INSA_dbh/(result_INSA$p1_wei))^(result_INSA$p2_wei)))*length(x_INSA) # Weibull distribution
y_INSA_QWEI = (1-cumsum(qwei_INSA(x_INSA_dbh)*(max(x_INSA)-min(x_INSA))/length(x_INSA_dbh)))*length(x_INSA) # quasi_Weibull distribution

lines(x_INSA_dbh, y_INSA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INSA_dbh, y_INSA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INSA_dbh, y_INSA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INSA_dbh, y_INSA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INSA_dbh, y_INSA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INSA_dbh, y_INSA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INSA", bty="n",cex=1.5)

#### Inga thibaudiana
BCI_INTH = subset(bci_2015_live,Latin=="Inga thibaudiana")
x_INTH = BCI_INTH$DBH/min(BCI_INTH$DBH)
length(x_INTH)
x_INTH_dbh = seq(min(x_INTH),max(x_INTH),length=10*length(x_INTH))
result_INTH = subset(result_bci_sp_all,Latin=="Inga thibaudiana")

plot(sort(x_INTH, decreasing=TRUE), 1:length(x_INTH), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INTH), max(x_INTH)), ylim = c(1, length(x_INTH)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INTH = function(x){
  b_pop = result_INTH$b_pmete
  n_pop = result_INTH$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INTH = function(x){
  b_pop = 2
  n_pop = result_INTH$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INTH = function(x){
  al_pop = result_INTH$p1_qwei
  be_pop = result_INTH$p2_qwei
  ga_pop = result_INTH$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INTH_PMETE = (1-cumsum(fx_INTH(x_INTH_dbh)*(max(x_INTH)-min(x_INTH))/length(x_INTH_dbh)))*length(x_INTH) # parametrized mete prediction
y_INTH_METE = (1-cumsum(gx_INTH(x_INTH_dbh)*(max(x_INTH)-min(x_INTH))/length(x_INTH_dbh)))*length(x_INTH) # mete prediction
y_INTH_EXP = exp(-(result_INTH$p_exp)*(x_INTH_dbh-min(x_INTH_dbh)))*length(x_INTH)  # exponential distribution
y_INTH_POW = ((x_INTH_dbh)^(-(result_INTH$p_pow)))*length(x_INTH) # power function distribution
y_INTH_WEI = (exp(1/((result_INTH$p1_wei)^(result_INTH$p2_wei))-(x_INTH_dbh/(result_INTH$p1_wei))^(result_INTH$p2_wei)))*length(x_INTH) # Weibull distribution
y_INTH_QWEI = (1-cumsum(qwei_INTH(x_INTH_dbh)*(max(x_INTH)-min(x_INTH))/length(x_INTH_dbh)))*length(x_INTH) # quasi_Weibull distribution

lines(x_INTH_dbh, y_INTH_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INTH_dbh, y_INTH_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INTH_dbh, y_INTH_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INTH_dbh, y_INTH_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INTH_dbh, y_INTH_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INTH_dbh, y_INTH_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INTH", bty="n",cex=1.5)

#### Inga umbellifera
BCI_INUM = subset(bci_2015_live,Latin=="Inga umbellifera")
x_INUM = BCI_INUM$DBH/min(BCI_INUM$DBH)
length(x_INUM)
x_INUM_dbh = seq(min(x_INUM),max(x_INUM),length=10*length(x_INUM))
result_INUM = subset(result_bci_sp_all,Latin=="Inga umbellifera")

plot(sort(x_INUM, decreasing=TRUE), 1:length(x_INUM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_INUM), max(x_INUM)), ylim = c(1, length(x_INUM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_INUM = function(x){
  b_pop = result_INUM$b_pmete
  n_pop = result_INUM$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_INUM = function(x){
  b_pop = 2
  n_pop = result_INUM$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_INUM = function(x){
  al_pop = result_INUM$p1_qwei
  be_pop = result_INUM$p2_qwei
  ga_pop = result_INUM$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_INUM_PMETE = (1-cumsum(fx_INUM(x_INUM_dbh)*(max(x_INUM)-min(x_INUM))/length(x_INUM_dbh)))*length(x_INUM) # parametrized mete prediction
y_INUM_METE = (1-cumsum(gx_INUM(x_INUM_dbh)*(max(x_INUM)-min(x_INUM))/length(x_INUM_dbh)))*length(x_INUM) # mete prediction
y_INUM_EXP = exp(-(result_INUM$p_exp)*(x_INUM_dbh-min(x_INUM_dbh)))*length(x_INUM)  # exponential distribution
y_INUM_POW = ((x_INUM_dbh)^(-(result_INUM$p_pow)))*length(x_INUM) # power function distribution
y_INUM_WEI = (exp(1/((result_INUM$p1_wei)^(result_INUM$p2_wei))-(x_INUM_dbh/(result_INUM$p1_wei))^(result_INUM$p2_wei)))*length(x_INUM) # Weibull distribution
y_INUM_QWEI = (1-cumsum(qwei_INUM(x_INUM_dbh)*(max(x_INUM)-min(x_INUM))/length(x_INUM_dbh)))*length(x_INUM) # quasi_Weibull distribution

lines(x_INUM_dbh, y_INUM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_INUM_dbh, y_INUM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_INUM_dbh, y_INUM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_INUM_dbh, y_INUM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_INUM_dbh, y_INUM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_INUM_dbh, y_INUM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "INUM", bty="n",cex=1.5)

#### Lonchocarpus heptaphyllus
BCI_LOHE = subset(bci_2015_live,Latin=="Lonchocarpus heptaphyllus")
x_LOHE = BCI_LOHE$DBH/min(BCI_LOHE$DBH)
length(x_LOHE)
x_LOHE_dbh = seq(min(x_LOHE),max(x_LOHE),length=10*length(x_LOHE))
result_LOHE = subset(result_bci_sp_all,Latin=="Lonchocarpus heptaphyllus")

plot(sort(x_LOHE, decreasing=TRUE), 1:length(x_LOHE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LOHE), max(x_LOHE)), ylim = c(1, length(x_LOHE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_LOHE = function(x){
  b_pop = result_LOHE$b_pmete
  n_pop = result_LOHE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LOHE = function(x){
  b_pop = 2
  n_pop = result_LOHE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LOHE = function(x){
  al_pop = result_LOHE$p1_qwei
  be_pop = result_LOHE$p2_qwei
  ga_pop = result_LOHE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LOHE_PMETE = (1-cumsum(fx_LOHE(x_LOHE_dbh)*(max(x_LOHE)-min(x_LOHE))/length(x_LOHE_dbh)))*length(x_LOHE) # parametrized mete prediction
y_LOHE_METE = (1-cumsum(gx_LOHE(x_LOHE_dbh)*(max(x_LOHE)-min(x_LOHE))/length(x_LOHE_dbh)))*length(x_LOHE) # mete prediction
y_LOHE_EXP = exp(-(result_LOHE$p_exp)*(x_LOHE_dbh-min(x_LOHE_dbh)))*length(x_LOHE)  # exponential distribution
y_LOHE_POW = ((x_LOHE_dbh)^(-(result_LOHE$p_pow)))*length(x_LOHE) # power function distribution
y_LOHE_WEI = (exp(1/((result_LOHE$p1_wei)^(result_LOHE$p2_wei))-(x_LOHE_dbh/(result_LOHE$p1_wei))^(result_LOHE$p2_wei)))*length(x_LOHE) # Weibull distribution
y_LOHE_QWEI = (1-cumsum(qwei_LOHE(x_LOHE_dbh)*(max(x_LOHE)-min(x_LOHE))/length(x_LOHE_dbh)))*length(x_LOHE) # quasi_Weibull distribution

lines(x_LOHE_dbh, y_LOHE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LOHE_dbh, y_LOHE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LOHE_dbh, y_LOHE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LOHE_dbh, y_LOHE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LOHE_dbh, y_LOHE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LOHE_dbh, y_LOHE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LOHE", bty="n",cex=1.5)

#### Ormosia coccinea
BCI_ORCO = subset(bci_2015_live,Latin=="Ormosia coccinea")
x_ORCO = BCI_ORCO$DBH/min(BCI_ORCO$DBH)
length(x_ORCO)
x_ORCO_dbh = seq(min(x_ORCO),max(x_ORCO),length=10*length(x_ORCO))
result_ORCO = subset(result_bci_sp_all,Latin=="Ormosia coccinea")

plot(sort(x_ORCO, decreasing=TRUE), 1:length(x_ORCO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ORCO), max(x_ORCO)), ylim = c(1, length(x_ORCO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ORCO = function(x){
  b_pop = result_ORCO$b_pmete
  n_pop = result_ORCO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ORCO = function(x){
  b_pop = 2
  n_pop = result_ORCO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ORCO = function(x){
  al_pop = result_ORCO$p1_qwei
  be_pop = result_ORCO$p2_qwei
  ga_pop = result_ORCO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ORCO_PMETE = (1-cumsum(fx_ORCO(x_ORCO_dbh)*(max(x_ORCO)-min(x_ORCO))/length(x_ORCO_dbh)))*length(x_ORCO) # parametrized mete prediction
y_ORCO_METE = (1-cumsum(gx_ORCO(x_ORCO_dbh)*(max(x_ORCO)-min(x_ORCO))/length(x_ORCO_dbh)))*length(x_ORCO) # mete prediction
y_ORCO_EXP = exp(-(result_ORCO$p_exp)*(x_ORCO_dbh-min(x_ORCO_dbh)))*length(x_ORCO)  # exponential distribution
y_ORCO_POW = ((x_ORCO_dbh)^(-(result_ORCO$p_pow)))*length(x_ORCO) # power function distribution
y_ORCO_WEI = (exp(1/((result_ORCO$p1_wei)^(result_ORCO$p2_wei))-(x_ORCO_dbh/(result_ORCO$p1_wei))^(result_ORCO$p2_wei)))*length(x_ORCO) # Weibull distribution
y_ORCO_QWEI = (1-cumsum(qwei_ORCO(x_ORCO_dbh)*(max(x_ORCO)-min(x_ORCO))/length(x_ORCO_dbh)))*length(x_ORCO) # quasi_Weibull distribution

lines(x_ORCO_dbh, y_ORCO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ORCO_dbh, y_ORCO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ORCO_dbh, y_ORCO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ORCO_dbh, y_ORCO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ORCO_dbh, y_ORCO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ORCO_dbh, y_ORCO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ORCO", bty="n",cex=1.5)

#### Ormosia macrocalyx
BCI_ORMA = subset(bci_2015_live,Latin=="Ormosia macrocalyx")
x_ORMA = BCI_ORMA$DBH/min(BCI_ORMA$DBH)
length(x_ORMA)
x_ORMA_dbh = seq(min(x_ORMA),max(x_ORMA),length=10*length(x_ORMA))
result_ORMA = subset(result_bci_sp_all,Latin=="Ormosia macrocalyx")

plot(sort(x_ORMA, decreasing=TRUE), 1:length(x_ORMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ORMA), max(x_ORMA)), ylim = c(1, length(x_ORMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ORMA = function(x){
  b_pop = result_ORMA$b_pmete
  n_pop = result_ORMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ORMA = function(x){
  b_pop = 2
  n_pop = result_ORMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ORMA = function(x){
  al_pop = result_ORMA$p1_qwei
  be_pop = result_ORMA$p2_qwei
  ga_pop = result_ORMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ORMA_PMETE = (1-cumsum(fx_ORMA(x_ORMA_dbh)*(max(x_ORMA)-min(x_ORMA))/length(x_ORMA_dbh)))*length(x_ORMA) # parametrized mete prediction
y_ORMA_METE = (1-cumsum(gx_ORMA(x_ORMA_dbh)*(max(x_ORMA)-min(x_ORMA))/length(x_ORMA_dbh)))*length(x_ORMA) # mete prediction
y_ORMA_EXP = exp(-(result_ORMA$p_exp)*(x_ORMA_dbh-min(x_ORMA_dbh)))*length(x_ORMA)  # exponential distribution
y_ORMA_POW = ((x_ORMA_dbh)^(-(result_ORMA$p_pow)))*length(x_ORMA) # power function distribution
y_ORMA_WEI = (exp(1/((result_ORMA$p1_wei)^(result_ORMA$p2_wei))-(x_ORMA_dbh/(result_ORMA$p1_wei))^(result_ORMA$p2_wei)))*length(x_ORMA) # Weibull distribution
y_ORMA_QWEI = (1-cumsum(qwei_ORMA(x_ORMA_dbh)*(max(x_ORMA)-min(x_ORMA))/length(x_ORMA_dbh)))*length(x_ORMA) # quasi_Weibull distribution

lines(x_ORMA_dbh, y_ORMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ORMA_dbh, y_ORMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ORMA_dbh, y_ORMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ORMA_dbh, y_ORMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ORMA_dbh, y_ORMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ORMA_dbh, y_ORMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ORMA", bty="n",cex=1.5)

#### Platymiscium pinnatum
BCI_PLPI = subset(bci_2015_live,Latin=="Platymiscium pinnatum")
x_PLPI = BCI_PLPI$DBH/min(BCI_PLPI$DBH)
length(x_PLPI)
x_PLPI_dbh = seq(min(x_PLPI),max(x_PLPI),length=10*length(x_PLPI))
result_PLPI = subset(result_bci_sp_all,Latin=="Platymiscium pinnatum")

plot(sort(x_PLPI, decreasing=TRUE), 1:length(x_PLPI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PLPI), max(x_PLPI)), ylim = c(1, length(x_PLPI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PLPI = function(x){
  b_pop = result_PLPI$b_pmete
  n_pop = result_PLPI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PLPI = function(x){
  b_pop = 2
  n_pop = result_PLPI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PLPI = function(x){
  al_pop = result_PLPI$p1_qwei
  be_pop = result_PLPI$p2_qwei
  ga_pop = result_PLPI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PLPI_PMETE = (1-cumsum(fx_PLPI(x_PLPI_dbh)*(max(x_PLPI)-min(x_PLPI))/length(x_PLPI_dbh)))*length(x_PLPI) # parametrized mete prediction
y_PLPI_METE = (1-cumsum(gx_PLPI(x_PLPI_dbh)*(max(x_PLPI)-min(x_PLPI))/length(x_PLPI_dbh)))*length(x_PLPI) # mete prediction
y_PLPI_EXP = exp(-(result_PLPI$p_exp)*(x_PLPI_dbh-min(x_PLPI_dbh)))*length(x_PLPI)  # exponential distribution
y_PLPI_POW = ((x_PLPI_dbh)^(-(result_PLPI$p_pow)))*length(x_PLPI) # power function distribution
y_PLPI_WEI = (exp(1/((result_PLPI$p1_wei)^(result_PLPI$p2_wei))-(x_PLPI_dbh/(result_PLPI$p1_wei))^(result_PLPI$p2_wei)))*length(x_PLPI) # Weibull distribution
y_PLPI_QWEI = (1-cumsum(qwei_PLPI(x_PLPI_dbh)*(max(x_PLPI)-min(x_PLPI))/length(x_PLPI_dbh)))*length(x_PLPI) # quasi_Weibull distribution

lines(x_PLPI_dbh, y_PLPI_PMETE, col="black",lwd=2) #, lty=5)
lines(x_PLPI_dbh, y_PLPI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PLPI_dbh, y_PLPI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PLPI_dbh, y_PLPI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PLPI_dbh, y_PLPI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PLPI_dbh, y_PLPI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PLPI", bty="n",cex=1.5)

#### Platypodium elegans
BCI_PLEL = subset(bci_2015_live,Latin=="Platypodium elegans")
x_PLEL = BCI_PLEL$DBH/min(BCI_PLEL$DBH)
length(x_PLEL)
x_PLEL_dbh = seq(min(x_PLEL),max(x_PLEL),length=10*length(x_PLEL))
result_PLEL = subset(result_bci_sp_all,Latin=="Platypodium elegans")

plot(sort(x_PLEL, decreasing=TRUE), 1:length(x_PLEL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PLEL), max(x_PLEL)), ylim = c(1, length(x_PLEL)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PLEL = function(x){
  b_pop = result_PLEL$b_pmete
  n_pop = result_PLEL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PLEL = function(x){
  b_pop = 2
  n_pop = result_PLEL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PLEL = function(x){
  al_pop = result_PLEL$p1_qwei
  be_pop = result_PLEL$p2_qwei
  ga_pop = result_PLEL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PLEL_PMETE = (1-cumsum(fx_PLEL(x_PLEL_dbh)*(max(x_PLEL)-min(x_PLEL))/length(x_PLEL_dbh)))*length(x_PLEL) # parametrized mete prediction
y_PLEL_METE = (1-cumsum(gx_PLEL(x_PLEL_dbh)*(max(x_PLEL)-min(x_PLEL))/length(x_PLEL_dbh)))*length(x_PLEL) # mete prediction
y_PLEL_EXP = exp(-(result_PLEL$p_exp)*(x_PLEL_dbh-min(x_PLEL_dbh)))*length(x_PLEL)  # exponential distribution
y_PLEL_POW = ((x_PLEL_dbh)^(-(result_PLEL$p_pow)))*length(x_PLEL) # power function distribution
y_PLEL_WEI = (exp(1/((result_PLEL$p1_wei)^(result_PLEL$p2_wei))-(x_PLEL_dbh/(result_PLEL$p1_wei))^(result_PLEL$p2_wei)))*length(x_PLEL) # Weibull distribution
y_PLEL_QWEI = (1-cumsum(qwei_PLEL(x_PLEL_dbh)*(max(x_PLEL)-min(x_PLEL))/length(x_PLEL_dbh)))*length(x_PLEL) # quasi_Weibull distribution

lines(x_PLEL_dbh, y_PLEL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PLEL_dbh, y_PLEL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PLEL_dbh, y_PLEL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PLEL_dbh, y_PLEL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PLEL_dbh, y_PLEL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PLEL_dbh, y_PLEL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PLEL", bty="n",cex=1.5)

#### Prioria copaifera
BCI_PRCO = subset(bci_2015_live,Latin=="Prioria copaifera")
x_PRCO = BCI_PRCO$DBH/min(BCI_PRCO$DBH)
length(x_PRCO)
x_PRCO_dbh = seq(min(x_PRCO),max(x_PRCO),length=10*length(x_PRCO))
result_PRCO = subset(result_bci_sp_all,Latin=="Prioria copaifera")

plot(sort(x_PRCO, decreasing=TRUE), 1:length(x_PRCO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PRCO), max(x_PRCO)), ylim = c(1, length(x_PRCO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PRCO = function(x){
  b_pop = result_PRCO$b_pmete
  n_pop = result_PRCO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PRCO = function(x){
  b_pop = 2
  n_pop = result_PRCO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PRCO = function(x){
  al_pop = result_PRCO$p1_qwei
  be_pop = result_PRCO$p2_qwei
  ga_pop = result_PRCO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PRCO_PMETE = (1-cumsum(fx_PRCO(x_PRCO_dbh)*(max(x_PRCO)-min(x_PRCO))/length(x_PRCO_dbh)))*length(x_PRCO) # parametrized mete prediction
y_PRCO_METE = (1-cumsum(gx_PRCO(x_PRCO_dbh)*(max(x_PRCO)-min(x_PRCO))/length(x_PRCO_dbh)))*length(x_PRCO) # mete prediction
y_PRCO_EXP = exp(-(result_PRCO$p_exp)*(x_PRCO_dbh-min(x_PRCO_dbh)))*length(x_PRCO)  # exponential distribution
y_PRCO_POW = ((x_PRCO_dbh)^(-(result_PRCO$p_pow)))*length(x_PRCO) # power function distribution
y_PRCO_WEI = (exp(1/((result_PRCO$p1_wei)^(result_PRCO$p2_wei))-(x_PRCO_dbh/(result_PRCO$p1_wei))^(result_PRCO$p2_wei)))*length(x_PRCO) # Weibull distribution
y_PRCO_QWEI = (1-cumsum(qwei_PRCO(x_PRCO_dbh)*(max(x_PRCO)-min(x_PRCO))/length(x_PRCO_dbh)))*length(x_PRCO) # quasi_Weibull distribution

lines(x_PRCO_dbh, y_PRCO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PRCO", bty="n",cex=1.5)

#### Pterocarpus rohrii
BCI_PTRO = subset(bci_2015_live,Latin=="Pterocarpus rohrii")
x_PTRO = BCI_PTRO$DBH/min(BCI_PTRO$DBH)
length(x_PTRO)
x_PTRO_dbh = seq(min(x_PTRO),max(x_PTRO),length=10*length(x_PTRO))
result_PTRO = subset(result_bci_sp_all,Latin=="Pterocarpus rohrii")

plot(sort(x_PTRO, decreasing=TRUE), 1:length(x_PTRO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PTRO), max(x_PTRO)), ylim = c(1, length(x_PTRO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PTRO = function(x){
  b_pop = result_PTRO$b_pmete
  n_pop = result_PTRO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PTRO = function(x){
  b_pop = 2
  n_pop = result_PTRO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PTRO = function(x){
  al_pop = result_PTRO$p1_qwei
  be_pop = result_PTRO$p2_qwei
  ga_pop = result_PTRO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PTRO_PMETE = (1-cumsum(fx_PTRO(x_PTRO_dbh)*(max(x_PTRO)-min(x_PTRO))/length(x_PTRO_dbh)))*length(x_PTRO) # parametrized mete prediction
y_PTRO_METE = (1-cumsum(gx_PTRO(x_PTRO_dbh)*(max(x_PTRO)-min(x_PTRO))/length(x_PTRO_dbh)))*length(x_PTRO) # mete prediction
y_PTRO_EXP = exp(-(result_PTRO$p_exp)*(x_PTRO_dbh-min(x_PTRO_dbh)))*length(x_PTRO)  # exponential distribution
y_PTRO_POW = ((x_PTRO_dbh)^(-(result_PTRO$p_pow)))*length(x_PTRO) # power function distribution
y_PTRO_WEI = (exp(1/((result_PTRO$p1_wei)^(result_PTRO$p2_wei))-(x_PTRO_dbh/(result_PTRO$p1_wei))^(result_PTRO$p2_wei)))*length(x_PTRO) # Weibull distribution
y_PTRO_QWEI = (1-cumsum(qwei_PTRO(x_PTRO_dbh)*(max(x_PTRO)-min(x_PTRO))/length(x_PTRO_dbh)))*length(x_PTRO) # quasi_Weibull distribution

lines(x_PTRO_dbh, y_PTRO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PTRO_dbh, y_PTRO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PTRO_dbh, y_PTRO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PTRO_dbh, y_PTRO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PTRO_dbh, y_PTRO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PTRO_dbh, y_PTRO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PTRO", bty="n",cex=1.5)

#### Senna dariensis
BCI_SEDA = subset(bci_2015_live,Latin=="Senna dariensis")
x_SEDA = BCI_SEDA$DBH/min(BCI_SEDA$DBH)
length(x_SEDA)
x_SEDA_dbh = seq(min(x_SEDA),max(x_SEDA),length=10*length(x_SEDA))
result_SEDA = subset(result_bci_sp_all,Latin=="Senna dariensis")

plot(sort(x_SEDA, decreasing=TRUE), 1:length(x_SEDA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SEDA), max(x_SEDA)), ylim = c(1, length(x_SEDA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SEDA = function(x){
  b_pop = result_SEDA$b_pmete
  n_pop = result_SEDA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SEDA = function(x){
  b_pop = 2
  n_pop = result_SEDA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SEDA = function(x){
  al_pop = result_SEDA$p1_qwei
  be_pop = result_SEDA$p2_qwei
  ga_pop = result_SEDA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SEDA_PMETE = (1-cumsum(fx_SEDA(x_SEDA_dbh)*(max(x_SEDA)-min(x_SEDA))/length(x_SEDA_dbh)))*length(x_SEDA) # parametrized mete prediction
y_SEDA_METE = (1-cumsum(gx_SEDA(x_SEDA_dbh)*(max(x_SEDA)-min(x_SEDA))/length(x_SEDA_dbh)))*length(x_SEDA) # mete prediction
y_SEDA_EXP = exp(-(result_SEDA$p_exp)*(x_SEDA_dbh-min(x_SEDA_dbh)))*length(x_SEDA)  # exponential distribution
y_SEDA_POW = ((x_SEDA_dbh)^(-(result_SEDA$p_pow)))*length(x_SEDA) # power function distribution
y_SEDA_WEI = (exp(1/((result_SEDA$p1_wei)^(result_SEDA$p2_wei))-(x_SEDA_dbh/(result_SEDA$p1_wei))^(result_SEDA$p2_wei)))*length(x_SEDA) # Weibull distribution
y_SEDA_QWEI = (1-cumsum(qwei_SEDA(x_SEDA_dbh)*(max(x_SEDA)-min(x_SEDA))/length(x_SEDA_dbh)))*length(x_SEDA) # quasi_Weibull distribution

lines(x_SEDA_dbh, y_SEDA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SEDA_dbh, y_SEDA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SEDA_dbh, y_SEDA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SEDA_dbh, y_SEDA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SEDA_dbh, y_SEDA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SEDA_dbh, y_SEDA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SEDA", bty="n",cex=1.5)

#### Swartzia simplex
BCI_SWSI = subset(bci_2015_live,Latin=="Swartzia simplex")
x_SWSI = BCI_SWSI$DBH/min(BCI_SWSI$DBH)
length(x_SWSI)
x_SWSI_dbh = seq(min(x_SWSI),max(x_SWSI),length=10*length(x_SWSI))
result_SWSI = subset(result_bci_sp_all,Latin=="Swartzia simplex")

plot(sort(x_SWSI, decreasing=TRUE), 1:length(x_SWSI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SWSI), max(x_SWSI)), ylim = c(1, length(x_SWSI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SWSI = function(x){
  b_pop = result_SWSI$b_pmete
  n_pop = result_SWSI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SWSI = function(x){
  b_pop = 2
  n_pop = result_SWSI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SWSI = function(x){
  al_pop = result_SWSI$p1_qwei
  be_pop = result_SWSI$p2_qwei
  ga_pop = result_SWSI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SWSI_PMETE = (1-cumsum(fx_SWSI(x_SWSI_dbh)*(max(x_SWSI)-min(x_SWSI))/length(x_SWSI_dbh)))*length(x_SWSI) # parametrized mete prediction
y_SWSI_METE = (1-cumsum(gx_SWSI(x_SWSI_dbh)*(max(x_SWSI)-min(x_SWSI))/length(x_SWSI_dbh)))*length(x_SWSI) # mete prediction
y_SWSI_EXP = exp(-(result_SWSI$p_exp)*(x_SWSI_dbh-min(x_SWSI_dbh)))*length(x_SWSI)  # exponential distribution
y_SWSI_POW = ((x_SWSI_dbh)^(-(result_SWSI$p_pow)))*length(x_SWSI) # power function distribution
y_SWSI_WEI = (exp(1/((result_SWSI$p1_wei)^(result_SWSI$p2_wei))-(x_SWSI_dbh/(result_SWSI$p1_wei))^(result_SWSI$p2_wei)))*length(x_SWSI) # Weibull distribution
y_SWSI_QWEI = (1-cumsum(qwei_SWSI(x_SWSI_dbh)*(max(x_SWSI)-min(x_SWSI))/length(x_SWSI_dbh)))*length(x_SWSI) # quasi_Weibull distribution

lines(x_SWSI_dbh, y_SWSI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SWSI_dbh, y_SWSI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SWSI_dbh, y_SWSI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SWSI_dbh, y_SWSI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SWSI_dbh, y_SWSI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SWSI_dbh, y_SWSI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SWSI", bty="n",cex=1.5)

#### Tachigali versicolor
BCI_TAVE = subset(bci_2015_live,Latin=="Tachigali versicolor")
x_TAVE = BCI_TAVE$DBH/min(BCI_TAVE$DBH)
length(x_TAVE)
x_TAVE_dbh = seq(min(x_TAVE),max(x_TAVE),length=10*length(x_TAVE))
result_TAVE = subset(result_bci_sp_all,Latin=="Tachigali versicolor")

plot(sort(x_TAVE, decreasing=TRUE), 1:length(x_TAVE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TAVE), max(x_TAVE)), ylim = c(1, length(x_TAVE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TAVE = function(x){
  b_pop = result_TAVE$b_pmete
  n_pop = result_TAVE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TAVE = function(x){
  b_pop = 2
  n_pop = result_TAVE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TAVE = function(x){
  al_pop = result_TAVE$p1_qwei
  be_pop = result_TAVE$p2_qwei
  ga_pop = result_TAVE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TAVE_PMETE = (1-cumsum(fx_TAVE(x_TAVE_dbh)*(max(x_TAVE)-min(x_TAVE))/length(x_TAVE_dbh)))*length(x_TAVE) # parametrized mete prediction
y_TAVE_METE = (1-cumsum(gx_TAVE(x_TAVE_dbh)*(max(x_TAVE)-min(x_TAVE))/length(x_TAVE_dbh)))*length(x_TAVE) # mete prediction
y_TAVE_EXP = exp(-(result_TAVE$p_exp)*(x_TAVE_dbh-min(x_TAVE_dbh)))*length(x_TAVE)  # exponential distribution
y_TAVE_POW = ((x_TAVE_dbh)^(-(result_TAVE$p_pow)))*length(x_TAVE) # power function distribution
y_TAVE_WEI = (exp(1/((result_TAVE$p1_wei)^(result_TAVE$p2_wei))-(x_TAVE_dbh/(result_TAVE$p1_wei))^(result_TAVE$p2_wei)))*length(x_TAVE) # Weibull distribution
y_TAVE_QWEI = (1-cumsum(qwei_TAVE(x_TAVE_dbh)*(max(x_TAVE)-min(x_TAVE))/length(x_TAVE_dbh)))*length(x_TAVE) # quasi_Weibull distribution

lines(x_TAVE_dbh, y_TAVE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TAVE_dbh, y_TAVE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TAVE_dbh, y_TAVE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TAVE_dbh, y_TAVE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TAVE_dbh, y_TAVE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TAVE_dbh, y_TAVE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TAVE", bty="n",cex=1.5)
```
### BCI (Order=Gentianales)
```{r}
par(mfrow=c(4,4),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Alibertia edulis
BCI_ALED = subset(bci_2015_live,Latin=="Alibertia edulis")
x_ALED = BCI_ALED$DBH/min(BCI_ALED$DBH)
length(x_ALED)
x_ALED_dbh = seq(min(x_ALED),max(x_ALED),length=10*length(x_ALED))
result_ALED = subset(result_bci_sp_all,Latin=="Alibertia edulis")

plot(sort(x_ALED, decreasing=TRUE), 1:length(x_ALED), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ALED), max(x_ALED)), ylim = c(1, length(x_ALED)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ALED = function(x){
  b_pop = result_ALED$b_pmete
  n_pop = result_ALED$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ALED = function(x){
  b_pop = 2
  n_pop = result_ALED$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ALED = function(x){
  al_pop = result_ALED$p1_qwei
  be_pop = result_ALED$p2_qwei
  ga_pop = result_ALED$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ALED_PMETE = (1-cumsum(fx_ALED(x_ALED_dbh)*(max(x_ALED)-min(x_ALED))/length(x_ALED_dbh)))*length(x_ALED) # parametrized mete prediction
y_ALED_METE = (1-cumsum(gx_ALED(x_ALED_dbh)*(max(x_ALED)-min(x_ALED))/length(x_ALED_dbh)))*length(x_ALED) # mete prediction
y_ALED_EXP = exp(-(result_ALED$p_exp)*(x_ALED_dbh-min(x_ALED_dbh)))*length(x_ALED)  # exponential distribution
y_ALED_POW = ((x_ALED_dbh)^(-(result_ALED$p_pow)))*length(x_ALED) # power function distribution
y_ALED_WEI = (exp(1/((result_ALED$p1_wei)^(result_ALED$p2_wei))-(x_ALED_dbh/(result_ALED$p1_wei))^(result_ALED$p2_wei)))*length(x_ALED) # Weibull distribution
y_ALED_QWEI = (1-cumsum(qwei_ALED(x_ALED_dbh)*(max(x_ALED)-min(x_ALED))/length(x_ALED_dbh)))*length(x_ALED) # quasi_Weibull distribution

lines(x_ALED_dbh, y_ALED_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ALED_dbh, y_ALED_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ALED_dbh, y_ALED_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ALED_dbh, y_ALED_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ALED_dbh, y_ALED_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ALED_dbh, y_ALED_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ALED", bty="n",cex=1.5)

#### Alseis blackiana
BCI_ALBL = subset(bci_2015_live,Latin=="Alseis blackiana")
x_ALBL = BCI_ALBL$DBH/min(BCI_ALBL$DBH)
length(x_ALBL)
x_ALBL_dbh = seq(min(x_ALBL),max(x_ALBL),length=10*length(x_ALBL))
result_ALBL = subset(result_bci_sp_all,Latin=="Alseis blackiana")

plot(sort(x_ALBL, decreasing=TRUE), 1:length(x_ALBL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ALBL), max(x_ALBL)), ylim = c(1, length(x_ALBL)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ALBL = function(x){
  b_pop = result_ALBL$b_pmete
  n_pop = result_ALBL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ALBL = function(x){
  b_pop = 2
  n_pop = result_ALBL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ALBL = function(x){
  al_pop = result_ALBL$p1_qwei
  be_pop = result_ALBL$p2_qwei
  ga_pop = result_ALBL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ALBL_PMETE = (1-cumsum(fx_ALBL(x_ALBL_dbh)*(max(x_ALBL)-min(x_ALBL))/length(x_ALBL_dbh)))*length(x_ALBL) # parametrized mete prediction
y_ALBL_METE = (1-cumsum(gx_ALBL(x_ALBL_dbh)*(max(x_ALBL)-min(x_ALBL))/length(x_ALBL_dbh)))*length(x_ALBL) # mete prediction
y_ALBL_EXP = exp(-(result_ALBL$p_exp)*(x_ALBL_dbh-min(x_ALBL_dbh)))*length(x_ALBL)  # exponential distribution
y_ALBL_POW = ((x_ALBL_dbh)^(-(result_ALBL$p_pow)))*length(x_ALBL) # power function distribution
y_ALBL_WEI = (exp(1/((result_ALBL$p1_wei)^(result_ALBL$p2_wei))-(x_ALBL_dbh/(result_ALBL$p1_wei))^(result_ALBL$p2_wei)))*length(x_ALBL) # Weibull distribution
y_ALBL_QWEI = (1-cumsum(qwei_ALBL(x_ALBL_dbh)*(max(x_ALBL)-min(x_ALBL))/length(x_ALBL_dbh)))*length(x_ALBL) # quasi_Weibull distribution

lines(x_ALBL_dbh, y_ALBL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ALBL_dbh, y_ALBL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ALBL_dbh, y_ALBL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ALBL_dbh, y_ALBL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ALBL_dbh, y_ALBL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ALBL_dbh, y_ALBL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ALBL", bty="n",cex=1.5)

#### Aspidosperma spruceanum
BCI_ASSP = subset(bci_2015_live,Latin=="Aspidosperma spruceanum")
x_ASSP = BCI_ASSP$DBH/min(BCI_ASSP$DBH)
length(x_ASSP)
x_ASSP_dbh = seq(min(x_ASSP),max(x_ASSP),length=10*length(x_ASSP))
result_ASSP = subset(result_bci_sp_all,Latin=="Aspidosperma spruceanum")

plot(sort(x_ASSP, decreasing=TRUE), 1:length(x_ASSP), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ASSP), max(x_ASSP)), ylim = c(1, length(x_ASSP)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ASSP = function(x){
  b_pop = result_ASSP$b_pmete
  n_pop = result_ASSP$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ASSP = function(x){
  b_pop = 2
  n_pop = result_ASSP$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ASSP = function(x){
  al_pop = result_ASSP$p1_qwei
  be_pop = result_ASSP$p2_qwei
  ga_pop = result_ASSP$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ASSP_PMETE = (1-cumsum(fx_ASSP(x_ASSP_dbh)*(max(x_ASSP)-min(x_ASSP))/length(x_ASSP_dbh)))*length(x_ASSP) # parametrized mete prediction
y_ASSP_METE = (1-cumsum(gx_ASSP(x_ASSP_dbh)*(max(x_ASSP)-min(x_ASSP))/length(x_ASSP_dbh)))*length(x_ASSP) # mete prediction
y_ASSP_EXP = exp(-(result_ASSP$p_exp)*(x_ASSP_dbh-min(x_ASSP_dbh)))*length(x_ASSP)  # exponential distribution
y_ASSP_POW = ((x_ASSP_dbh)^(-(result_ASSP$p_pow)))*length(x_ASSP) # power function distribution
y_ASSP_WEI = (exp(1/((result_ASSP$p1_wei)^(result_ASSP$p2_wei))-(x_ASSP_dbh/(result_ASSP$p1_wei))^(result_ASSP$p2_wei)))*length(x_ASSP) # Weibull distribution
y_ASSP_QWEI = (1-cumsum(qwei_ASSP(x_ASSP_dbh)*(max(x_ASSP)-min(x_ASSP))/length(x_ASSP_dbh)))*length(x_ASSP) # quasi_Weibull distribution

lines(x_ASSP_dbh, y_ASSP_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ASSP_dbh, y_ASSP_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ASSP_dbh, y_ASSP_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ASSP_dbh, y_ASSP_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ASSP_dbh, y_ASSP_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ASSP_dbh, y_ASSP_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ASSP", bty="n",cex=1.5)

#### Coussarea curvigemmia
BCI_COCU = subset(bci_2015_live,Latin=="Coussarea curvigemmia")
x_COCU = BCI_COCU$DBH/min(BCI_COCU$DBH)
length(x_COCU)
x_COCU_dbh = seq(min(x_COCU),max(x_COCU),length=10*length(x_COCU))
result_COCU = subset(result_bci_sp_all,Latin=="Coussarea curvigemmia")

plot(sort(x_COCU, decreasing=TRUE), 1:length(x_COCU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COCU), max(x_COCU)), ylim = c(1, length(x_COCU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COCU = function(x){
  b_pop = result_COCU$b_pmete
  n_pop = result_COCU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COCU = function(x){
  b_pop = 2
  n_pop = result_COCU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COCU = function(x){
  al_pop = result_COCU$p1_qwei
  be_pop = result_COCU$p2_qwei
  ga_pop = result_COCU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COCU_PMETE = (1-cumsum(fx_COCU(x_COCU_dbh)*(max(x_COCU)-min(x_COCU))/length(x_COCU_dbh)))*length(x_COCU) # parametrized mete prediction
y_COCU_METE = (1-cumsum(gx_COCU(x_COCU_dbh)*(max(x_COCU)-min(x_COCU))/length(x_COCU_dbh)))*length(x_COCU) # mete prediction
y_COCU_EXP = exp(-(result_COCU$p_exp)*(x_COCU_dbh-min(x_COCU_dbh)))*length(x_COCU)  # exponential distribution
y_COCU_POW = ((x_COCU_dbh)^(-(result_COCU$p_pow)))*length(x_COCU) # power function distribution
y_COCU_WEI = (exp(1/((result_COCU$p1_wei)^(result_COCU$p2_wei))-(x_COCU_dbh/(result_COCU$p1_wei))^(result_COCU$p2_wei)))*length(x_COCU) # Weibull distribution
y_COCU_QWEI = (1-cumsum(qwei_COCU(x_COCU_dbh)*(max(x_COCU)-min(x_COCU))/length(x_COCU_dbh)))*length(x_COCU) # quasi_Weibull distribution

lines(x_COCU_dbh, y_COCU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COCU_dbh, y_COCU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COCU_dbh, y_COCU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COCU_dbh, y_COCU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COCU_dbh, y_COCU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COCU_dbh, y_COCU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COCU", bty="n",cex=1.5)

#### Faramea occidentalis
BCI_FAOC = subset(bci_2015_live,Latin=="Faramea occidentalis")
x_FAOC = BCI_FAOC$DBH/min(BCI_FAOC$DBH)
length(x_FAOC)
x_FAOC_dbh = seq(min(x_FAOC),max(x_FAOC),length=10*length(x_FAOC))
result_FAOC = subset(result_bci_sp_all,Latin=="Faramea occidentalis")

plot(sort(x_FAOC, decreasing=TRUE), 1:length(x_FAOC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_FAOC), max(x_FAOC)), ylim = c(1, length(x_FAOC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_FAOC = function(x){
  b_pop = result_FAOC$b_pmete
  n_pop = result_FAOC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_FAOC = function(x){
  b_pop = 2
  n_pop = result_FAOC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_FAOC = function(x){
  al_pop = result_FAOC$p1_qwei
  be_pop = result_FAOC$p2_qwei
  ga_pop = result_FAOC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_FAOC_PMETE = (1-cumsum(fx_FAOC(x_FAOC_dbh)*(max(x_FAOC)-min(x_FAOC))/length(x_FAOC_dbh)))*length(x_FAOC) # parametrized mete prediction
y_FAOC_METE = (1-cumsum(gx_FAOC(x_FAOC_dbh)*(max(x_FAOC)-min(x_FAOC))/length(x_FAOC_dbh)))*length(x_FAOC) # mete prediction
y_FAOC_EXP = exp(-(result_FAOC$p_exp)*(x_FAOC_dbh-min(x_FAOC_dbh)))*length(x_FAOC)  # exponential distribution
y_FAOC_POW = ((x_FAOC_dbh)^(-(result_FAOC$p_pow)))*length(x_FAOC) # power function distribution
y_FAOC_WEI = (exp(1/((result_FAOC$p1_wei)^(result_FAOC$p2_wei))-(x_FAOC_dbh/(result_FAOC$p1_wei))^(result_FAOC$p2_wei)))*length(x_FAOC) # Weibull distribution
y_FAOC_QWEI = (1-cumsum(qwei_FAOC(x_FAOC_dbh)*(max(x_FAOC)-min(x_FAOC))/length(x_FAOC_dbh)))*length(x_FAOC) # quasi_Weibull distribution

lines(x_FAOC_dbh, y_FAOC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_FAOC_dbh, y_FAOC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_FAOC_dbh, y_FAOC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_FAOC_dbh, y_FAOC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_FAOC_dbh, y_FAOC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_FAOC_dbh, y_FAOC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "FAOC", bty="n",cex=1.5)

#### Guettarda foliacea
BCI_GUFO = subset(bci_2015_live,Latin=="Guettarda foliacea")
x_GUFO = BCI_GUFO$DBH/min(BCI_GUFO$DBH)
length(x_GUFO)
x_GUFO_dbh = seq(min(x_GUFO),max(x_GUFO),length=10*length(x_GUFO))
result_GUFO = subset(result_bci_sp_all,Latin=="Guettarda foliacea")

plot(sort(x_GUFO, decreasing=TRUE), 1:length(x_GUFO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUFO), max(x_GUFO)), ylim = c(1, length(x_GUFO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUFO = function(x){
  b_pop = result_GUFO$b_pmete
  n_pop = result_GUFO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUFO = function(x){
  b_pop = 2
  n_pop = result_GUFO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUFO = function(x){
  al_pop = result_GUFO$p1_qwei
  be_pop = result_GUFO$p2_qwei
  ga_pop = result_GUFO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUFO_PMETE = (1-cumsum(fx_GUFO(x_GUFO_dbh)*(max(x_GUFO)-min(x_GUFO))/length(x_GUFO_dbh)))*length(x_GUFO) # parametrized mete prediction
y_GUFO_METE = (1-cumsum(gx_GUFO(x_GUFO_dbh)*(max(x_GUFO)-min(x_GUFO))/length(x_GUFO_dbh)))*length(x_GUFO) # mete prediction
y_GUFO_EXP = exp(-(result_GUFO$p_exp)*(x_GUFO_dbh-min(x_GUFO_dbh)))*length(x_GUFO)  # exponential distribution
y_GUFO_POW = ((x_GUFO_dbh)^(-(result_GUFO$p_pow)))*length(x_GUFO) # power function distribution
y_GUFO_WEI = (exp(1/((result_GUFO$p1_wei)^(result_GUFO$p2_wei))-(x_GUFO_dbh/(result_GUFO$p1_wei))^(result_GUFO$p2_wei)))*length(x_GUFO) # Weibull distribution
y_GUFO_QWEI = (1-cumsum(qwei_GUFO(x_GUFO_dbh)*(max(x_GUFO)-min(x_GUFO))/length(x_GUFO_dbh)))*length(x_GUFO) # quasi_Weibull distribution

lines(x_GUFO_dbh, y_GUFO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUFO_dbh, y_GUFO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUFO_dbh, y_GUFO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUFO_dbh, y_GUFO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUFO_dbh, y_GUFO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUFO_dbh, y_GUFO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUFO", bty="n",cex=1.5)

#### Hamelia axillaris
BCI_HAAX = subset(bci_2015_live,Latin=="Hamelia axillaris")
x_HAAX = BCI_HAAX$DBH/min(BCI_HAAX$DBH)
length(x_HAAX)
x_HAAX_dbh = seq(min(x_HAAX),max(x_HAAX),length=10*length(x_HAAX))
result_HAAX = subset(result_bci_sp_all,Latin=="Hamelia axillaris")

plot(sort(x_HAAX, decreasing=TRUE), 1:length(x_HAAX), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HAAX), max(x_HAAX)), ylim = c(1, length(x_HAAX)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_HAAX = function(x){
  b_pop = result_HAAX$b_pmete
  n_pop = result_HAAX$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HAAX = function(x){
  b_pop = 2
  n_pop = result_HAAX$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HAAX = function(x){
  al_pop = result_HAAX$p1_qwei
  be_pop = result_HAAX$p2_qwei
  ga_pop = result_HAAX$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HAAX_PMETE = (1-cumsum(fx_HAAX(x_HAAX_dbh)*(max(x_HAAX)-min(x_HAAX))/length(x_HAAX_dbh)))*length(x_HAAX) # parametrized mete prediction
y_HAAX_METE = (1-cumsum(gx_HAAX(x_HAAX_dbh)*(max(x_HAAX)-min(x_HAAX))/length(x_HAAX_dbh)))*length(x_HAAX) # mete prediction
y_HAAX_EXP = exp(-(result_HAAX$p_exp)*(x_HAAX_dbh-min(x_HAAX_dbh)))*length(x_HAAX)  # exponential distribution
y_HAAX_POW = ((x_HAAX_dbh)^(-(result_HAAX$p_pow)))*length(x_HAAX) # power function distribution
y_HAAX_WEI = (exp(1/((result_HAAX$p1_wei)^(result_HAAX$p2_wei))-(x_HAAX_dbh/(result_HAAX$p1_wei))^(result_HAAX$p2_wei)))*length(x_HAAX) # Weibull distribution
y_HAAX_QWEI = (1-cumsum(qwei_HAAX(x_HAAX_dbh)*(max(x_HAAX)-min(x_HAAX))/length(x_HAAX_dbh)))*length(x_HAAX) # quasi_Weibull distribution

lines(x_HAAX_dbh, y_HAAX_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HAAX_dbh, y_HAAX_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HAAX_dbh, y_HAAX_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HAAX_dbh, y_HAAX_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HAAX_dbh, y_HAAX_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HAAX_dbh, y_HAAX_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HAAX", bty="n",cex=1.5)

#### Lacmellea panamensis
BCI_LAPA = subset(bci_2015_live,Latin=="Lacmellea panamensis")
x_LAPA = BCI_LAPA$DBH/min(BCI_LAPA$DBH)
length(x_LAPA)
x_LAPA_dbh = seq(min(x_LAPA),max(x_LAPA),length=10*length(x_LAPA))
result_LAPA = subset(result_bci_sp_all,Latin=="Lacmellea panamensis")

plot(sort(x_LAPA, decreasing=TRUE), 1:length(x_LAPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LAPA), max(x_LAPA)), ylim = c(1, length(x_LAPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_LAPA = function(x){
  b_pop = result_LAPA$b_pmete
  n_pop = result_LAPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LAPA = function(x){
  b_pop = 2
  n_pop = result_LAPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LAPA = function(x){
  al_pop = result_LAPA$p1_qwei
  be_pop = result_LAPA$p2_qwei
  ga_pop = result_LAPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LAPA_PMETE = (1-cumsum(fx_LAPA(x_LAPA_dbh)*(max(x_LAPA)-min(x_LAPA))/length(x_LAPA_dbh)))*length(x_LAPA) # parametrized mete prediction
y_LAPA_METE = (1-cumsum(gx_LAPA(x_LAPA_dbh)*(max(x_LAPA)-min(x_LAPA))/length(x_LAPA_dbh)))*length(x_LAPA) # mete prediction
y_LAPA_EXP = exp(-(result_LAPA$p_exp)*(x_LAPA_dbh-min(x_LAPA_dbh)))*length(x_LAPA)  # exponential distribution
y_LAPA_POW = ((x_LAPA_dbh)^(-(result_LAPA$p_pow)))*length(x_LAPA) # power function distribution
y_LAPA_WEI = (exp(1/((result_LAPA$p1_wei)^(result_LAPA$p2_wei))-(x_LAPA_dbh/(result_LAPA$p1_wei))^(result_LAPA$p2_wei)))*length(x_LAPA) # Weibull distribution
y_LAPA_QWEI = (1-cumsum(qwei_LAPA(x_LAPA_dbh)*(max(x_LAPA)-min(x_LAPA))/length(x_LAPA_dbh)))*length(x_LAPA) # quasi_Weibull distribution

lines(x_LAPA_dbh, y_LAPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LAPA_dbh, y_LAPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LAPA_dbh, y_LAPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LAPA_dbh, y_LAPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LAPA_dbh, y_LAPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LAPA_dbh, y_LAPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LAPA", bty="n",cex=1.5)

#### Macrocnemum roseum
BCI_MARO = subset(bci_2015_live,Latin=="Macrocnemum roseum")
x_MARO = BCI_MARO$DBH/min(BCI_MARO$DBH)
length(x_MARO)
x_MARO_dbh = seq(min(x_MARO),max(x_MARO),length=10*length(x_MARO))
result_MARO = subset(result_bci_sp_all,Latin=="Macrocnemum roseum")

plot(sort(x_MARO, decreasing=TRUE), 1:length(x_MARO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MARO), max(x_MARO)), ylim = c(1, length(x_MARO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MARO = function(x){
  b_pop = result_MARO$b_pmete
  n_pop = result_MARO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MARO = function(x){
  b_pop = 2
  n_pop = result_MARO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MARO = function(x){
  al_pop = result_MARO$p1_qwei
  be_pop = result_MARO$p2_qwei
  ga_pop = result_MARO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MARO_PMETE = (1-cumsum(fx_MARO(x_MARO_dbh)*(max(x_MARO)-min(x_MARO))/length(x_MARO_dbh)))*length(x_MARO) # parametrized mete prediction
y_MARO_METE = (1-cumsum(gx_MARO(x_MARO_dbh)*(max(x_MARO)-min(x_MARO))/length(x_MARO_dbh)))*length(x_MARO) # mete prediction
y_MARO_EXP = exp(-(result_MARO$p_exp)*(x_MARO_dbh-min(x_MARO_dbh)))*length(x_MARO)  # exponential distribution
y_MARO_POW = ((x_MARO_dbh)^(-(result_MARO$p_pow)))*length(x_MARO) # power function distribution
y_MARO_WEI = (exp(1/((result_MARO$p1_wei)^(result_MARO$p2_wei))-(x_MARO_dbh/(result_MARO$p1_wei))^(result_MARO$p2_wei)))*length(x_MARO) # Weibull distribution
y_MARO_QWEI = (1-cumsum(qwei_MARO(x_MARO_dbh)*(max(x_MARO)-min(x_MARO))/length(x_MARO_dbh)))*length(x_MARO) # quasi_Weibull distribution

lines(x_MARO_dbh, y_MARO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MARO_dbh, y_MARO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MARO_dbh, y_MARO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MARO_dbh, y_MARO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MARO_dbh, y_MARO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MARO_dbh, y_MARO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MARO", bty="n",cex=1.5)

#### Palicourea guianensis
BCI_PAGU = subset(bci_2015_live,Latin=="Palicourea guianensis")
x_PAGU = BCI_PAGU$DBH/min(BCI_PAGU$DBH)
length(x_PAGU)
x_PAGU_dbh = seq(min(x_PAGU),max(x_PAGU),length=10*length(x_PAGU))
result_PAGU = subset(result_bci_sp_all,Latin=="Palicourea guianensis")

plot(sort(x_PAGU, decreasing=TRUE), 1:length(x_PAGU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PAGU), max(x_PAGU)), ylim = c(1, length(x_PAGU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PAGU = function(x){
  b_pop = result_PAGU$b_pmete
  n_pop = result_PAGU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PAGU = function(x){
  b_pop = 2
  n_pop = result_PAGU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PAGU = function(x){
  al_pop = result_PAGU$p1_qwei
  be_pop = result_PAGU$p2_qwei
  ga_pop = result_PAGU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PAGU_PMETE = (1-cumsum(fx_PAGU(x_PAGU_dbh)*(max(x_PAGU)-min(x_PAGU))/length(x_PAGU_dbh)))*length(x_PAGU) # parametrized mete prediction
y_PAGU_METE = (1-cumsum(gx_PAGU(x_PAGU_dbh)*(max(x_PAGU)-min(x_PAGU))/length(x_PAGU_dbh)))*length(x_PAGU) # mete prediction
y_PAGU_EXP = exp(-(result_PAGU$p_exp)*(x_PAGU_dbh-min(x_PAGU_dbh)))*length(x_PAGU)  # exponential distribution
y_PAGU_POW = ((x_PAGU_dbh)^(-(result_PAGU$p_pow)))*length(x_PAGU) # power function distribution
y_PAGU_WEI = (exp(1/((result_PAGU$p1_wei)^(result_PAGU$p2_wei))-(x_PAGU_dbh/(result_PAGU$p1_wei))^(result_PAGU$p2_wei)))*length(x_PAGU) # Weibull distribution
y_PAGU_QWEI = (1-cumsum(qwei_PAGU(x_PAGU_dbh)*(max(x_PAGU)-min(x_PAGU))/length(x_PAGU_dbh)))*length(x_PAGU) # quasi_Weibull distribution

lines(x_PAGU_dbh, y_PAGU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PAGU_dbh, y_PAGU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PAGU_dbh, y_PAGU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PAGU_dbh, y_PAGU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PAGU_dbh, y_PAGU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PAGU_dbh, y_PAGU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PAGU", bty="n",cex=1.5)

#### Pentagonia macrophylla
BCI_PEMA = subset(bci_2015_live,Latin=="Pentagonia macrophylla")
x_PEMA = BCI_PEMA$DBH/min(BCI_PEMA$DBH)
length(x_PEMA)
x_PEMA_dbh = seq(min(x_PEMA),max(x_PEMA),length=10*length(x_PEMA))
result_PEMA = subset(result_bci_sp_all,Latin=="Pentagonia macrophylla")

plot(sort(x_PEMA, decreasing=TRUE), 1:length(x_PEMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PEMA), max(x_PEMA)), ylim = c(1, length(x_PEMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PEMA = function(x){
  b_pop = result_PEMA$b_pmete
  n_pop = result_PEMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PEMA = function(x){
  b_pop = 2
  n_pop = result_PEMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PEMA = function(x){
  al_pop = result_PEMA$p1_qwei
  be_pop = result_PEMA$p2_qwei
  ga_pop = result_PEMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PEMA_PMETE = (1-cumsum(fx_PEMA(x_PEMA_dbh)*(max(x_PEMA)-min(x_PEMA))/length(x_PEMA_dbh)))*length(x_PEMA) # parametrized mete prediction
y_PEMA_METE = (1-cumsum(gx_PEMA(x_PEMA_dbh)*(max(x_PEMA)-min(x_PEMA))/length(x_PEMA_dbh)))*length(x_PEMA) # mete prediction
y_PEMA_EXP = exp(-(result_PEMA$p_exp)*(x_PEMA_dbh-min(x_PEMA_dbh)))*length(x_PEMA)  # exponential distribution
y_PEMA_POW = ((x_PEMA_dbh)^(-(result_PEMA$p_pow)))*length(x_PEMA) # power function distribution
y_PEMA_WEI = (exp(1/((result_PEMA$p1_wei)^(result_PEMA$p2_wei))-(x_PEMA_dbh/(result_PEMA$p1_wei))^(result_PEMA$p2_wei)))*length(x_PEMA) # Weibull distribution
y_PEMA_QWEI = (1-cumsum(qwei_PEMA(x_PEMA_dbh)*(max(x_PEMA)-min(x_PEMA))/length(x_PEMA_dbh)))*length(x_PEMA) # quasi_Weibull distribution

lines(x_PEMA_dbh, y_PEMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PEMA_dbh, y_PEMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PEMA_dbh, y_PEMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PEMA_dbh, y_PEMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PEMA_dbh, y_PEMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PEMA_dbh, y_PEMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PEMA", bty="n",cex=1.5)

#### Psychotria horizontalis
BCI_PSHO = subset(bci_2015_live,Latin=="Psychotria horizontalis")
x_PSHO = BCI_PSHO$DBH/min(BCI_PSHO$DBH)
length(x_PSHO)
x_PSHO_dbh = seq(min(x_PSHO),max(x_PSHO),length=10*length(x_PSHO))
result_PSHO = subset(result_bci_sp_all,Latin=="Psychotria horizontalis")

plot(sort(x_PSHO, decreasing=TRUE), 1:length(x_PSHO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PSHO), max(x_PSHO)), ylim = c(1, length(x_PSHO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PSHO = function(x){
  b_pop = result_PSHO$b_pmete
  n_pop = result_PSHO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PSHO = function(x){
  b_pop = 2
  n_pop = result_PSHO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PSHO = function(x){
  al_pop = result_PSHO$p1_qwei
  be_pop = result_PSHO$p2_qwei
  ga_pop = result_PSHO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PSHO_PMETE = (1-cumsum(fx_PSHO(x_PSHO_dbh)*(max(x_PSHO)-min(x_PSHO))/length(x_PSHO_dbh)))*length(x_PSHO) # parametrized mete prediction
y_PSHO_METE = (1-cumsum(gx_PSHO(x_PSHO_dbh)*(max(x_PSHO)-min(x_PSHO))/length(x_PSHO_dbh)))*length(x_PSHO) # mete prediction
y_PSHO_EXP = exp(-(result_PSHO$p_exp)*(x_PSHO_dbh-min(x_PSHO_dbh)))*length(x_PSHO)  # exponential distribution
y_PSHO_POW = ((x_PSHO_dbh)^(-(result_PSHO$p_pow)))*length(x_PSHO) # power function distribution
y_PSHO_WEI = (exp(1/((result_PSHO$p1_wei)^(result_PSHO$p2_wei))-(x_PSHO_dbh/(result_PSHO$p1_wei))^(result_PSHO$p2_wei)))*length(x_PSHO) # Weibull distribution
y_PSHO_QWEI = (1-cumsum(qwei_PSHO(x_PSHO_dbh)*(max(x_PSHO)-min(x_PSHO))/length(x_PSHO_dbh)))*length(x_PSHO) # quasi_Weibull distribution

lines(x_PSHO_dbh, y_PSHO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PSHO_dbh, y_PSHO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PSHO_dbh, y_PSHO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PSHO_dbh, y_PSHO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PSHO_dbh, y_PSHO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PSHO_dbh, y_PSHO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PSHO", bty="n",cex=1.5)

#### Psychotria limonensis
BCI_PSLI = subset(bci_2015_live,Latin=="Psychotria limonensis")
x_PSLI = BCI_PSLI$DBH/min(BCI_PSLI$DBH)
length(x_PSLI)
x_PSLI_dbh = seq(min(x_PSLI),max(x_PSLI),length=10*length(x_PSLI))
result_PSLI = subset(result_bci_sp_all,Latin=="Psychotria limonensis")

plot(sort(x_PSLI, decreasing=TRUE), 1:length(x_PSLI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PSLI), max(x_PSLI)), ylim = c(1, length(x_PSLI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PSLI = function(x){
  b_pop = result_PSLI$b_pmete
  n_pop = result_PSLI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PSLI = function(x){
  b_pop = 2
  n_pop = result_PSLI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PSLI = function(x){
  al_pop = result_PSLI$p1_qwei
  be_pop = result_PSLI$p2_qwei
  ga_pop = result_PSLI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PSLI_PMETE = (1-cumsum(fx_PSLI(x_PSLI_dbh)*(max(x_PSLI)-min(x_PSLI))/length(x_PSLI_dbh)))*length(x_PSLI) # parametrized mete prediction
y_PSLI_METE = (1-cumsum(gx_PSLI(x_PSLI_dbh)*(max(x_PSLI)-min(x_PSLI))/length(x_PSLI_dbh)))*length(x_PSLI) # mete prediction
y_PSLI_EXP = exp(-(result_PSLI$p_exp)*(x_PSLI_dbh-min(x_PSLI_dbh)))*length(x_PSLI)  # exponential distribution
y_PSLI_POW = ((x_PSLI_dbh)^(-(result_PSLI$p_pow)))*length(x_PSLI) # power function distribution
y_PSLI_WEI = (exp(1/((result_PSLI$p1_wei)^(result_PSLI$p2_wei))-(x_PSLI_dbh/(result_PSLI$p1_wei))^(result_PSLI$p2_wei)))*length(x_PSLI) # Weibull distribution
y_PSLI_QWEI = (1-cumsum(qwei_PSLI(x_PSLI_dbh)*(max(x_PSLI)-min(x_PSLI))/length(x_PSLI_dbh)))*length(x_PSLI) # quasi_Weibull distribution

lines(x_PSLI_dbh, y_PSLI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PSLI_dbh, y_PSLI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PSLI_dbh, y_PSLI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PSLI_dbh, y_PSLI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PSLI_dbh, y_PSLI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PSLI_dbh, y_PSLI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PSLI", bty="n",cex=1.5)

#### Psychotria marginata
BCI_PSMA = subset(bci_2015_live,Latin=="Psychotria marginata")
x_PSMA = BCI_PSMA$DBH/min(BCI_PSMA$DBH)
length(x_PSMA)
x_PSMA_dbh = seq(min(x_PSMA),max(x_PSMA),length=10*length(x_PSMA))
result_PSMA = subset(result_bci_sp_all,Latin=="Psychotria marginata")

plot(sort(x_PSMA, decreasing=TRUE), 1:length(x_PSMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PSMA), max(x_PSMA)), ylim = c(1, length(x_PSMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PSMA = function(x){
  b_pop = result_PSMA$b_pmete
  n_pop = result_PSMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PSMA = function(x){
  b_pop = 2
  n_pop = result_PSMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PSMA = function(x){
  al_pop = result_PSMA$p1_qwei
  be_pop = result_PSMA$p2_qwei
  ga_pop = result_PSMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PSMA_PMETE = (1-cumsum(fx_PSMA(x_PSMA_dbh)*(max(x_PSMA)-min(x_PSMA))/length(x_PSMA_dbh)))*length(x_PSMA) # parametrized mete prediction
y_PSMA_METE = (1-cumsum(gx_PSMA(x_PSMA_dbh)*(max(x_PSMA)-min(x_PSMA))/length(x_PSMA_dbh)))*length(x_PSMA) # mete prediction
y_PSMA_EXP = exp(-(result_PSMA$p_exp)*(x_PSMA_dbh-min(x_PSMA_dbh)))*length(x_PSMA)  # exponential distribution
y_PSMA_POW = ((x_PSMA_dbh)^(-(result_PSMA$p_pow)))*length(x_PSMA) # power function distribution
y_PSMA_WEI = (exp(1/((result_PSMA$p1_wei)^(result_PSMA$p2_wei))-(x_PSMA_dbh/(result_PSMA$p1_wei))^(result_PSMA$p2_wei)))*length(x_PSMA) # Weibull distribution
y_PSMA_QWEI = (1-cumsum(qwei_PSMA(x_PSMA_dbh)*(max(x_PSMA)-min(x_PSMA))/length(x_PSMA_dbh)))*length(x_PSMA) # quasi_Weibull distribution

lines(x_PSMA_dbh, y_PSMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PSMA_dbh, y_PSMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PSMA_dbh, y_PSMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PSMA_dbh, y_PSMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PSMA_dbh, y_PSMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PSMA_dbh, y_PSMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PSMA", bty="n",cex=1.5)

#### Randia armata
BCI_RAAR = subset(bci_2015_live,Latin=="Randia armata")
x_RAAR = BCI_RAAR$DBH/min(BCI_RAAR$DBH)
length(x_RAAR)
x_RAAR_dbh = seq(min(x_RAAR),max(x_RAAR),length=10*length(x_RAAR))
result_RAAR = subset(result_bci_sp_all,Latin=="Randia armata")

plot(sort(x_RAAR, decreasing=TRUE), 1:length(x_RAAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_RAAR), max(x_RAAR)), ylim = c(1, length(x_RAAR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_RAAR = function(x){
  b_pop = result_RAAR$b_pmete
  n_pop = result_RAAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_RAAR = function(x){
  b_pop = 2
  n_pop = result_RAAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_RAAR = function(x){
  al_pop = result_RAAR$p1_qwei
  be_pop = result_RAAR$p2_qwei
  ga_pop = result_RAAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_RAAR_PMETE = (1-cumsum(fx_RAAR(x_RAAR_dbh)*(max(x_RAAR)-min(x_RAAR))/length(x_RAAR_dbh)))*length(x_RAAR) # parametrized mete prediction
y_RAAR_METE = (1-cumsum(gx_RAAR(x_RAAR_dbh)*(max(x_RAAR)-min(x_RAAR))/length(x_RAAR_dbh)))*length(x_RAAR) # mete prediction
y_RAAR_EXP = exp(-(result_RAAR$p_exp)*(x_RAAR_dbh-min(x_RAAR_dbh)))*length(x_RAAR)  # exponential distribution
y_RAAR_POW = ((x_RAAR_dbh)^(-(result_RAAR$p_pow)))*length(x_RAAR) # power function distribution
y_RAAR_WEI = (exp(1/((result_RAAR$p1_wei)^(result_RAAR$p2_wei))-(x_RAAR_dbh/(result_RAAR$p1_wei))^(result_RAAR$p2_wei)))*length(x_RAAR) # Weibull distribution
y_RAAR_QWEI = (1-cumsum(qwei_RAAR(x_RAAR_dbh)*(max(x_RAAR)-min(x_RAAR))/length(x_RAAR_dbh)))*length(x_RAAR) # quasi_Weibull distribution

lines(x_RAAR_dbh, y_RAAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_RAAR_dbh, y_RAAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_RAAR_dbh, y_RAAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_RAAR_dbh, y_RAAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_RAAR_dbh, y_RAAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_RAAR_dbh, y_RAAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RAAR", bty="n",cex=1.5)

#### Tabernaemontana arborea
BCI_TAAR = subset(bci_2015_live,Latin=="Tabernaemontana arborea")
x_TAAR = BCI_TAAR$DBH/min(BCI_TAAR$DBH)
length(x_TAAR)
x_TAAR_dbh = seq(min(x_TAAR),max(x_TAAR),length=10*length(x_TAAR))
result_TAAR = subset(result_bci_sp_all,Latin=="Tabernaemontana arborea")

plot(sort(x_TAAR, decreasing=TRUE), 1:length(x_TAAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TAAR), max(x_TAAR)), ylim = c(1, length(x_TAAR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TAAR = function(x){
  b_pop = result_TAAR$b_pmete
  n_pop = result_TAAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TAAR = function(x){
  b_pop = 2
  n_pop = result_TAAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TAAR = function(x){
  al_pop = result_TAAR$p1_qwei
  be_pop = result_TAAR$p2_qwei
  ga_pop = result_TAAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TAAR_PMETE = (1-cumsum(fx_TAAR(x_TAAR_dbh)*(max(x_TAAR)-min(x_TAAR))/length(x_TAAR_dbh)))*length(x_TAAR) # parametrized mete prediction
y_TAAR_METE = (1-cumsum(gx_TAAR(x_TAAR_dbh)*(max(x_TAAR)-min(x_TAAR))/length(x_TAAR_dbh)))*length(x_TAAR) # mete prediction
y_TAAR_EXP = exp(-(result_TAAR$p_exp)*(x_TAAR_dbh-min(x_TAAR_dbh)))*length(x_TAAR)  # exponential distribution
y_TAAR_POW = ((x_TAAR_dbh)^(-(result_TAAR$p_pow)))*length(x_TAAR) # power function distribution
y_TAAR_WEI = (exp(1/((result_TAAR$p1_wei)^(result_TAAR$p2_wei))-(x_TAAR_dbh/(result_TAAR$p1_wei))^(result_TAAR$p2_wei)))*length(x_TAAR) # Weibull distribution
y_TAAR_QWEI = (1-cumsum(qwei_TAAR(x_TAAR_dbh)*(max(x_TAAR)-min(x_TAAR))/length(x_TAAR_dbh)))*length(x_TAAR) # quasi_Weibull distribution

lines(x_TAAR_dbh, y_TAAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TAAR_dbh, y_TAAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TAAR_dbh, y_TAAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TAAR_dbh, y_TAAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TAAR_dbh, y_TAAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TAAR_dbh, y_TAAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TAAR", bty="n",cex=1.5)
```
### BCI (Order=Lamiales)
```{r}
par(mfrow=c(1,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Jacaranda copaia
BCI_JACO = subset(bci_2015_live,Latin=="Jacaranda copaia")
x_JACO = BCI_JACO$DBH/min(BCI_JACO$DBH)
length(x_JACO)
x_JACO_dbh = seq(min(x_JACO),max(x_JACO),length=10*length(x_JACO))
result_JACO = subset(result_bci_sp_all,Latin=="Jacaranda copaia")

plot(sort(x_JACO, decreasing=TRUE), 1:length(x_JACO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_JACO), max(x_JACO)), ylim = c(1, length(x_JACO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_JACO = function(x){
  b_pop = result_JACO$b_pmete
  n_pop = result_JACO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_JACO = function(x){
  b_pop = 2
  n_pop = result_JACO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_JACO = function(x){
  al_pop = result_JACO$p1_qwei
  be_pop = result_JACO$p2_qwei
  ga_pop = result_JACO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_JACO_PMETE = (1-cumsum(fx_JACO(x_JACO_dbh)*(max(x_JACO)-min(x_JACO))/length(x_JACO_dbh)))*length(x_JACO) # parametrized mete prediction
y_JACO_METE = (1-cumsum(gx_JACO(x_JACO_dbh)*(max(x_JACO)-min(x_JACO))/length(x_JACO_dbh)))*length(x_JACO) # mete prediction
y_JACO_EXP = exp(-(result_JACO$p_exp)*(x_JACO_dbh-min(x_JACO_dbh)))*length(x_JACO)  # exponential distribution
y_JACO_POW = ((x_JACO_dbh)^(-(result_JACO$p_pow)))*length(x_JACO) # power function distribution
y_JACO_WEI = (exp(1/((result_JACO$p1_wei)^(result_JACO$p2_wei))-(x_JACO_dbh/(result_JACO$p1_wei))^(result_JACO$p2_wei)))*length(x_JACO) # Weibull distribution
y_JACO_QWEI = (1-cumsum(qwei_JACO(x_JACO_dbh)*(max(x_JACO)-min(x_JACO))/length(x_JACO_dbh)))*length(x_JACO) # quasi_Weibull distribution

lines(x_JACO_dbh, y_JACO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_JACO_dbh, y_JACO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_JACO_dbh, y_JACO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_JACO_dbh, y_JACO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_JACO_dbh, y_JACO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_JACO_dbh, y_JACO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "JACO", bty="n",cex=1.5)

#### Tabebuia rosea
BCI_TARO = subset(bci_2015_live,Latin=="Tabebuia rosea")
x_TARO = BCI_TARO$DBH/min(BCI_TARO$DBH)
length(x_TARO)
x_TARO_dbh = seq(min(x_TARO),max(x_TARO),length=10*length(x_TARO))
result_TARO = subset(result_bci_sp_all,Latin=="Tabebuia rosea")

plot(sort(x_TARO, decreasing=TRUE), 1:length(x_TARO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TARO), max(x_TARO)), ylim = c(1, length(x_TARO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TARO = function(x){
  b_pop = result_TARO$b_pmete
  n_pop = result_TARO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TARO = function(x){
  b_pop = 2
  n_pop = result_TARO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TARO = function(x){
  al_pop = result_TARO$p1_qwei
  be_pop = result_TARO$p2_qwei
  ga_pop = result_TARO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TARO_PMETE = (1-cumsum(fx_TARO(x_TARO_dbh)*(max(x_TARO)-min(x_TARO))/length(x_TARO_dbh)))*length(x_TARO) # parametrized mete prediction
y_TARO_METE = (1-cumsum(gx_TARO(x_TARO_dbh)*(max(x_TARO)-min(x_TARO))/length(x_TARO_dbh)))*length(x_TARO) # mete prediction
y_TARO_EXP = exp(-(result_TARO$p_exp)*(x_TARO_dbh-min(x_TARO_dbh)))*length(x_TARO)  # exponential distribution
y_TARO_POW = ((x_TARO_dbh)^(-(result_TARO$p_pow)))*length(x_TARO) # power function distribution
y_TARO_WEI = (exp(1/((result_TARO$p1_wei)^(result_TARO$p2_wei))-(x_TARO_dbh/(result_TARO$p1_wei))^(result_TARO$p2_wei)))*length(x_TARO) # Weibull distribution
y_TARO_QWEI = (1-cumsum(qwei_TARO(x_TARO_dbh)*(max(x_TARO)-min(x_TARO))/length(x_TARO_dbh)))*length(x_TARO) # quasi_Weibull distribution

lines(x_TARO_dbh, y_TARO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TARO_dbh, y_TARO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TARO_dbh, y_TARO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TARO_dbh, y_TARO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TARO_dbh, y_TARO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TARO_dbh, y_TARO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TARO", bty="n",cex=1.5)
```
### BCI (Order=Laurales)
```{r}
par(mfrow=c(3,3),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Beilschmiedia pendula
BCI_BEPE = subset(bci_2015_live,Latin=="Beilschmiedia pendula")
x_BEPE = BCI_BEPE$DBH/min(BCI_BEPE$DBH)
length(x_BEPE)
x_BEPE_dbh = seq(min(x_BEPE),max(x_BEPE),length=10*length(x_BEPE))
result_BEPE = subset(result_bci_sp_all,Latin=="Beilschmiedia pendula")

plot(sort(x_BEPE, decreasing=TRUE), 1:length(x_BEPE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_BEPE), max(x_BEPE)), ylim = c(1, length(x_BEPE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_BEPE = function(x){
  b_pop = result_BEPE$b_pmete
  n_pop = result_BEPE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_BEPE = function(x){
  b_pop = 2
  n_pop = result_BEPE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_BEPE = function(x){
  al_pop = result_BEPE$p1_qwei
  be_pop = result_BEPE$p2_qwei
  ga_pop = result_BEPE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_BEPE_PMETE = (1-cumsum(fx_BEPE(x_BEPE_dbh)*(max(x_BEPE)-min(x_BEPE))/length(x_BEPE_dbh)))*length(x_BEPE) # parametrized mete prediction
y_BEPE_METE = (1-cumsum(gx_BEPE(x_BEPE_dbh)*(max(x_BEPE)-min(x_BEPE))/length(x_BEPE_dbh)))*length(x_BEPE) # mete prediction
y_BEPE_EXP = exp(-(result_BEPE$p_exp)*(x_BEPE_dbh-min(x_BEPE_dbh)))*length(x_BEPE)  # exponential distribution
y_BEPE_POW = ((x_BEPE_dbh)^(-(result_BEPE$p_pow)))*length(x_BEPE) # power function distribution
y_BEPE_WEI = (exp(1/((result_BEPE$p1_wei)^(result_BEPE$p2_wei))-(x_BEPE_dbh/(result_BEPE$p1_wei))^(result_BEPE$p2_wei)))*length(x_BEPE) # Weibull distribution
y_BEPE_QWEI = (1-cumsum(qwei_BEPE(x_BEPE_dbh)*(max(x_BEPE)-min(x_BEPE))/length(x_BEPE_dbh)))*length(x_BEPE) # quasi_Weibull distribution

lines(x_BEPE_dbh, y_BEPE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_BEPE_dbh, y_BEPE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_BEPE_dbh, y_BEPE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_BEPE_dbh, y_BEPE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_BEPE_dbh, y_BEPE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_BEPE_dbh, y_BEPE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BEPE", bty="n",cex=1.5)

#### Nectandra cissiflora
BCI_NECI = subset(bci_2015_live,Latin=="Nectandra cissiflora")
x_NECI = BCI_NECI$DBH/min(BCI_NECI$DBH)
length(x_NECI)
x_NECI_dbh = seq(min(x_NECI),max(x_NECI),length=10*length(x_NECI))
result_NECI = subset(result_bci_sp_all,Latin=="Nectandra cissiflora")

plot(sort(x_NECI, decreasing=TRUE), 1:length(x_NECI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_NECI), max(x_NECI)), ylim = c(1, length(x_NECI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_NECI = function(x){
  b_pop = result_NECI$b_pmete
  n_pop = result_NECI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_NECI = function(x){
  b_pop = 2
  n_pop = result_NECI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_NECI = function(x){
  al_pop = result_NECI$p1_qwei
  be_pop = result_NECI$p2_qwei
  ga_pop = result_NECI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_NECI_PMETE = (1-cumsum(fx_NECI(x_NECI_dbh)*(max(x_NECI)-min(x_NECI))/length(x_NECI_dbh)))*length(x_NECI) # parametrized mete prediction
y_NECI_METE = (1-cumsum(gx_NECI(x_NECI_dbh)*(max(x_NECI)-min(x_NECI))/length(x_NECI_dbh)))*length(x_NECI) # mete prediction
y_NECI_EXP = exp(-(result_NECI$p_exp)*(x_NECI_dbh-min(x_NECI_dbh)))*length(x_NECI)  # exponential distribution
y_NECI_POW = ((x_NECI_dbh)^(-(result_NECI$p_pow)))*length(x_NECI) # power function distribution
y_NECI_WEI = (exp(1/((result_NECI$p1_wei)^(result_NECI$p2_wei))-(x_NECI_dbh/(result_NECI$p1_wei))^(result_NECI$p2_wei)))*length(x_NECI) # Weibull distribution
y_NECI_QWEI = (1-cumsum(qwei_NECI(x_NECI_dbh)*(max(x_NECI)-min(x_NECI))/length(x_NECI_dbh)))*length(x_NECI) # quasi_Weibull distribution

lines(x_NECI_dbh, y_NECI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_NECI_dbh, y_NECI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_NECI_dbh, y_NECI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_NECI_dbh, y_NECI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_NECI_dbh, y_NECI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_NECI_dbh, y_NECI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "NECI", bty="n",cex=1.5)

#### Nectandra lineata
BCI_NELI = subset(bci_2015_live,Latin=="Nectandra lineata")
x_NELI = BCI_NELI$DBH/min(BCI_NELI$DBH)
length(x_NELI)
x_NELI_dbh = seq(min(x_NELI),max(x_NELI),length=10*length(x_NELI))
result_NELI = subset(result_bci_sp_all,Latin=="Nectandra lineata")

plot(sort(x_NELI, decreasing=TRUE), 1:length(x_NELI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_NELI), max(x_NELI)), ylim = c(1, length(x_NELI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_NELI = function(x){
  b_pop = result_NELI$b_pmete
  n_pop = result_NELI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_NELI = function(x){
  b_pop = 2
  n_pop = result_NELI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_NELI = function(x){
  al_pop = result_NELI$p1_qwei
  be_pop = result_NELI$p2_qwei
  ga_pop = result_NELI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_NELI_PMETE = (1-cumsum(fx_NELI(x_NELI_dbh)*(max(x_NELI)-min(x_NELI))/length(x_NELI_dbh)))*length(x_NELI) # parametrized mete prediction
y_NELI_METE = (1-cumsum(gx_NELI(x_NELI_dbh)*(max(x_NELI)-min(x_NELI))/length(x_NELI_dbh)))*length(x_NELI) # mete prediction
y_NELI_EXP = exp(-(result_NELI$p_exp)*(x_NELI_dbh-min(x_NELI_dbh)))*length(x_NELI)  # exponential distribution
y_NELI_POW = ((x_NELI_dbh)^(-(result_NELI$p_pow)))*length(x_NELI) # power function distribution
y_NELI_WEI = (exp(1/((result_NELI$p1_wei)^(result_NELI$p2_wei))-(x_NELI_dbh/(result_NELI$p1_wei))^(result_NELI$p2_wei)))*length(x_NELI) # Weibull distribution
y_NELI_QWEI = (1-cumsum(qwei_NELI(x_NELI_dbh)*(max(x_NELI)-min(x_NELI))/length(x_NELI_dbh)))*length(x_NELI) # quasi_Weibull distribution

lines(x_NELI_dbh, y_NELI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_NELI_dbh, y_NELI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_NELI_dbh, y_NELI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_NELI_dbh, y_NELI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_NELI_dbh, y_NELI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_NELI_dbh, y_NELI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "NELI", bty="n",cex=1.5)

#### Nectandra purpurea
BCI_NEPU = subset(bci_2015_live,Latin=="Nectandra purpurea")
x_NEPU = BCI_NEPU$DBH/min(BCI_NEPU$DBH)
length(x_NEPU)
x_NEPU_dbh = seq(min(x_NEPU),max(x_NEPU),length=10*length(x_NEPU))
result_NEPU = subset(result_bci_sp_all,Latin=="Nectandra purpurea")

plot(sort(x_NEPU, decreasing=TRUE), 1:length(x_NEPU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_NEPU), max(x_NEPU)), ylim = c(1, length(x_NEPU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_NEPU = function(x){
  b_pop = result_NEPU$b_pmete
  n_pop = result_NEPU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_NEPU = function(x){
  b_pop = 2
  n_pop = result_NEPU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_NEPU = function(x){
  al_pop = result_NEPU$p1_qwei
  be_pop = result_NEPU$p2_qwei
  ga_pop = result_NEPU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_NEPU_PMETE = (1-cumsum(fx_NEPU(x_NEPU_dbh)*(max(x_NEPU)-min(x_NEPU))/length(x_NEPU_dbh)))*length(x_NEPU) # parametrized mete prediction
y_NEPU_METE = (1-cumsum(gx_NEPU(x_NEPU_dbh)*(max(x_NEPU)-min(x_NEPU))/length(x_NEPU_dbh)))*length(x_NEPU) # mete prediction
y_NEPU_EXP = exp(-(result_NEPU$p_exp)*(x_NEPU_dbh-min(x_NEPU_dbh)))*length(x_NEPU)  # exponential distribution
y_NEPU_POW = ((x_NEPU_dbh)^(-(result_NEPU$p_pow)))*length(x_NEPU) # power function distribution
y_NEPU_WEI = (exp(1/((result_NEPU$p1_wei)^(result_NEPU$p2_wei))-(x_NEPU_dbh/(result_NEPU$p1_wei))^(result_NEPU$p2_wei)))*length(x_NEPU) # Weibull distribution
y_NEPU_QWEI = (1-cumsum(qwei_NEPU(x_NEPU_dbh)*(max(x_NEPU)-min(x_NEPU))/length(x_NEPU_dbh)))*length(x_NEPU) # quasi_Weibull distribution

lines(x_NEPU_dbh, y_NEPU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_NEPU_dbh, y_NEPU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_NEPU_dbh, y_NEPU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_NEPU_dbh, y_NEPU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_NEPU_dbh, y_NEPU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_NEPU_dbh, y_NEPU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "NEPU", bty="n",cex=1.5)

#### Ocotea cernua
BCI_OCCE = subset(bci_2015_live,Latin=="Ocotea cernua")
x_OCCE = BCI_OCCE$DBH/min(BCI_OCCE$DBH)
length(x_OCCE)
x_OCCE_dbh = seq(min(x_OCCE),max(x_OCCE),length=10*length(x_OCCE))
result_OCCE = subset(result_bci_sp_all,Latin=="Ocotea cernua")

plot(sort(x_OCCE, decreasing=TRUE), 1:length(x_OCCE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_OCCE), max(x_OCCE)), ylim = c(1, length(x_OCCE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_OCCE = function(x){
  b_pop = result_OCCE$b_pmete
  n_pop = result_OCCE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_OCCE = function(x){
  b_pop = 2
  n_pop = result_OCCE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_OCCE = function(x){
  al_pop = result_OCCE$p1_qwei
  be_pop = result_OCCE$p2_qwei
  ga_pop = result_OCCE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_OCCE_PMETE = (1-cumsum(fx_OCCE(x_OCCE_dbh)*(max(x_OCCE)-min(x_OCCE))/length(x_OCCE_dbh)))*length(x_OCCE) # parametrized mete prediction
y_OCCE_METE = (1-cumsum(gx_OCCE(x_OCCE_dbh)*(max(x_OCCE)-min(x_OCCE))/length(x_OCCE_dbh)))*length(x_OCCE) # mete prediction
y_OCCE_EXP = exp(-(result_OCCE$p_exp)*(x_OCCE_dbh-min(x_OCCE_dbh)))*length(x_OCCE)  # exponential distribution
y_OCCE_POW = ((x_OCCE_dbh)^(-(result_OCCE$p_pow)))*length(x_OCCE) # power function distribution
y_OCCE_WEI = (exp(1/((result_OCCE$p1_wei)^(result_OCCE$p2_wei))-(x_OCCE_dbh/(result_OCCE$p1_wei))^(result_OCCE$p2_wei)))*length(x_OCCE) # Weibull distribution
y_OCCE_QWEI = (1-cumsum(qwei_OCCE(x_OCCE_dbh)*(max(x_OCCE)-min(x_OCCE))/length(x_OCCE_dbh)))*length(x_OCCE) # quasi_Weibull distribution

lines(x_OCCE_dbh, y_OCCE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_OCCE_dbh, y_OCCE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_OCCE_dbh, y_OCCE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_OCCE_dbh, y_OCCE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_OCCE_dbh, y_OCCE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_OCCE_dbh, y_OCCE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "OCCE", bty="n",cex=1.5)

#### Ocotea oblonga
BCI_OCOB = subset(bci_2015_live,Latin=="Ocotea oblonga")
x_OCOB = BCI_OCOB$DBH/min(BCI_OCOB$DBH)
length(x_OCOB)
x_OCOB_dbh = seq(min(x_OCOB),max(x_OCOB),length=10*length(x_OCOB))
result_OCOB = subset(result_bci_sp_all,Latin=="Ocotea oblonga")

plot(sort(x_OCOB, decreasing=TRUE), 1:length(x_OCOB), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_OCOB), max(x_OCOB)), ylim = c(1, length(x_OCOB)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_OCOB = function(x){
  b_pop = result_OCOB$b_pmete
  n_pop = result_OCOB$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_OCOB = function(x){
  b_pop = 2
  n_pop = result_OCOB$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_OCOB = function(x){
  al_pop = result_OCOB$p1_qwei
  be_pop = result_OCOB$p2_qwei
  ga_pop = result_OCOB$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_OCOB_PMETE = (1-cumsum(fx_OCOB(x_OCOB_dbh)*(max(x_OCOB)-min(x_OCOB))/length(x_OCOB_dbh)))*length(x_OCOB) # parametrized mete prediction
y_OCOB_METE = (1-cumsum(gx_OCOB(x_OCOB_dbh)*(max(x_OCOB)-min(x_OCOB))/length(x_OCOB_dbh)))*length(x_OCOB) # mete prediction
y_OCOB_EXP = exp(-(result_OCOB$p_exp)*(x_OCOB_dbh-min(x_OCOB_dbh)))*length(x_OCOB)  # exponential distribution
y_OCOB_POW = ((x_OCOB_dbh)^(-(result_OCOB$p_pow)))*length(x_OCOB) # power function distribution
y_OCOB_WEI = (exp(1/((result_OCOB$p1_wei)^(result_OCOB$p2_wei))-(x_OCOB_dbh/(result_OCOB$p1_wei))^(result_OCOB$p2_wei)))*length(x_OCOB) # Weibull distribution
y_OCOB_QWEI = (1-cumsum(qwei_OCOB(x_OCOB_dbh)*(max(x_OCOB)-min(x_OCOB))/length(x_OCOB_dbh)))*length(x_OCOB) # quasi_Weibull distribution

lines(x_OCOB_dbh, y_OCOB_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_OCOB_dbh, y_OCOB_METE, col="#999999",lwd=2) #, lty=5)
lines(x_OCOB_dbh, y_OCOB_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_OCOB_dbh, y_OCOB_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_OCOB_dbh, y_OCOB_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_OCOB_dbh, y_OCOB_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "OCOB", bty="n",cex=1.5)

#### Ocotea puberula
BCI_OCPU = subset(bci_2015_live,Latin=="Ocotea puberula")
x_OCPU = BCI_OCPU$DBH/min(BCI_OCPU$DBH)
length(x_OCPU)
x_OCPU_dbh = seq(min(x_OCPU),max(x_OCPU),length=10*length(x_OCPU))
result_OCPU = subset(result_bci_sp_all,Latin=="Ocotea puberula")

plot(sort(x_OCPU, decreasing=TRUE), 1:length(x_OCPU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_OCPU), max(x_OCPU)), ylim = c(1, length(x_OCPU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_OCPU = function(x){
  b_pop = result_OCPU$b_pmete
  n_pop = result_OCPU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_OCPU = function(x){
  b_pop = 2
  n_pop = result_OCPU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_OCPU = function(x){
  al_pop = result_OCPU$p1_qwei
  be_pop = result_OCPU$p2_qwei
  ga_pop = result_OCPU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_OCPU_PMETE = (1-cumsum(fx_OCPU(x_OCPU_dbh)*(max(x_OCPU)-min(x_OCPU))/length(x_OCPU_dbh)))*length(x_OCPU) # parametrized mete prediction
y_OCPU_METE = (1-cumsum(gx_OCPU(x_OCPU_dbh)*(max(x_OCPU)-min(x_OCPU))/length(x_OCPU_dbh)))*length(x_OCPU) # mete prediction
y_OCPU_EXP = exp(-(result_OCPU$p_exp)*(x_OCPU_dbh-min(x_OCPU_dbh)))*length(x_OCPU)  # exponential distribution
y_OCPU_POW = ((x_OCPU_dbh)^(-(result_OCPU$p_pow)))*length(x_OCPU) # power function distribution
y_OCPU_WEI = (exp(1/((result_OCPU$p1_wei)^(result_OCPU$p2_wei))-(x_OCPU_dbh/(result_OCPU$p1_wei))^(result_OCPU$p2_wei)))*length(x_OCPU) # Weibull distribution
y_OCPU_QWEI = (1-cumsum(qwei_OCPU(x_OCPU_dbh)*(max(x_OCPU)-min(x_OCPU))/length(x_OCPU_dbh)))*length(x_OCPU) # quasi_Weibull distribution

lines(x_OCPU_dbh, y_OCPU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_OCPU_dbh, y_OCPU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_OCPU_dbh, y_OCPU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_OCPU_dbh, y_OCPU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_OCPU_dbh, y_OCPU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_OCPU_dbh, y_OCPU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "OCPU", bty="n",cex=1.5)

#### Ocotea whitei
BCI_OCWH = subset(bci_2015_live,Latin=="Ocotea whitei")
x_OCWH = BCI_OCWH$DBH/min(BCI_OCWH$DBH)
length(x_OCWH)
x_OCWH_dbh = seq(min(x_OCWH),max(x_OCWH),length=10*length(x_OCWH))
result_OCWH = subset(result_bci_sp_all,Latin=="Ocotea whitei")

plot(sort(x_OCWH, decreasing=TRUE), 1:length(x_OCWH), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_OCWH), max(x_OCWH)), ylim = c(1, length(x_OCWH)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_OCWH = function(x){
  b_pop = result_OCWH$b_pmete
  n_pop = result_OCWH$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_OCWH = function(x){
  b_pop = 2
  n_pop = result_OCWH$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_OCWH = function(x){
  al_pop = result_OCWH$p1_qwei
  be_pop = result_OCWH$p2_qwei
  ga_pop = result_OCWH$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_OCWH_PMETE = (1-cumsum(fx_OCWH(x_OCWH_dbh)*(max(x_OCWH)-min(x_OCWH))/length(x_OCWH_dbh)))*length(x_OCWH) # parametrized mete prediction
y_OCWH_METE = (1-cumsum(gx_OCWH(x_OCWH_dbh)*(max(x_OCWH)-min(x_OCWH))/length(x_OCWH_dbh)))*length(x_OCWH) # mete prediction
y_OCWH_EXP = exp(-(result_OCWH$p_exp)*(x_OCWH_dbh-min(x_OCWH_dbh)))*length(x_OCWH)  # exponential distribution
y_OCWH_POW = ((x_OCWH_dbh)^(-(result_OCWH$p_pow)))*length(x_OCWH) # power function distribution
y_OCWH_WEI = (exp(1/((result_OCWH$p1_wei)^(result_OCWH$p2_wei))-(x_OCWH_dbh/(result_OCWH$p1_wei))^(result_OCWH$p2_wei)))*length(x_OCWH) # Weibull distribution
y_OCWH_QWEI = (1-cumsum(qwei_OCWH(x_OCWH_dbh)*(max(x_OCWH)-min(x_OCWH))/length(x_OCWH_dbh)))*length(x_OCWH) # quasi_Weibull distribution

lines(x_OCWH_dbh, y_OCWH_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_OCWH_dbh, y_OCWH_METE, col="#999999",lwd=2) #, lty=5)
lines(x_OCWH_dbh, y_OCWH_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_OCWH_dbh, y_OCWH_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_OCWH_dbh, y_OCWH_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_OCWH_dbh, y_OCWH_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "OCWH", bty="n",cex=1.5)

#### Siparuna pauciflora
BCI_SIPA = subset(bci_2015_live,Latin=="Siparuna pauciflora")
x_SIPA = BCI_SIPA$DBH/min(BCI_SIPA$DBH)
length(x_SIPA)
x_SIPA_dbh = seq(min(x_SIPA),max(x_SIPA),length=10*length(x_SIPA))
result_SIPA = subset(result_bci_sp_all,Latin=="Siparuna pauciflora")

plot(sort(x_SIPA, decreasing=TRUE), 1:length(x_SIPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SIPA), max(x_SIPA)), ylim = c(1, length(x_SIPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SIPA = function(x){
  b_pop = result_SIPA$b_pmete
  n_pop = result_SIPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SIPA = function(x){
  b_pop = 2
  n_pop = result_SIPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SIPA = function(x){
  al_pop = result_SIPA$p1_qwei
  be_pop = result_SIPA$p2_qwei
  ga_pop = result_SIPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SIPA_PMETE = (1-cumsum(fx_SIPA(x_SIPA_dbh)*(max(x_SIPA)-min(x_SIPA))/length(x_SIPA_dbh)))*length(x_SIPA) # parametrized mete prediction
y_SIPA_METE = (1-cumsum(gx_SIPA(x_SIPA_dbh)*(max(x_SIPA)-min(x_SIPA))/length(x_SIPA_dbh)))*length(x_SIPA) # mete prediction
y_SIPA_EXP = exp(-(result_SIPA$p_exp)*(x_SIPA_dbh-min(x_SIPA_dbh)))*length(x_SIPA)  # exponential distribution
y_SIPA_POW = ((x_SIPA_dbh)^(-(result_SIPA$p_pow)))*length(x_SIPA) # power function distribution
y_SIPA_WEI = (exp(1/((result_SIPA$p1_wei)^(result_SIPA$p2_wei))-(x_SIPA_dbh/(result_SIPA$p1_wei))^(result_SIPA$p2_wei)))*length(x_SIPA) # Weibull distribution
y_SIPA_QWEI = (1-cumsum(qwei_SIPA(x_SIPA_dbh)*(max(x_SIPA)-min(x_SIPA))/length(x_SIPA_dbh)))*length(x_SIPA) # quasi_Weibull distribution

lines(x_SIPA_dbh, y_SIPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SIPA_dbh, y_SIPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SIPA_dbh, y_SIPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SIPA_dbh, y_SIPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SIPA_dbh, y_SIPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SIPA_dbh, y_SIPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SIPA", bty="n",cex=1.5)
```
### BCI (Order=Magnoliales)
```{r}
par(mfrow=c(3,3),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Anaxagorea panamensis
BCI_ANPA = subset(bci_2015_live,Latin=="Anaxagorea panamensis")
x_ANPA = BCI_ANPA$DBH/min(BCI_ANPA$DBH)
length(x_ANPA)
x_ANPA_dbh = seq(min(x_ANPA),max(x_ANPA),length=10*length(x_ANPA))
result_ANPA = subset(result_bci_sp_all,Latin=="Anaxagorea panamensis")

plot(sort(x_ANPA, decreasing=TRUE), 1:length(x_ANPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ANPA), max(x_ANPA)), ylim = c(1, length(x_ANPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ANPA = function(x){
  b_pop = result_ANPA$b_pmete
  n_pop = result_ANPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ANPA = function(x){
  b_pop = 2
  n_pop = result_ANPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ANPA = function(x){
  al_pop = result_ANPA$p1_qwei
  be_pop = result_ANPA$p2_qwei
  ga_pop = result_ANPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ANPA_PMETE = (1-cumsum(fx_ANPA(x_ANPA_dbh)*(max(x_ANPA)-min(x_ANPA))/length(x_ANPA_dbh)))*length(x_ANPA) # parametrized mete prediction
y_ANPA_METE = (1-cumsum(gx_ANPA(x_ANPA_dbh)*(max(x_ANPA)-min(x_ANPA))/length(x_ANPA_dbh)))*length(x_ANPA) # mete prediction
y_ANPA_EXP = exp(-(result_ANPA$p_exp)*(x_ANPA_dbh-min(x_ANPA_dbh)))*length(x_ANPA)  # exponential distribution
y_ANPA_POW = ((x_ANPA_dbh)^(-(result_ANPA$p_pow)))*length(x_ANPA) # power function distribution
y_ANPA_WEI = (exp(1/((result_ANPA$p1_wei)^(result_ANPA$p2_wei))-(x_ANPA_dbh/(result_ANPA$p1_wei))^(result_ANPA$p2_wei)))*length(x_ANPA) # Weibull distribution
y_ANPA_QWEI = (1-cumsum(qwei_ANPA(x_ANPA_dbh)*(max(x_ANPA)-min(x_ANPA))/length(x_ANPA_dbh)))*length(x_ANPA) # quasi_Weibull distribution

lines(x_ANPA_dbh, y_ANPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ANPA_dbh, y_ANPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ANPA_dbh, y_ANPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ANPA_dbh, y_ANPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ANPA_dbh, y_ANPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ANPA_dbh, y_ANPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ANPA", bty="n",cex=1.5)

#### Annona acuminata
BCI_ANAC = subset(bci_2015_live,Latin=="Annona acuminata")
x_ANAC = BCI_ANAC$DBH/min(BCI_ANAC$DBH)
length(x_ANAC)
x_ANAC_dbh = seq(min(x_ANAC),max(x_ANAC),length=10*length(x_ANAC))
result_ANAC = subset(result_bci_sp_all,Latin=="Annona acuminata")

plot(sort(x_ANAC, decreasing=TRUE), 1:length(x_ANAC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ANAC), max(x_ANAC)), ylim = c(1, length(x_ANAC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ANAC = function(x){
  b_pop = result_ANAC$b_pmete
  n_pop = result_ANAC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ANAC = function(x){
  b_pop = 2
  n_pop = result_ANAC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ANAC = function(x){
  al_pop = result_ANAC$p1_qwei
  be_pop = result_ANAC$p2_qwei
  ga_pop = result_ANAC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ANAC_PMETE = (1-cumsum(fx_ANAC(x_ANAC_dbh)*(max(x_ANAC)-min(x_ANAC))/length(x_ANAC_dbh)))*length(x_ANAC) # parametrized mete prediction
y_ANAC_METE = (1-cumsum(gx_ANAC(x_ANAC_dbh)*(max(x_ANAC)-min(x_ANAC))/length(x_ANAC_dbh)))*length(x_ANAC) # mete prediction
y_ANAC_EXP = exp(-(result_ANAC$p_exp)*(x_ANAC_dbh-min(x_ANAC_dbh)))*length(x_ANAC)  # exponential distribution
y_ANAC_POW = ((x_ANAC_dbh)^(-(result_ANAC$p_pow)))*length(x_ANAC) # power function distribution
y_ANAC_WEI = (exp(1/((result_ANAC$p1_wei)^(result_ANAC$p2_wei))-(x_ANAC_dbh/(result_ANAC$p1_wei))^(result_ANAC$p2_wei)))*length(x_ANAC) # Weibull distribution
y_ANAC_QWEI = (1-cumsum(qwei_ANAC(x_ANAC_dbh)*(max(x_ANAC)-min(x_ANAC))/length(x_ANAC_dbh)))*length(x_ANAC) # quasi_Weibull distribution

lines(x_ANAC_dbh, y_ANAC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ANAC_dbh, y_ANAC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ANAC_dbh, y_ANAC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ANAC_dbh, y_ANAC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ANAC_dbh, y_ANAC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ANAC_dbh, y_ANAC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ANAC", bty="n",cex=1.5)

#### Desmopsis panamensis
BCI_DEPA = subset(bci_2015_live,Latin=="Desmopsis panamensis")
x_DEPA = BCI_DEPA$DBH/min(BCI_DEPA$DBH)
length(x_DEPA)
x_DEPA_dbh = seq(min(x_DEPA),max(x_DEPA),length=10*length(x_DEPA))
result_DEPA = subset(result_bci_sp_all,Latin=="Desmopsis panamensis")

plot(sort(x_DEPA, decreasing=TRUE), 1:length(x_DEPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_DEPA), max(x_DEPA)), ylim = c(1, length(x_DEPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_DEPA = function(x){
  b_pop = result_DEPA$b_pmete
  n_pop = result_DEPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_DEPA = function(x){
  b_pop = 2
  n_pop = result_DEPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_DEPA = function(x){
  al_pop = result_DEPA$p1_qwei
  be_pop = result_DEPA$p2_qwei
  ga_pop = result_DEPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_DEPA_PMETE = (1-cumsum(fx_DEPA(x_DEPA_dbh)*(max(x_DEPA)-min(x_DEPA))/length(x_DEPA_dbh)))*length(x_DEPA) # parametrized mete prediction
y_DEPA_METE = (1-cumsum(gx_DEPA(x_DEPA_dbh)*(max(x_DEPA)-min(x_DEPA))/length(x_DEPA_dbh)))*length(x_DEPA) # mete prediction
y_DEPA_EXP = exp(-(result_DEPA$p_exp)*(x_DEPA_dbh-min(x_DEPA_dbh)))*length(x_DEPA)  # exponential distribution
y_DEPA_POW = ((x_DEPA_dbh)^(-(result_DEPA$p_pow)))*length(x_DEPA) # power function distribution
y_DEPA_WEI = (exp(1/((result_DEPA$p1_wei)^(result_DEPA$p2_wei))-(x_DEPA_dbh/(result_DEPA$p1_wei))^(result_DEPA$p2_wei)))*length(x_DEPA) # Weibull distribution
y_DEPA_QWEI = (1-cumsum(qwei_DEPA(x_DEPA_dbh)*(max(x_DEPA)-min(x_DEPA))/length(x_DEPA_dbh)))*length(x_DEPA) # quasi_Weibull distribution

lines(x_DEPA_dbh, y_DEPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_DEPA_dbh, y_DEPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_DEPA_dbh, y_DEPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_DEPA_dbh, y_DEPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_DEPA_dbh, y_DEPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_DEPA_dbh, y_DEPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "DEPA", bty="n",cex=1.5)

#### Guatteria dumetorum
BCI_GUDU = subset(bci_2015_live,Latin=="Guatteria dumetorum")
x_GUDU = BCI_GUDU$DBH/min(BCI_GUDU$DBH)
length(x_GUDU)
x_GUDU_dbh = seq(min(x_GUDU),max(x_GUDU),length=10*length(x_GUDU))
result_GUDU = subset(result_bci_sp_all,Latin=="Guatteria dumetorum")

plot(sort(x_GUDU, decreasing=TRUE), 1:length(x_GUDU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUDU), max(x_GUDU)), ylim = c(1, length(x_GUDU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUDU = function(x){
  b_pop = result_GUDU$b_pmete
  n_pop = result_GUDU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUDU = function(x){
  b_pop = 2
  n_pop = result_GUDU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUDU = function(x){
  al_pop = result_GUDU$p1_qwei
  be_pop = result_GUDU$p2_qwei
  ga_pop = result_GUDU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUDU_PMETE = (1-cumsum(fx_GUDU(x_GUDU_dbh)*(max(x_GUDU)-min(x_GUDU))/length(x_GUDU_dbh)))*length(x_GUDU) # parametrized mete prediction
y_GUDU_METE = (1-cumsum(gx_GUDU(x_GUDU_dbh)*(max(x_GUDU)-min(x_GUDU))/length(x_GUDU_dbh)))*length(x_GUDU) # mete prediction
y_GUDU_EXP = exp(-(result_GUDU$p_exp)*(x_GUDU_dbh-min(x_GUDU_dbh)))*length(x_GUDU)  # exponential distribution
y_GUDU_POW = ((x_GUDU_dbh)^(-(result_GUDU$p_pow)))*length(x_GUDU) # power function distribution
y_GUDU_WEI = (exp(1/((result_GUDU$p1_wei)^(result_GUDU$p2_wei))-(x_GUDU_dbh/(result_GUDU$p1_wei))^(result_GUDU$p2_wei)))*length(x_GUDU) # Weibull distribution
y_GUDU_QWEI = (1-cumsum(qwei_GUDU(x_GUDU_dbh)*(max(x_GUDU)-min(x_GUDU))/length(x_GUDU_dbh)))*length(x_GUDU) # quasi_Weibull distribution

lines(x_GUDU_dbh, y_GUDU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUDU_dbh, y_GUDU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUDU_dbh, y_GUDU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUDU_dbh, y_GUDU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUDU_dbh, y_GUDU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUDU_dbh, y_GUDU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUDU", bty="n",cex=1.5)

#### Mosannona garwoodii
BCI_MOGA = subset(bci_2015_live,Latin=="Mosannona garwoodii")
x_MOGA = BCI_MOGA$DBH/min(BCI_MOGA$DBH)
length(x_MOGA)
x_MOGA_dbh = seq(min(x_MOGA),max(x_MOGA),length=10*length(x_MOGA))
result_MOGA = subset(result_bci_sp_all,Latin=="Mosannona garwoodii")

plot(sort(x_MOGA, decreasing=TRUE), 1:length(x_MOGA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MOGA), max(x_MOGA)), ylim = c(1, length(x_MOGA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MOGA = function(x){
  b_pop = result_MOGA$b_pmete
  n_pop = result_MOGA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MOGA = function(x){
  b_pop = 2
  n_pop = result_MOGA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MOGA = function(x){
  al_pop = result_MOGA$p1_qwei
  be_pop = result_MOGA$p2_qwei
  ga_pop = result_MOGA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MOGA_PMETE = (1-cumsum(fx_MOGA(x_MOGA_dbh)*(max(x_MOGA)-min(x_MOGA))/length(x_MOGA_dbh)))*length(x_MOGA) # parametrized mete prediction
y_MOGA_METE = (1-cumsum(gx_MOGA(x_MOGA_dbh)*(max(x_MOGA)-min(x_MOGA))/length(x_MOGA_dbh)))*length(x_MOGA) # mete prediction
y_MOGA_EXP = exp(-(result_MOGA$p_exp)*(x_MOGA_dbh-min(x_MOGA_dbh)))*length(x_MOGA)  # exponential distribution
y_MOGA_POW = ((x_MOGA_dbh)^(-(result_MOGA$p_pow)))*length(x_MOGA) # power function distribution
y_MOGA_WEI = (exp(1/((result_MOGA$p1_wei)^(result_MOGA$p2_wei))-(x_MOGA_dbh/(result_MOGA$p1_wei))^(result_MOGA$p2_wei)))*length(x_MOGA) # Weibull distribution
y_MOGA_QWEI = (1-cumsum(qwei_MOGA(x_MOGA_dbh)*(max(x_MOGA)-min(x_MOGA))/length(x_MOGA_dbh)))*length(x_MOGA) # quasi_Weibull distribution

lines(x_MOGA_dbh, y_MOGA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MOGA_dbh, y_MOGA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MOGA_dbh, y_MOGA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MOGA_dbh, y_MOGA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MOGA_dbh, y_MOGA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MOGA_dbh, y_MOGA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MOGA", bty="n",cex=1.5)

#### Unonopsis pittieri
BCI_UNPI = subset(bci_2015_live,Latin=="Unonopsis pittieri")
x_UNPI = BCI_UNPI$DBH/min(BCI_UNPI$DBH)
length(x_UNPI)
x_UNPI_dbh = seq(min(x_UNPI),max(x_UNPI),length=10*length(x_UNPI))
result_UNPI = subset(result_bci_sp_all,Latin=="Unonopsis pittieri")

plot(sort(x_UNPI, decreasing=TRUE), 1:length(x_UNPI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_UNPI), max(x_UNPI)), ylim = c(1, length(x_UNPI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_UNPI = function(x){
  b_pop = result_UNPI$b_pmete
  n_pop = result_UNPI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_UNPI = function(x){
  b_pop = 2
  n_pop = result_UNPI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_UNPI = function(x){
  al_pop = result_UNPI$p1_qwei
  be_pop = result_UNPI$p2_qwei
  ga_pop = result_UNPI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_UNPI_PMETE = (1-cumsum(fx_UNPI(x_UNPI_dbh)*(max(x_UNPI)-min(x_UNPI))/length(x_UNPI_dbh)))*length(x_UNPI) # parametrized mete prediction
y_UNPI_METE = (1-cumsum(gx_UNPI(x_UNPI_dbh)*(max(x_UNPI)-min(x_UNPI))/length(x_UNPI_dbh)))*length(x_UNPI) # mete prediction
y_UNPI_EXP = exp(-(result_UNPI$p_exp)*(x_UNPI_dbh-min(x_UNPI_dbh)))*length(x_UNPI)  # exponential distribution
y_UNPI_POW = ((x_UNPI_dbh)^(-(result_UNPI$p_pow)))*length(x_UNPI) # power function distribution
y_UNPI_WEI = (exp(1/((result_UNPI$p1_wei)^(result_UNPI$p2_wei))-(x_UNPI_dbh/(result_UNPI$p1_wei))^(result_UNPI$p2_wei)))*length(x_UNPI) # Weibull distribution
y_UNPI_QWEI = (1-cumsum(qwei_UNPI(x_UNPI_dbh)*(max(x_UNPI)-min(x_UNPI))/length(x_UNPI_dbh)))*length(x_UNPI) # quasi_Weibull distribution

lines(x_UNPI_dbh, y_UNPI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_UNPI_dbh, y_UNPI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_UNPI_dbh, y_UNPI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_UNPI_dbh, y_UNPI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_UNPI_dbh, y_UNPI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_UNPI_dbh, y_UNPI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "UNPI", bty="n",cex=1.5)

#### Virola sebifera
BCI_VISE = subset(bci_2015_live,Latin=="Virola sebifera")
x_VISE = BCI_VISE$DBH/min(BCI_VISE$DBH)
length(x_VISE)
x_VISE_dbh = seq(min(x_VISE),max(x_VISE),length=10*length(x_VISE))
result_VISE = subset(result_bci_sp_all,Latin=="Virola sebifera")

plot(sort(x_VISE, decreasing=TRUE), 1:length(x_VISE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_VISE), max(x_VISE)), ylim = c(1, length(x_VISE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_VISE = function(x){
  b_pop = result_VISE$b_pmete
  n_pop = result_VISE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_VISE = function(x){
  b_pop = 2
  n_pop = result_VISE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_VISE = function(x){
  al_pop = result_VISE$p1_qwei
  be_pop = result_VISE$p2_qwei
  ga_pop = result_VISE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_VISE_PMETE = (1-cumsum(fx_VISE(x_VISE_dbh)*(max(x_VISE)-min(x_VISE))/length(x_VISE_dbh)))*length(x_VISE) # parametrized mete prediction
y_VISE_METE = (1-cumsum(gx_VISE(x_VISE_dbh)*(max(x_VISE)-min(x_VISE))/length(x_VISE_dbh)))*length(x_VISE) # mete prediction
y_VISE_EXP = exp(-(result_VISE$p_exp)*(x_VISE_dbh-min(x_VISE_dbh)))*length(x_VISE)  # exponential distribution
y_VISE_POW = ((x_VISE_dbh)^(-(result_VISE$p_pow)))*length(x_VISE) # power function distribution
y_VISE_WEI = (exp(1/((result_VISE$p1_wei)^(result_VISE$p2_wei))-(x_VISE_dbh/(result_VISE$p1_wei))^(result_VISE$p2_wei)))*length(x_VISE) # Weibull distribution
y_VISE_QWEI = (1-cumsum(qwei_VISE(x_VISE_dbh)*(max(x_VISE)-min(x_VISE))/length(x_VISE_dbh)))*length(x_VISE) # quasi_Weibull distribution

lines(x_VISE_dbh, y_VISE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_VISE_dbh, y_VISE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_VISE_dbh, y_VISE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_VISE_dbh, y_VISE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_VISE_dbh, y_VISE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_VISE_dbh, y_VISE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "VISE", bty="n",cex=1.5)

#### Virola surinamensis
BCI_VISU = subset(bci_2015_live,Latin=="Virola surinamensis")
x_VISU = BCI_VISU$DBH/min(BCI_VISU$DBH)
length(x_VISU)
x_VISU_dbh = seq(min(x_VISU),max(x_VISU),length=10*length(x_VISU))
result_VISU = subset(result_bci_sp_all,Latin=="Virola surinamensis")

plot(sort(x_VISU, decreasing=TRUE), 1:length(x_VISU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_VISU), max(x_VISU)), ylim = c(1, length(x_VISU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_VISU = function(x){
  b_pop = result_VISU$b_pmete
  n_pop = result_VISU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_VISU = function(x){
  b_pop = 2
  n_pop = result_VISU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_VISU = function(x){
  al_pop = result_VISU$p1_qwei
  be_pop = result_VISU$p2_qwei
  ga_pop = result_VISU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_VISU_PMETE = (1-cumsum(fx_VISU(x_VISU_dbh)*(max(x_VISU)-min(x_VISU))/length(x_VISU_dbh)))*length(x_VISU) # parametrized mete prediction
y_VISU_METE = (1-cumsum(gx_VISU(x_VISU_dbh)*(max(x_VISU)-min(x_VISU))/length(x_VISU_dbh)))*length(x_VISU) # mete prediction
y_VISU_EXP = exp(-(result_VISU$p_exp)*(x_VISU_dbh-min(x_VISU_dbh)))*length(x_VISU)  # exponential distribution
y_VISU_POW = ((x_VISU_dbh)^(-(result_VISU$p_pow)))*length(x_VISU) # power function distribution
y_VISU_WEI = (exp(1/((result_VISU$p1_wei)^(result_VISU$p2_wei))-(x_VISU_dbh/(result_VISU$p1_wei))^(result_VISU$p2_wei)))*length(x_VISU) # Weibull distribution
y_VISU_QWEI = (1-cumsum(qwei_VISU(x_VISU_dbh)*(max(x_VISU)-min(x_VISU))/length(x_VISU_dbh)))*length(x_VISU) # quasi_Weibull distribution

lines(x_VISU_dbh, y_VISU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_VISU_dbh, y_VISU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_VISU_dbh, y_VISU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_VISU_dbh, y_VISU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_VISU_dbh, y_VISU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_VISU_dbh, y_VISU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "VISU", bty="n",cex=1.5)

#### Xylopia macrantha
BCI_XYMA = subset(bci_2015_live,Latin=="Xylopia macrantha")
x_XYMA = BCI_XYMA$DBH/min(BCI_XYMA$DBH)
length(x_XYMA)
x_XYMA_dbh = seq(min(x_XYMA),max(x_XYMA),length=10*length(x_XYMA))
result_XYMA = subset(result_bci_sp_all,Latin=="Xylopia macrantha")

plot(sort(x_XYMA, decreasing=TRUE), 1:length(x_XYMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_XYMA), max(x_XYMA)), ylim = c(1, length(x_XYMA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_XYMA = function(x){
  b_pop = result_XYMA$b_pmete
  n_pop = result_XYMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_XYMA = function(x){
  b_pop = 2
  n_pop = result_XYMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_XYMA = function(x){
  al_pop = result_XYMA$p1_qwei
  be_pop = result_XYMA$p2_qwei
  ga_pop = result_XYMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_XYMA_PMETE = (1-cumsum(fx_XYMA(x_XYMA_dbh)*(max(x_XYMA)-min(x_XYMA))/length(x_XYMA_dbh)))*length(x_XYMA) # parametrized mete prediction
y_XYMA_METE = (1-cumsum(gx_XYMA(x_XYMA_dbh)*(max(x_XYMA)-min(x_XYMA))/length(x_XYMA_dbh)))*length(x_XYMA) # mete prediction
y_XYMA_EXP = exp(-(result_XYMA$p_exp)*(x_XYMA_dbh-min(x_XYMA_dbh)))*length(x_XYMA)  # exponential distribution
y_XYMA_POW = ((x_XYMA_dbh)^(-(result_XYMA$p_pow)))*length(x_XYMA) # power function distribution
y_XYMA_WEI = (exp(1/((result_XYMA$p1_wei)^(result_XYMA$p2_wei))-(x_XYMA_dbh/(result_XYMA$p1_wei))^(result_XYMA$p2_wei)))*length(x_XYMA) # Weibull distribution
y_XYMA_QWEI = (1-cumsum(qwei_XYMA(x_XYMA_dbh)*(max(x_XYMA)-min(x_XYMA))/length(x_XYMA_dbh)))*length(x_XYMA) # quasi_Weibull distribution

lines(x_XYMA_dbh, y_XYMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_XYMA_dbh, y_XYMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_XYMA_dbh, y_XYMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_XYMA_dbh, y_XYMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_XYMA_dbh, y_XYMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_XYMA_dbh, y_XYMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "XYMA", bty="n",cex=1.5)
```
### BCI (Order=Malpighiales)
```{r}
par(mfrow=c(5,5),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Calophyllum longifolium
BCI_CALO = subset(bci_2015_live,Latin=="Calophyllum longifolium")
x_CALO = BCI_CALO$DBH/min(BCI_CALO$DBH)
length(x_CALO)
x_CALO_dbh = seq(min(x_CALO),max(x_CALO),length=10*length(x_CALO))
result_CALO = subset(result_bci_sp_all,Latin=="Calophyllum longifolium")

plot(sort(x_CALO, decreasing=TRUE), 1:length(x_CALO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CALO), max(x_CALO)), ylim = c(1, length(x_CALO)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CALO = function(x){
  b_pop = result_CALO$b_pmete
  n_pop = result_CALO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CALO = function(x){
  b_pop = 2
  n_pop = result_CALO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CALO = function(x){
  al_pop = result_CALO$p1_qwei
  be_pop = result_CALO$p2_qwei
  ga_pop = result_CALO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CALO_PMETE = (1-cumsum(fx_CALO(x_CALO_dbh)*(max(x_CALO)-min(x_CALO))/length(x_CALO_dbh)))*length(x_CALO) # parametrized mete prediction
y_CALO_METE = (1-cumsum(gx_CALO(x_CALO_dbh)*(max(x_CALO)-min(x_CALO))/length(x_CALO_dbh)))*length(x_CALO) # mete prediction
y_CALO_EXP = exp(-(result_CALO$p_exp)*(x_CALO_dbh-min(x_CALO_dbh)))*length(x_CALO)  # exponential distribution
y_CALO_POW = ((x_CALO_dbh)^(-(result_CALO$p_pow)))*length(x_CALO) # power function distribution
y_CALO_WEI = (exp(1/((result_CALO$p1_wei)^(result_CALO$p2_wei))-(x_CALO_dbh/(result_CALO$p1_wei))^(result_CALO$p2_wei)))*length(x_CALO) # Weibull distribution
y_CALO_QWEI = (1-cumsum(qwei_CALO(x_CALO_dbh)*(max(x_CALO)-min(x_CALO))/length(x_CALO_dbh)))*length(x_CALO) # quasi_Weibull distribution

lines(x_CALO_dbh, y_CALO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CALO_dbh, y_CALO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CALO_dbh, y_CALO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CALO_dbh, y_CALO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CALO_dbh, y_CALO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CALO_dbh, y_CALO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CALO", bty="n",cex=1.5)

#### Casearia aculeata
BCI_CAAC = subset(bci_2015_live,Latin=="Casearia aculeata")
x_CAAC = BCI_CAAC$DBH/min(BCI_CAAC$DBH)
length(x_CAAC)
x_CAAC_dbh = seq(min(x_CAAC),max(x_CAAC),length=10*length(x_CAAC))
result_CAAC = subset(result_bci_sp_all,Latin=="Casearia aculeata")

plot(sort(x_CAAC, decreasing=TRUE), 1:length(x_CAAC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CAAC), max(x_CAAC)), ylim = c(1, length(x_CAAC)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CAAC = function(x){
  b_pop = result_CAAC$b_pmete
  n_pop = result_CAAC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CAAC = function(x){
  b_pop = 2
  n_pop = result_CAAC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CAAC = function(x){
  al_pop = result_CAAC$p1_qwei
  be_pop = result_CAAC$p2_qwei
  ga_pop = result_CAAC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CAAC_PMETE = (1-cumsum(fx_CAAC(x_CAAC_dbh)*(max(x_CAAC)-min(x_CAAC))/length(x_CAAC_dbh)))*length(x_CAAC) # parametrized mete prediction
y_CAAC_METE = (1-cumsum(gx_CAAC(x_CAAC_dbh)*(max(x_CAAC)-min(x_CAAC))/length(x_CAAC_dbh)))*length(x_CAAC) # mete prediction
y_CAAC_EXP = exp(-(result_CAAC$p_exp)*(x_CAAC_dbh-min(x_CAAC_dbh)))*length(x_CAAC)  # exponential distribution
y_CAAC_POW = ((x_CAAC_dbh)^(-(result_CAAC$p_pow)))*length(x_CAAC) # power function distribution
y_CAAC_WEI = (exp(1/((result_CAAC$p1_wei)^(result_CAAC$p2_wei))-(x_CAAC_dbh/(result_CAAC$p1_wei))^(result_CAAC$p2_wei)))*length(x_CAAC) # Weibull distribution
y_CAAC_QWEI = (1-cumsum(qwei_CAAC(x_CAAC_dbh)*(max(x_CAAC)-min(x_CAAC))/length(x_CAAC_dbh)))*length(x_CAAC) # quasi_Weibull distribution

lines(x_CAAC_dbh, y_CAAC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CAAC_dbh, y_CAAC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CAAC_dbh, y_CAAC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CAAC_dbh, y_CAAC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CAAC_dbh, y_CAAC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CAAC_dbh, y_CAAC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CAAC", bty="n",cex=1.5)

#### Casearia arborea
BCI_CAAR = subset(bci_2015_live,Latin=="Casearia arborea")
x_CAAR = BCI_CAAR$DBH/min(BCI_CAAR$DBH)
length(x_CAAR)
x_CAAR_dbh = seq(min(x_CAAR),max(x_CAAR),length=10*length(x_CAAR))
result_CAAR = subset(result_bci_sp_all,Latin=="Casearia arborea")

plot(sort(x_CAAR, decreasing=TRUE), 1:length(x_CAAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CAAR), max(x_CAAR)), ylim = c(1, length(x_CAAR)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CAAR = function(x){
  b_pop = result_CAAR$b_pmete
  n_pop = result_CAAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CAAR = function(x){
  b_pop = 2
  n_pop = result_CAAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CAAR = function(x){
  al_pop = result_CAAR$p1_qwei
  be_pop = result_CAAR$p2_qwei
  ga_pop = result_CAAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CAAR_PMETE = (1-cumsum(fx_CAAR(x_CAAR_dbh)*(max(x_CAAR)-min(x_CAAR))/length(x_CAAR_dbh)))*length(x_CAAR) # parametrized mete prediction
y_CAAR_METE = (1-cumsum(gx_CAAR(x_CAAR_dbh)*(max(x_CAAR)-min(x_CAAR))/length(x_CAAR_dbh)))*length(x_CAAR) # mete prediction
y_CAAR_EXP = exp(-(result_CAAR$p_exp)*(x_CAAR_dbh-min(x_CAAR_dbh)))*length(x_CAAR)  # exponential distribution
y_CAAR_POW = ((x_CAAR_dbh)^(-(result_CAAR$p_pow)))*length(x_CAAR) # power function distribution
y_CAAR_WEI = (exp(1/((result_CAAR$p1_wei)^(result_CAAR$p2_wei))-(x_CAAR_dbh/(result_CAAR$p1_wei))^(result_CAAR$p2_wei)))*length(x_CAAR) # Weibull distribution
y_CAAR_QWEI = (1-cumsum(qwei_CAAR(x_CAAR_dbh)*(max(x_CAAR)-min(x_CAAR))/length(x_CAAR_dbh)))*length(x_CAAR) # quasi_Weibull distribution

lines(x_CAAR_dbh, y_CAAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CAAR_dbh, y_CAAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CAAR_dbh, y_CAAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CAAR_dbh, y_CAAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CAAR_dbh, y_CAAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CAAR_dbh, y_CAAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CAAR", bty="n",cex=1.5)

#### Casearia sylvestris
BCI_CASY = subset(bci_2015_live,Latin=="Casearia sylvestris")
x_CASY = BCI_CASY$DBH/min(BCI_CASY$DBH)
length(x_CASY)
x_CASY_dbh = seq(min(x_CASY),max(x_CASY),length=10*length(x_CASY))
result_CASY = subset(result_bci_sp_all,Latin=="Casearia sylvestris")

plot(sort(x_CASY, decreasing=TRUE), 1:length(x_CASY), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CASY), max(x_CASY)), ylim = c(1, length(x_CASY)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CASY = function(x){
  b_pop = result_CASY$b_pmete
  n_pop = result_CASY$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CASY = function(x){
  b_pop = 2
  n_pop = result_CASY$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CASY = function(x){
  al_pop = result_CASY$p1_qwei
  be_pop = result_CASY$p2_qwei
  ga_pop = result_CASY$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CASY_PMETE = (1-cumsum(fx_CASY(x_CASY_dbh)*(max(x_CASY)-min(x_CASY))/length(x_CASY_dbh)))*length(x_CASY) # parametrized mete prediction
y_CASY_METE = (1-cumsum(gx_CASY(x_CASY_dbh)*(max(x_CASY)-min(x_CASY))/length(x_CASY_dbh)))*length(x_CASY) # mete prediction
y_CASY_EXP = exp(-(result_CASY$p_exp)*(x_CASY_dbh-min(x_CASY_dbh)))*length(x_CASY)  # exponential distribution
y_CASY_POW = ((x_CASY_dbh)^(-(result_CASY$p_pow)))*length(x_CASY) # power function distribution
y_CASY_WEI = (exp(1/((result_CASY$p1_wei)^(result_CASY$p2_wei))-(x_CASY_dbh/(result_CASY$p1_wei))^(result_CASY$p2_wei)))*length(x_CASY) # Weibull distribution
y_CASY_QWEI = (1-cumsum(qwei_CASY(x_CASY_dbh)*(max(x_CASY)-min(x_CASY))/length(x_CASY_dbh)))*length(x_CASY) # quasi_Weibull distribution

lines(x_CASY_dbh, y_CASY_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CASY_dbh, y_CASY_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CASY_dbh, y_CASY_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CASY_dbh, y_CASY_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CASY_dbh, y_CASY_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CASY_dbh, y_CASY_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CASY", bty="n",cex=1.5)

#### Cassipourea elliptica
BCI_CAEL = subset(bci_2015_live,Latin=="Cassipourea elliptica")
x_CAEL = BCI_CAEL$DBH/min(BCI_CAEL$DBH)
length(x_CAEL)
x_CAEL_dbh = seq(min(x_CAEL),max(x_CAEL),length=10*length(x_CAEL))
result_CAEL = subset(result_bci_sp_all,Latin=="Cassipourea elliptica")

plot(sort(x_CAEL, decreasing=TRUE), 1:length(x_CAEL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CAEL), max(x_CAEL)), ylim = c(1, length(x_CAEL)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CAEL = function(x){
  b_pop = result_CAEL$b_pmete
  n_pop = result_CAEL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CAEL = function(x){
  b_pop = 2
  n_pop = result_CAEL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CAEL = function(x){
  al_pop = result_CAEL$p1_qwei
  be_pop = result_CAEL$p2_qwei
  ga_pop = result_CAEL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CAEL_PMETE = (1-cumsum(fx_CAEL(x_CAEL_dbh)*(max(x_CAEL)-min(x_CAEL))/length(x_CAEL_dbh)))*length(x_CAEL) # parametrized mete prediction
y_CAEL_METE = (1-cumsum(gx_CAEL(x_CAEL_dbh)*(max(x_CAEL)-min(x_CAEL))/length(x_CAEL_dbh)))*length(x_CAEL) # mete prediction
y_CAEL_EXP = exp(-(result_CAEL$p_exp)*(x_CAEL_dbh-min(x_CAEL_dbh)))*length(x_CAEL)  # exponential distribution
y_CAEL_POW = ((x_CAEL_dbh)^(-(result_CAEL$p_pow)))*length(x_CAEL) # power function distribution
y_CAEL_WEI = (exp(1/((result_CAEL$p1_wei)^(result_CAEL$p2_wei))-(x_CAEL_dbh/(result_CAEL$p1_wei))^(result_CAEL$p2_wei)))*length(x_CAEL) # Weibull distribution
y_CAEL_QWEI = (1-cumsum(qwei_CAEL(x_CAEL_dbh)*(max(x_CAEL)-min(x_CAEL))/length(x_CAEL_dbh)))*length(x_CAEL) # quasi_Weibull distribution

lines(x_CAEL_dbh, y_CAEL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CAEL_dbh, y_CAEL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CAEL_dbh, y_CAEL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CAEL_dbh, y_CAEL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CAEL_dbh, y_CAEL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CAEL_dbh, y_CAEL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CAEL", bty="n",cex=1.5)

#### Cespedesia spathulata
BCI_CESP = subset(bci_2015_live,Latin=="Cespedesia spathulata")
x_CESP = BCI_CESP$DBH/min(BCI_CESP$DBH)
length(x_CESP)
x_CESP_dbh = seq(min(x_CESP),max(x_CESP),length=10*length(x_CESP))
result_CESP = subset(result_bci_sp_all,Latin=="Cespedesia spathulata")

plot(sort(x_CESP, decreasing=TRUE), 1:length(x_CESP), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CESP), max(x_CESP)), ylim = c(1, length(x_CESP)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CESP = function(x){
  b_pop = result_CESP$b_pmete
  n_pop = result_CESP$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CESP = function(x){
  b_pop = 2
  n_pop = result_CESP$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CESP = function(x){
  al_pop = result_CESP$p1_qwei
  be_pop = result_CESP$p2_qwei
  ga_pop = result_CESP$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CESP_PMETE = (1-cumsum(fx_CESP(x_CESP_dbh)*(max(x_CESP)-min(x_CESP))/length(x_CESP_dbh)))*length(x_CESP) # parametrized mete prediction
y_CESP_METE = (1-cumsum(gx_CESP(x_CESP_dbh)*(max(x_CESP)-min(x_CESP))/length(x_CESP_dbh)))*length(x_CESP) # mete prediction
y_CESP_EXP = exp(-(result_CESP$p_exp)*(x_CESP_dbh-min(x_CESP_dbh)))*length(x_CESP)  # exponential distribution
y_CESP_POW = ((x_CESP_dbh)^(-(result_CESP$p_pow)))*length(x_CESP) # power function distribution
y_CESP_WEI = (exp(1/((result_CESP$p1_wei)^(result_CESP$p2_wei))-(x_CESP_dbh/(result_CESP$p1_wei))^(result_CESP$p2_wei)))*length(x_CESP) # Weibull distribution
y_CESP_QWEI = (1-cumsum(qwei_CESP(x_CESP_dbh)*(max(x_CESP)-min(x_CESP))/length(x_CESP_dbh)))*length(x_CESP) # quasi_Weibull distribution

lines(x_CESP_dbh, y_CESP_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CESP_dbh, y_CESP_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CESP_dbh, y_CESP_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CESP_dbh, y_CESP_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CESP_dbh, y_CESP_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CESP_dbh, y_CESP_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CESP", bty="n",cex=1.5)

#### Chrysochlamys eclipes
BCI_CHEC = subset(bci_2015_live,Latin=="Chrysochlamys eclipes")
x_CHEC = BCI_CHEC$DBH/min(BCI_CHEC$DBH)
length(x_CHEC)
x_CHEC_dbh = seq(min(x_CHEC),max(x_CHEC),length=10*length(x_CHEC))
result_CHEC = subset(result_bci_sp_all,Latin=="Chrysochlamys eclipes")

plot(sort(x_CHEC, decreasing=TRUE), 1:length(x_CHEC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CHEC), max(x_CHEC)), ylim = c(1, length(x_CHEC)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CHEC = function(x){
  b_pop = result_CHEC$b_pmete
  n_pop = result_CHEC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CHEC = function(x){
  b_pop = 2
  n_pop = result_CHEC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CHEC = function(x){
  al_pop = result_CHEC$p1_qwei
  be_pop = result_CHEC$p2_qwei
  ga_pop = result_CHEC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CHEC_PMETE = (1-cumsum(fx_CHEC(x_CHEC_dbh)*(max(x_CHEC)-min(x_CHEC))/length(x_CHEC_dbh)))*length(x_CHEC) # parametrized mete prediction
y_CHEC_METE = (1-cumsum(gx_CHEC(x_CHEC_dbh)*(max(x_CHEC)-min(x_CHEC))/length(x_CHEC_dbh)))*length(x_CHEC) # mete prediction
y_CHEC_EXP = exp(-(result_CHEC$p_exp)*(x_CHEC_dbh-min(x_CHEC_dbh)))*length(x_CHEC)  # exponential distribution
y_CHEC_POW = ((x_CHEC_dbh)^(-(result_CHEC$p_pow)))*length(x_CHEC) # power function distribution
y_CHEC_WEI = (exp(1/((result_CHEC$p1_wei)^(result_CHEC$p2_wei))-(x_CHEC_dbh/(result_CHEC$p1_wei))^(result_CHEC$p2_wei)))*length(x_CHEC) # Weibull distribution
y_CHEC_QWEI = (1-cumsum(qwei_CHEC(x_CHEC_dbh)*(max(x_CHEC)-min(x_CHEC))/length(x_CHEC_dbh)))*length(x_CHEC) # quasi_Weibull distribution

lines(x_CHEC_dbh, y_CHEC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CHEC_dbh, y_CHEC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CHEC_dbh, y_CHEC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CHEC_dbh, y_CHEC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CHEC_dbh, y_CHEC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CHEC_dbh, y_CHEC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CHEC", bty="n",cex=1.5)

#### Croton billbergianus
BCI_CRBI = subset(bci_2015_live,Latin=="Croton billbergianus")
x_CRBI = BCI_CRBI$DBH/min(BCI_CRBI$DBH)
length(x_CRBI)
x_CRBI_dbh = seq(min(x_CRBI),max(x_CRBI),length=10*length(x_CRBI))
result_CRBI = subset(result_bci_sp_all,Latin=="Croton billbergianus")

plot(sort(x_CRBI, decreasing=TRUE), 1:length(x_CRBI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CRBI), max(x_CRBI)), ylim = c(1, length(x_CRBI)),cex=2,cex.axis=1.5,cex.lab=1)

fx_CRBI = function(x){
  b_pop = result_CRBI$b_pmete
  n_pop = result_CRBI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CRBI = function(x){
  b_pop = 2
  n_pop = result_CRBI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CRBI = function(x){
  al_pop = result_CRBI$p1_qwei
  be_pop = result_CRBI$p2_qwei
  ga_pop = result_CRBI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CRBI_PMETE = (1-cumsum(fx_CRBI(x_CRBI_dbh)*(max(x_CRBI)-min(x_CRBI))/length(x_CRBI_dbh)))*length(x_CRBI) # parametrized mete prediction
y_CRBI_METE = (1-cumsum(gx_CRBI(x_CRBI_dbh)*(max(x_CRBI)-min(x_CRBI))/length(x_CRBI_dbh)))*length(x_CRBI) # mete prediction
y_CRBI_EXP = exp(-(result_CRBI$p_exp)*(x_CRBI_dbh-min(x_CRBI_dbh)))*length(x_CRBI)  # exponential distribution
y_CRBI_POW = ((x_CRBI_dbh)^(-(result_CRBI$p_pow)))*length(x_CRBI) # power function distribution
y_CRBI_WEI = (exp(1/((result_CRBI$p1_wei)^(result_CRBI$p2_wei))-(x_CRBI_dbh/(result_CRBI$p1_wei))^(result_CRBI$p2_wei)))*length(x_CRBI) # Weibull distribution
y_CRBI_QWEI = (1-cumsum(qwei_CRBI(x_CRBI_dbh)*(max(x_CRBI)-min(x_CRBI))/length(x_CRBI_dbh)))*length(x_CRBI) # quasi_Weibull distribution

lines(x_CRBI_dbh, y_CRBI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CRBI_dbh, y_CRBI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CRBI_dbh, y_CRBI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CRBI_dbh, y_CRBI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CRBI_dbh, y_CRBI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CRBI_dbh, y_CRBI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CRBI", bty="n",cex=1.5)

#### Drypetes standleyi
BCI_DRST = subset(bci_2015_live,Latin=="Drypetes standleyi")
x_DRST = BCI_DRST$DBH/min(BCI_DRST$DBH)
length(x_DRST)
x_DRST_dbh = seq(min(x_DRST),max(x_DRST),length=10*length(x_DRST))
result_DRST = subset(result_bci_sp_all,Latin=="Drypetes standleyi")

plot(sort(x_DRST, decreasing=TRUE), 1:length(x_DRST), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_DRST), max(x_DRST)), ylim = c(1, length(x_DRST)),cex=2,cex.axis=1.5,cex.lab=1)

fx_DRST = function(x){
  b_pop = result_DRST$b_pmete
  n_pop = result_DRST$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_DRST = function(x){
  b_pop = 2
  n_pop = result_DRST$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_DRST = function(x){
  al_pop = result_DRST$p1_qwei
  be_pop = result_DRST$p2_qwei
  ga_pop = result_DRST$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_DRST_PMETE = (1-cumsum(fx_DRST(x_DRST_dbh)*(max(x_DRST)-min(x_DRST))/length(x_DRST_dbh)))*length(x_DRST) # parametrized mete prediction
y_DRST_METE = (1-cumsum(gx_DRST(x_DRST_dbh)*(max(x_DRST)-min(x_DRST))/length(x_DRST_dbh)))*length(x_DRST) # mete prediction
y_DRST_EXP = exp(-(result_DRST$p_exp)*(x_DRST_dbh-min(x_DRST_dbh)))*length(x_DRST)  # exponential distribution
y_DRST_POW = ((x_DRST_dbh)^(-(result_DRST$p_pow)))*length(x_DRST) # power function distribution
y_DRST_WEI = (exp(1/((result_DRST$p1_wei)^(result_DRST$p2_wei))-(x_DRST_dbh/(result_DRST$p1_wei))^(result_DRST$p2_wei)))*length(x_DRST) # Weibull distribution
y_DRST_QWEI = (1-cumsum(qwei_DRST(x_DRST_dbh)*(max(x_DRST)-min(x_DRST))/length(x_DRST_dbh)))*length(x_DRST) # quasi_Weibull distribution

lines(x_DRST_dbh, y_DRST_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_DRST_dbh, y_DRST_METE, col="#999999",lwd=2) #, lty=5)
lines(x_DRST_dbh, y_DRST_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_DRST_dbh, y_DRST_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_DRST_dbh, y_DRST_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_DRST_dbh, y_DRST_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "DRST", bty="n",cex=1.5)

#### Erythroxylum macrophyllum
BCI_ERMA = subset(bci_2015_live,Latin=="Erythroxylum macrophyllum")
x_ERMA = BCI_ERMA$DBH/min(BCI_ERMA$DBH)
length(x_ERMA)
x_ERMA_dbh = seq(min(x_ERMA),max(x_ERMA),length=10*length(x_ERMA))
result_ERMA = subset(result_bci_sp_all,Latin=="Erythroxylum macrophyllum")

plot(sort(x_ERMA, decreasing=TRUE), 1:length(x_ERMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ERMA), max(x_ERMA)), ylim = c(1, length(x_ERMA)),cex=2,cex.axis=1.5,cex.lab=1)

fx_ERMA = function(x){
  b_pop = result_ERMA$b_pmete
  n_pop = result_ERMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ERMA = function(x){
  b_pop = 2
  n_pop = result_ERMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ERMA = function(x){
  al_pop = result_ERMA$p1_qwei
  be_pop = result_ERMA$p2_qwei
  ga_pop = result_ERMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ERMA_PMETE = (1-cumsum(fx_ERMA(x_ERMA_dbh)*(max(x_ERMA)-min(x_ERMA))/length(x_ERMA_dbh)))*length(x_ERMA) # parametrized mete prediction
y_ERMA_METE = (1-cumsum(gx_ERMA(x_ERMA_dbh)*(max(x_ERMA)-min(x_ERMA))/length(x_ERMA_dbh)))*length(x_ERMA) # mete prediction
y_ERMA_EXP = exp(-(result_ERMA$p_exp)*(x_ERMA_dbh-min(x_ERMA_dbh)))*length(x_ERMA)  # exponential distribution
y_ERMA_POW = ((x_ERMA_dbh)^(-(result_ERMA$p_pow)))*length(x_ERMA) # power function distribution
y_ERMA_WEI = (exp(1/((result_ERMA$p1_wei)^(result_ERMA$p2_wei))-(x_ERMA_dbh/(result_ERMA$p1_wei))^(result_ERMA$p2_wei)))*length(x_ERMA) # Weibull distribution
y_ERMA_QWEI = (1-cumsum(qwei_ERMA(x_ERMA_dbh)*(max(x_ERMA)-min(x_ERMA))/length(x_ERMA_dbh)))*length(x_ERMA) # quasi_Weibull distribution

lines(x_ERMA_dbh, y_ERMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ERMA_dbh, y_ERMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ERMA_dbh, y_ERMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ERMA_dbh, y_ERMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ERMA_dbh, y_ERMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ERMA_dbh, y_ERMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ERMA", bty="n",cex=1.5)

#### Erythroxylum panamense
BCI_ERPA = subset(bci_2015_live,Latin=="Erythroxylum panamense")
x_ERPA = BCI_ERPA$DBH/min(BCI_ERPA$DBH)
length(x_ERPA)
x_ERPA_dbh = seq(min(x_ERPA),max(x_ERPA),length=10*length(x_ERPA))
result_ERPA = subset(result_bci_sp_all,Latin=="Erythroxylum panamense")

plot(sort(x_ERPA, decreasing=TRUE), 1:length(x_ERPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ERPA), max(x_ERPA)), ylim = c(1, length(x_ERPA)),cex=2,cex.axis=1.5,cex.lab=1)

fx_ERPA = function(x){
  b_pop = result_ERPA$b_pmete
  n_pop = result_ERPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ERPA = function(x){
  b_pop = 2
  n_pop = result_ERPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ERPA = function(x){
  al_pop = result_ERPA$p1_qwei
  be_pop = result_ERPA$p2_qwei
  ga_pop = result_ERPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ERPA_PMETE = (1-cumsum(fx_ERPA(x_ERPA_dbh)*(max(x_ERPA)-min(x_ERPA))/length(x_ERPA_dbh)))*length(x_ERPA) # parametrized mete prediction
y_ERPA_METE = (1-cumsum(gx_ERPA(x_ERPA_dbh)*(max(x_ERPA)-min(x_ERPA))/length(x_ERPA_dbh)))*length(x_ERPA) # mete prediction
y_ERPA_EXP = exp(-(result_ERPA$p_exp)*(x_ERPA_dbh-min(x_ERPA_dbh)))*length(x_ERPA)  # exponential distribution
y_ERPA_POW = ((x_ERPA_dbh)^(-(result_ERPA$p_pow)))*length(x_ERPA) # power function distribution
y_ERPA_WEI = (exp(1/((result_ERPA$p1_wei)^(result_ERPA$p2_wei))-(x_ERPA_dbh/(result_ERPA$p1_wei))^(result_ERPA$p2_wei)))*length(x_ERPA) # Weibull distribution
y_ERPA_QWEI = (1-cumsum(qwei_ERPA(x_ERPA_dbh)*(max(x_ERPA)-min(x_ERPA))/length(x_ERPA_dbh)))*length(x_ERPA) # quasi_Weibull distribution

lines(x_ERPA_dbh, y_ERPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ERPA_dbh, y_ERPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ERPA_dbh, y_ERPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ERPA_dbh, y_ERPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ERPA_dbh, y_ERPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ERPA_dbh, y_ERPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ERPA", bty="n",cex=1.5)

#### Garcinia intermedia
BCI_GAIN = subset(bci_2015_live,Latin=="Garcinia intermedia")
x_GAIN = BCI_GAIN$DBH/min(BCI_GAIN$DBH)
length(x_GAIN)
x_GAIN_dbh = seq(min(x_GAIN),max(x_GAIN),length=10*length(x_GAIN))
result_GAIN = subset(result_bci_sp_all,Latin=="Garcinia intermedia")

plot(sort(x_GAIN, decreasing=TRUE), 1:length(x_GAIN), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GAIN), max(x_GAIN)), ylim = c(1, length(x_GAIN)),cex=2,cex.axis=1.5,cex.lab=1)

fx_GAIN = function(x){
  b_pop = result_GAIN$b_pmete
  n_pop = result_GAIN$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GAIN = function(x){
  b_pop = 2
  n_pop = result_GAIN$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GAIN = function(x){
  al_pop = result_GAIN$p1_qwei
  be_pop = result_GAIN$p2_qwei
  ga_pop = result_GAIN$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GAIN_PMETE = (1-cumsum(fx_GAIN(x_GAIN_dbh)*(max(x_GAIN)-min(x_GAIN))/length(x_GAIN_dbh)))*length(x_GAIN) # parametrized mete prediction
y_GAIN_METE = (1-cumsum(gx_GAIN(x_GAIN_dbh)*(max(x_GAIN)-min(x_GAIN))/length(x_GAIN_dbh)))*length(x_GAIN) # mete prediction
y_GAIN_EXP = exp(-(result_GAIN$p_exp)*(x_GAIN_dbh-min(x_GAIN_dbh)))*length(x_GAIN)  # exponential distribution
y_GAIN_POW = ((x_GAIN_dbh)^(-(result_GAIN$p_pow)))*length(x_GAIN) # power function distribution
y_GAIN_WEI = (exp(1/((result_GAIN$p1_wei)^(result_GAIN$p2_wei))-(x_GAIN_dbh/(result_GAIN$p1_wei))^(result_GAIN$p2_wei)))*length(x_GAIN) # Weibull distribution
y_GAIN_QWEI = (1-cumsum(qwei_GAIN(x_GAIN_dbh)*(max(x_GAIN)-min(x_GAIN))/length(x_GAIN_dbh)))*length(x_GAIN) # quasi_Weibull distribution

lines(x_GAIN_dbh, y_GAIN_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GAIN_dbh, y_GAIN_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GAIN_dbh, y_GAIN_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GAIN_dbh, y_GAIN_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GAIN_dbh, y_GAIN_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GAIN_dbh, y_GAIN_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GAIN", bty="n",cex=1.5)

#### Garcinia madruno
BCI_GAMA = subset(bci_2015_live,Latin=="Garcinia madruno")
x_GAMA = BCI_GAMA$DBH/min(BCI_GAMA$DBH)
length(x_GAMA)
x_GAMA_dbh = seq(min(x_GAMA),max(x_GAMA),length=10*length(x_GAMA))
result_GAMA = subset(result_bci_sp_all,Latin=="Garcinia madruno")

plot(sort(x_GAMA, decreasing=TRUE), 1:length(x_GAMA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GAMA), max(x_GAMA)), ylim = c(1, length(x_GAMA)),cex=2,cex.axis=1.5,cex.lab=1)

fx_GAMA = function(x){
  b_pop = result_GAMA$b_pmete
  n_pop = result_GAMA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GAMA = function(x){
  b_pop = 2
  n_pop = result_GAMA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GAMA = function(x){
  al_pop = result_GAMA$p1_qwei
  be_pop = result_GAMA$p2_qwei
  ga_pop = result_GAMA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GAMA_PMETE = (1-cumsum(fx_GAMA(x_GAMA_dbh)*(max(x_GAMA)-min(x_GAMA))/length(x_GAMA_dbh)))*length(x_GAMA) # parametrized mete prediction
y_GAMA_METE = (1-cumsum(gx_GAMA(x_GAMA_dbh)*(max(x_GAMA)-min(x_GAMA))/length(x_GAMA_dbh)))*length(x_GAMA) # mete prediction
y_GAMA_EXP = exp(-(result_GAMA$p_exp)*(x_GAMA_dbh-min(x_GAMA_dbh)))*length(x_GAMA)  # exponential distribution
y_GAMA_POW = ((x_GAMA_dbh)^(-(result_GAMA$p_pow)))*length(x_GAMA) # power function distribution
y_GAMA_WEI = (exp(1/((result_GAMA$p1_wei)^(result_GAMA$p2_wei))-(x_GAMA_dbh/(result_GAMA$p1_wei))^(result_GAMA$p2_wei)))*length(x_GAMA) # Weibull distribution
y_GAMA_QWEI = (1-cumsum(qwei_GAMA(x_GAMA_dbh)*(max(x_GAMA)-min(x_GAMA))/length(x_GAMA_dbh)))*length(x_GAMA) # quasi_Weibull distribution

lines(x_GAMA_dbh, y_GAMA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GAMA_dbh, y_GAMA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GAMA_dbh, y_GAMA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GAMA_dbh, y_GAMA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GAMA_dbh, y_GAMA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GAMA_dbh, y_GAMA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GAMA", bty="n",cex=1.5)

#### Hasseltia floribunda
BCI_HAFL = subset(bci_2015_live,Latin=="Hasseltia floribunda")
x_HAFL = BCI_HAFL$DBH/min(BCI_HAFL$DBH)
length(x_HAFL)
x_HAFL_dbh = seq(min(x_HAFL),max(x_HAFL),length=10*length(x_HAFL))
result_HAFL = subset(result_bci_sp_all,Latin=="Hasseltia floribunda")

plot(sort(x_HAFL, decreasing=TRUE), 1:length(x_HAFL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HAFL), max(x_HAFL)), ylim = c(1, length(x_HAFL)),cex=2,cex.axis=1.5,cex.lab=1)

fx_HAFL = function(x){
  b_pop = result_HAFL$b_pmete
  n_pop = result_HAFL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HAFL = function(x){
  b_pop = 2
  n_pop = result_HAFL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HAFL = function(x){
  al_pop = result_HAFL$p1_qwei
  be_pop = result_HAFL$p2_qwei
  ga_pop = result_HAFL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HAFL_PMETE = (1-cumsum(fx_HAFL(x_HAFL_dbh)*(max(x_HAFL)-min(x_HAFL))/length(x_HAFL_dbh)))*length(x_HAFL) # parametrized mete prediction
y_HAFL_METE = (1-cumsum(gx_HAFL(x_HAFL_dbh)*(max(x_HAFL)-min(x_HAFL))/length(x_HAFL_dbh)))*length(x_HAFL) # mete prediction
y_HAFL_EXP = exp(-(result_HAFL$p_exp)*(x_HAFL_dbh-min(x_HAFL_dbh)))*length(x_HAFL)  # exponential distribution
y_HAFL_POW = ((x_HAFL_dbh)^(-(result_HAFL$p_pow)))*length(x_HAFL) # power function distribution
y_HAFL_WEI = (exp(1/((result_HAFL$p1_wei)^(result_HAFL$p2_wei))-(x_HAFL_dbh/(result_HAFL$p1_wei))^(result_HAFL$p2_wei)))*length(x_HAFL) # Weibull distribution
y_HAFL_QWEI = (1-cumsum(qwei_HAFL(x_HAFL_dbh)*(max(x_HAFL)-min(x_HAFL))/length(x_HAFL_dbh)))*length(x_HAFL) # quasi_Weibull distribution

lines(x_HAFL_dbh, y_HAFL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HAFL_dbh, y_HAFL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HAFL_dbh, y_HAFL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HAFL_dbh, y_HAFL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HAFL_dbh, y_HAFL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HAFL_dbh, y_HAFL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HAFL", bty="n",cex=1.5)

#### Hieronyma alchorneoides
BCI_HIAL = subset(bci_2015_live,Latin=="Hieronyma alchorneoides")
x_HIAL = BCI_HIAL$DBH/min(BCI_HIAL$DBH)
length(x_HIAL)
x_HIAL_dbh = seq(min(x_HIAL),max(x_HIAL),length=10*length(x_HIAL))
result_HIAL = subset(result_bci_sp_all,Latin=="Hieronyma alchorneoides")

plot(sort(x_HIAL, decreasing=TRUE), 1:length(x_HIAL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HIAL), max(x_HIAL)), ylim = c(1, length(x_HIAL)),cex=2,cex.axis=1.5,cex.lab=1)

fx_HIAL = function(x){
  b_pop = result_HIAL$b_pmete
  n_pop = result_HIAL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HIAL = function(x){
  b_pop = 2
  n_pop = result_HIAL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HIAL = function(x){
  al_pop = result_HIAL$p1_qwei
  be_pop = result_HIAL$p2_qwei
  ga_pop = result_HIAL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HIAL_PMETE = (1-cumsum(fx_HIAL(x_HIAL_dbh)*(max(x_HIAL)-min(x_HIAL))/length(x_HIAL_dbh)))*length(x_HIAL) # parametrized mete prediction
y_HIAL_METE = (1-cumsum(gx_HIAL(x_HIAL_dbh)*(max(x_HIAL)-min(x_HIAL))/length(x_HIAL_dbh)))*length(x_HIAL) # mete prediction
y_HIAL_EXP = exp(-(result_HIAL$p_exp)*(x_HIAL_dbh-min(x_HIAL_dbh)))*length(x_HIAL)  # exponential distribution
y_HIAL_POW = ((x_HIAL_dbh)^(-(result_HIAL$p_pow)))*length(x_HIAL) # power function distribution
y_HIAL_WEI = (exp(1/((result_HIAL$p1_wei)^(result_HIAL$p2_wei))-(x_HIAL_dbh/(result_HIAL$p1_wei))^(result_HIAL$p2_wei)))*length(x_HIAL) # Weibull distribution
y_HIAL_QWEI = (1-cumsum(qwei_HIAL(x_HIAL_dbh)*(max(x_HIAL)-min(x_HIAL))/length(x_HIAL_dbh)))*length(x_HIAL) # quasi_Weibull distribution

lines(x_HIAL_dbh, y_HIAL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HIAL_dbh, y_HIAL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HIAL_dbh, y_HIAL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HIAL_dbh, y_HIAL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HIAL_dbh, y_HIAL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HIAL_dbh, y_HIAL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HIAL", bty="n",cex=1.5)

#### Hirtella triandra
BCI_HITR = subset(bci_2015_live,Latin=="Hirtella triandra")
x_HITR = BCI_HITR$DBH/min(BCI_HITR$DBH)
length(x_HITR)
x_HITR_dbh = seq(min(x_HITR),max(x_HITR),length=10*length(x_HITR))
result_HITR = subset(result_bci_sp_all,Latin=="Hirtella triandra")

plot(sort(x_HITR, decreasing=TRUE), 1:length(x_HITR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HITR), max(x_HITR)), ylim = c(1, length(x_HITR)),cex=2,cex.axis=1.5,cex.lab=1)

fx_HITR = function(x){
  b_pop = result_HITR$b_pmete
  n_pop = result_HITR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HITR = function(x){
  b_pop = 2
  n_pop = result_HITR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HITR = function(x){
  al_pop = result_HITR$p1_qwei
  be_pop = result_HITR$p2_qwei
  ga_pop = result_HITR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HITR_PMETE = (1-cumsum(fx_HITR(x_HITR_dbh)*(max(x_HITR)-min(x_HITR))/length(x_HITR_dbh)))*length(x_HITR) # parametrized mete prediction
y_HITR_METE = (1-cumsum(gx_HITR(x_HITR_dbh)*(max(x_HITR)-min(x_HITR))/length(x_HITR_dbh)))*length(x_HITR) # mete prediction
y_HITR_EXP = exp(-(result_HITR$p_exp)*(x_HITR_dbh-min(x_HITR_dbh)))*length(x_HITR)  # exponential distribution
y_HITR_POW = ((x_HITR_dbh)^(-(result_HITR$p_pow)))*length(x_HITR) # power function distribution
y_HITR_WEI = (exp(1/((result_HITR$p1_wei)^(result_HITR$p2_wei))-(x_HITR_dbh/(result_HITR$p1_wei))^(result_HITR$p2_wei)))*length(x_HITR) # Weibull distribution
y_HITR_QWEI = (1-cumsum(qwei_HITR(x_HITR_dbh)*(max(x_HITR)-min(x_HITR))/length(x_HITR_dbh)))*length(x_HITR) # quasi_Weibull distribution

lines(x_HITR_dbh, y_HITR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HITR_dbh, y_HITR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HITR_dbh, y_HITR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HITR_dbh, y_HITR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HITR_dbh, y_HITR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HITR_dbh, y_HITR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HITR", bty="n",cex=1.5)

#### Hybanthus prunifolius
BCI_HYPR = subset(bci_2015_live,Latin=="Hybanthus prunifolius")
x_HYPR = BCI_HYPR$DBH/min(BCI_HYPR$DBH)
length(x_HYPR)
x_HYPR_dbh = seq(min(x_HYPR),max(x_HYPR),length=10*length(x_HYPR))
result_HYPR = subset(result_bci_sp_all,Latin=="Hybanthus prunifolius")

plot(sort(x_HYPR, decreasing=TRUE), 1:length(x_HYPR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HYPR), max(x_HYPR)), ylim = c(1, length(x_HYPR)),cex=2,cex.axis=1.5,cex.lab=1)

fx_HYPR = function(x){
  b_pop = result_HYPR$b_pmete
  n_pop = result_HYPR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HYPR = function(x){
  b_pop = 2
  n_pop = result_HYPR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HYPR = function(x){
  al_pop = result_HYPR$p1_qwei
  be_pop = result_HYPR$p2_qwei
  ga_pop = result_HYPR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HYPR_PMETE = (1-cumsum(fx_HYPR(x_HYPR_dbh)*(max(x_HYPR)-min(x_HYPR))/length(x_HYPR_dbh)))*length(x_HYPR) # parametrized mete prediction
y_HYPR_METE = (1-cumsum(gx_HYPR(x_HYPR_dbh)*(max(x_HYPR)-min(x_HYPR))/length(x_HYPR_dbh)))*length(x_HYPR) # mete prediction
y_HYPR_EXP = exp(-(result_HYPR$p_exp)*(x_HYPR_dbh-min(x_HYPR_dbh)))*length(x_HYPR)  # exponential distribution
y_HYPR_POW = ((x_HYPR_dbh)^(-(result_HYPR$p_pow)))*length(x_HYPR) # power function distribution
y_HYPR_WEI = (exp(1/((result_HYPR$p1_wei)^(result_HYPR$p2_wei))-(x_HYPR_dbh/(result_HYPR$p1_wei))^(result_HYPR$p2_wei)))*length(x_HYPR) # Weibull distribution
y_HYPR_QWEI = (1-cumsum(qwei_HYPR(x_HYPR_dbh)*(max(x_HYPR)-min(x_HYPR))/length(x_HYPR_dbh)))*length(x_HYPR) # quasi_Weibull distribution

lines(x_HYPR_dbh, y_HYPR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HYPR_dbh, y_HYPR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HYPR_dbh, y_HYPR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HYPR_dbh, y_HYPR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HYPR_dbh, y_HYPR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HYPR_dbh, y_HYPR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HYPR", bty="n",cex=1.5)

#### Lacistema aggregatum
BCI_LAAG = subset(bci_2015_live,Latin=="Lacistema aggregatum")
x_LAAG = BCI_LAAG$DBH/min(BCI_LAAG$DBH)
length(x_LAAG)
x_LAAG_dbh = seq(min(x_LAAG),max(x_LAAG),length=10*length(x_LAAG))
result_LAAG = subset(result_bci_sp_all,Latin=="Lacistema aggregatum")

plot(sort(x_LAAG, decreasing=TRUE), 1:length(x_LAAG), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LAAG), max(x_LAAG)), ylim = c(1, length(x_LAAG)),cex=2,cex.axis=1.5,cex.lab=1)

fx_LAAG = function(x){
  b_pop = result_LAAG$b_pmete
  n_pop = result_LAAG$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LAAG = function(x){
  b_pop = 2
  n_pop = result_LAAG$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LAAG = function(x){
  al_pop = result_LAAG$p1_qwei
  be_pop = result_LAAG$p2_qwei
  ga_pop = result_LAAG$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LAAG_PMETE = (1-cumsum(fx_LAAG(x_LAAG_dbh)*(max(x_LAAG)-min(x_LAAG))/length(x_LAAG_dbh)))*length(x_LAAG) # parametrized mete prediction
y_LAAG_METE = (1-cumsum(gx_LAAG(x_LAAG_dbh)*(max(x_LAAG)-min(x_LAAG))/length(x_LAAG_dbh)))*length(x_LAAG) # mete prediction
y_LAAG_EXP = exp(-(result_LAAG$p_exp)*(x_LAAG_dbh-min(x_LAAG_dbh)))*length(x_LAAG)  # exponential distribution
y_LAAG_POW = ((x_LAAG_dbh)^(-(result_LAAG$p_pow)))*length(x_LAAG) # power function distribution
y_LAAG_WEI = (exp(1/((result_LAAG$p1_wei)^(result_LAAG$p2_wei))-(x_LAAG_dbh/(result_LAAG$p1_wei))^(result_LAAG$p2_wei)))*length(x_LAAG) # Weibull distribution
y_LAAG_QWEI = (1-cumsum(qwei_LAAG(x_LAAG_dbh)*(max(x_LAAG)-min(x_LAAG))/length(x_LAAG_dbh)))*length(x_LAAG) # quasi_Weibull distribution

lines(x_LAAG_dbh, y_LAAG_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LAAG_dbh, y_LAAG_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LAAG_dbh, y_LAAG_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LAAG_dbh, y_LAAG_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LAAG_dbh, y_LAAG_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LAAG_dbh, y_LAAG_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LAAG", bty="n",cex=1.5)

#### Laetia thamnia
BCI_LATH = subset(bci_2015_live,Latin=="Laetia thamnia")
x_LATH = BCI_LATH$DBH/min(BCI_LATH$DBH)
length(x_LATH)
x_LATH_dbh = seq(min(x_LATH),max(x_LATH),length=10*length(x_LATH))
result_LATH = subset(result_bci_sp_all,Latin=="Laetia thamnia")

plot(sort(x_LATH, decreasing=TRUE), 1:length(x_LATH), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LATH), max(x_LATH)), ylim = c(1, length(x_LATH)),cex=2,cex.axis=1.5,cex.lab=1)

fx_LATH = function(x){
  b_pop = result_LATH$b_pmete
  n_pop = result_LATH$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LATH = function(x){
  b_pop = 2
  n_pop = result_LATH$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LATH = function(x){
  al_pop = result_LATH$p1_qwei
  be_pop = result_LATH$p2_qwei
  ga_pop = result_LATH$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LATH_PMETE = (1-cumsum(fx_LATH(x_LATH_dbh)*(max(x_LATH)-min(x_LATH))/length(x_LATH_dbh)))*length(x_LATH) # parametrized mete prediction
y_LATH_METE = (1-cumsum(gx_LATH(x_LATH_dbh)*(max(x_LATH)-min(x_LATH))/length(x_LATH_dbh)))*length(x_LATH) # mete prediction
y_LATH_EXP = exp(-(result_LATH$p_exp)*(x_LATH_dbh-min(x_LATH_dbh)))*length(x_LATH)  # exponential distribution
y_LATH_POW = ((x_LATH_dbh)^(-(result_LATH$p_pow)))*length(x_LATH) # power function distribution
y_LATH_WEI = (exp(1/((result_LATH$p1_wei)^(result_LATH$p2_wei))-(x_LATH_dbh/(result_LATH$p1_wei))^(result_LATH$p2_wei)))*length(x_LATH) # Weibull distribution
y_LATH_QWEI = (1-cumsum(qwei_LATH(x_LATH_dbh)*(max(x_LATH)-min(x_LATH))/length(x_LATH_dbh)))*length(x_LATH) # quasi_Weibull distribution

lines(x_LATH_dbh, y_LATH_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LATH_dbh, y_LATH_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LATH_dbh, y_LATH_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LATH_dbh, y_LATH_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LATH_dbh, y_LATH_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LATH_dbh, y_LATH_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LATH", bty="n",cex=1.5)

#### Licania hypoleuca
BCI_LIHY = subset(bci_2015_live,Latin=="Licania hypoleuca")
x_LIHY = BCI_LIHY$DBH/min(BCI_LIHY$DBH)
length(x_LIHY)
x_LIHY_dbh = seq(min(x_LIHY),max(x_LIHY),length=10*length(x_LIHY))
result_LIHY = subset(result_bci_sp_all,Latin=="Licania hypoleuca")

plot(sort(x_LIHY, decreasing=TRUE), 1:length(x_LIHY), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LIHY), max(x_LIHY)), ylim = c(1, length(x_LIHY)),cex=2,cex.axis=1.5,cex.lab=1)

fx_LIHY = function(x){
  b_pop = result_LIHY$b_pmete
  n_pop = result_LIHY$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LIHY = function(x){
  b_pop = 2
  n_pop = result_LIHY$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LIHY = function(x){
  al_pop = result_LIHY$p1_qwei
  be_pop = result_LIHY$p2_qwei
  ga_pop = result_LIHY$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LIHY_PMETE = (1-cumsum(fx_LIHY(x_LIHY_dbh)*(max(x_LIHY)-min(x_LIHY))/length(x_LIHY_dbh)))*length(x_LIHY) # parametrized mete prediction
y_LIHY_METE = (1-cumsum(gx_LIHY(x_LIHY_dbh)*(max(x_LIHY)-min(x_LIHY))/length(x_LIHY_dbh)))*length(x_LIHY) # mete prediction
y_LIHY_EXP = exp(-(result_LIHY$p_exp)*(x_LIHY_dbh-min(x_LIHY_dbh)))*length(x_LIHY)  # exponential distribution
y_LIHY_POW = ((x_LIHY_dbh)^(-(result_LIHY$p_pow)))*length(x_LIHY) # power function distribution
y_LIHY_WEI = (exp(1/((result_LIHY$p1_wei)^(result_LIHY$p2_wei))-(x_LIHY_dbh/(result_LIHY$p1_wei))^(result_LIHY$p2_wei)))*length(x_LIHY) # Weibull distribution
y_LIHY_QWEI = (1-cumsum(qwei_LIHY(x_LIHY_dbh)*(max(x_LIHY)-min(x_LIHY))/length(x_LIHY_dbh)))*length(x_LIHY) # quasi_Weibull distribution

lines(x_LIHY_dbh, y_LIHY_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LIHY_dbh, y_LIHY_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LIHY_dbh, y_LIHY_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LIHY_dbh, y_LIHY_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LIHY_dbh, y_LIHY_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LIHY_dbh, y_LIHY_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LIHY", bty="n",cex=1.5)

#### Licania platypus
BCI_LIPL = subset(bci_2015_live,Latin=="Licania platypus")
x_LIPL = BCI_LIPL$DBH/min(BCI_LIPL$DBH)
length(x_LIPL)
x_LIPL_dbh = seq(min(x_LIPL),max(x_LIPL),length=10*length(x_LIPL))
result_LIPL = subset(result_bci_sp_all,Latin=="Licania platypus")

plot(sort(x_LIPL, decreasing=TRUE), 1:length(x_LIPL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LIPL), max(x_LIPL)), ylim = c(1, length(x_LIPL)),cex=2,cex.axis=1.5,cex.lab=1)

fx_LIPL = function(x){
  b_pop = result_LIPL$b_pmete
  n_pop = result_LIPL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LIPL = function(x){
  b_pop = 2
  n_pop = result_LIPL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LIPL = function(x){
  al_pop = result_LIPL$p1_qwei
  be_pop = result_LIPL$p2_qwei
  ga_pop = result_LIPL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LIPL_PMETE = (1-cumsum(fx_LIPL(x_LIPL_dbh)*(max(x_LIPL)-min(x_LIPL))/length(x_LIPL_dbh)))*length(x_LIPL) # parametrized mete prediction
y_LIPL_METE = (1-cumsum(gx_LIPL(x_LIPL_dbh)*(max(x_LIPL)-min(x_LIPL))/length(x_LIPL_dbh)))*length(x_LIPL) # mete prediction
y_LIPL_EXP = exp(-(result_LIPL$p_exp)*(x_LIPL_dbh-min(x_LIPL_dbh)))*length(x_LIPL)  # exponential distribution
y_LIPL_POW = ((x_LIPL_dbh)^(-(result_LIPL$p_pow)))*length(x_LIPL) # power function distribution
y_LIPL_WEI = (exp(1/((result_LIPL$p1_wei)^(result_LIPL$p2_wei))-(x_LIPL_dbh/(result_LIPL$p1_wei))^(result_LIPL$p2_wei)))*length(x_LIPL) # Weibull distribution
y_LIPL_QWEI = (1-cumsum(qwei_LIPL(x_LIPL_dbh)*(max(x_LIPL)-min(x_LIPL))/length(x_LIPL_dbh)))*length(x_LIPL) # quasi_Weibull distribution

lines(x_LIPL_dbh, y_LIPL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LIPL_dbh, y_LIPL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LIPL_dbh, y_LIPL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LIPL_dbh, y_LIPL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LIPL_dbh, y_LIPL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LIPL_dbh, y_LIPL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LIPL", bty="n",cex=1.5)

#### Lindackeria laurina
BCI_LILA = subset(bci_2015_live,Latin=="Lindackeria laurina")
x_LILA = BCI_LILA$DBH/min(BCI_LILA$DBH)
length(x_LILA)
x_LILA_dbh = seq(min(x_LILA),max(x_LILA),length=10*length(x_LILA))
result_LILA = subset(result_bci_sp_all,Latin=="Lindackeria laurina")

plot(sort(x_LILA, decreasing=TRUE), 1:length(x_LILA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LILA), max(x_LILA)), ylim = c(1, length(x_LILA)),cex=2,cex.axis=1.5,cex.lab=1)

fx_LILA = function(x){
  b_pop = result_LILA$b_pmete
  n_pop = result_LILA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LILA = function(x){
  b_pop = 2
  n_pop = result_LILA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LILA = function(x){
  al_pop = result_LILA$p1_qwei
  be_pop = result_LILA$p2_qwei
  ga_pop = result_LILA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LILA_PMETE = (1-cumsum(fx_LILA(x_LILA_dbh)*(max(x_LILA)-min(x_LILA))/length(x_LILA_dbh)))*length(x_LILA) # parametrized mete prediction
y_LILA_METE = (1-cumsum(gx_LILA(x_LILA_dbh)*(max(x_LILA)-min(x_LILA))/length(x_LILA_dbh)))*length(x_LILA) # mete prediction
y_LILA_EXP = exp(-(result_LILA$p_exp)*(x_LILA_dbh-min(x_LILA_dbh)))*length(x_LILA)  # exponential distribution
y_LILA_POW = ((x_LILA_dbh)^(-(result_LILA$p_pow)))*length(x_LILA) # power function distribution
y_LILA_WEI = (exp(1/((result_LILA$p1_wei)^(result_LILA$p2_wei))-(x_LILA_dbh/(result_LILA$p1_wei))^(result_LILA$p2_wei)))*length(x_LILA) # Weibull distribution
y_LILA_QWEI = (1-cumsum(qwei_LILA(x_LILA_dbh)*(max(x_LILA)-min(x_LILA))/length(x_LILA_dbh)))*length(x_LILA) # quasi_Weibull distribution

lines(x_LILA_dbh, y_LILA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LILA_dbh, y_LILA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LILA_dbh, y_LILA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LILA_dbh, y_LILA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LILA_dbh, y_LILA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LILA_dbh, y_LILA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LILA", bty="n",cex=1.5)

#### Ouratea lucens
BCI_OULU = subset(bci_2015_live,Latin=="Ouratea lucens")
x_OULU = BCI_OULU$DBH/min(BCI_OULU$DBH)
length(x_OULU)
x_OULU_dbh = seq(min(x_OULU),max(x_OULU),length=10*length(x_OULU))
result_OULU = subset(result_bci_sp_all,Latin=="Ouratea lucens")

plot(sort(x_OULU, decreasing=TRUE), 1:length(x_OULU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_OULU), max(x_OULU)), ylim = c(1, length(x_OULU)),cex=2,cex.axis=1.5,cex.lab=1)

fx_OULU = function(x){
  b_pop = result_OULU$b_pmete
  n_pop = result_OULU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_OULU = function(x){
  b_pop = 2
  n_pop = result_OULU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_OULU = function(x){
  al_pop = result_OULU$p1_qwei
  be_pop = result_OULU$p2_qwei
  ga_pop = result_OULU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_OULU_PMETE = (1-cumsum(fx_OULU(x_OULU_dbh)*(max(x_OULU)-min(x_OULU))/length(x_OULU_dbh)))*length(x_OULU) # parametrized mete prediction
y_OULU_METE = (1-cumsum(gx_OULU(x_OULU_dbh)*(max(x_OULU)-min(x_OULU))/length(x_OULU_dbh)))*length(x_OULU) # mete prediction
y_OULU_EXP = exp(-(result_OULU$p_exp)*(x_OULU_dbh-min(x_OULU_dbh)))*length(x_OULU)  # exponential distribution
y_OULU_POW = ((x_OULU_dbh)^(-(result_OULU$p_pow)))*length(x_OULU) # power function distribution
y_OULU_WEI = (exp(1/((result_OULU$p1_wei)^(result_OULU$p2_wei))-(x_OULU_dbh/(result_OULU$p1_wei))^(result_OULU$p2_wei)))*length(x_OULU) # Weibull distribution
y_OULU_QWEI = (1-cumsum(qwei_OULU(x_OULU_dbh)*(max(x_OULU)-min(x_OULU))/length(x_OULU_dbh)))*length(x_OULU) # quasi_Weibull distribution

lines(x_OULU_dbh, y_OULU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_OULU_dbh, y_OULU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_OULU_dbh, y_OULU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_OULU_dbh, y_OULU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_OULU_dbh, y_OULU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_OULU_dbh, y_OULU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "OULU", bty="n",cex=1.5)

#### Rinorea sylvatica
BCI_RISY = subset(bci_2015_live,Latin=="Rinorea sylvatica")
x_RISY = BCI_RISY$DBH/min(BCI_RISY$DBH)
length(x_RISY)
x_RISY_dbh = seq(min(x_RISY),max(x_RISY),length=10*length(x_RISY))
result_RISY = subset(result_bci_sp_all,Latin=="Rinorea sylvatica")

plot(sort(x_RISY, decreasing=TRUE), 1:length(x_RISY), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_RISY), max(x_RISY)), ylim = c(1, length(x_RISY)),cex=2,cex.axis=1.5,cex.lab=1)

fx_RISY = function(x){
  b_pop = result_RISY$b_pmete
  n_pop = result_RISY$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_RISY = function(x){
  b_pop = 2
  n_pop = result_RISY$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_RISY = function(x){
  al_pop = result_RISY$p1_qwei
  be_pop = result_RISY$p2_qwei
  ga_pop = result_RISY$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_RISY_PMETE = (1-cumsum(fx_RISY(x_RISY_dbh)*(max(x_RISY)-min(x_RISY))/length(x_RISY_dbh)))*length(x_RISY) # parametrized mete prediction
y_RISY_METE = (1-cumsum(gx_RISY(x_RISY_dbh)*(max(x_RISY)-min(x_RISY))/length(x_RISY_dbh)))*length(x_RISY) # mete prediction
y_RISY_EXP = exp(-(result_RISY$p_exp)*(x_RISY_dbh-min(x_RISY_dbh)))*length(x_RISY)  # exponential distribution
y_RISY_POW = ((x_RISY_dbh)^(-(result_RISY$p_pow)))*length(x_RISY) # power function distribution
y_RISY_WEI = (exp(1/((result_RISY$p1_wei)^(result_RISY$p2_wei))-(x_RISY_dbh/(result_RISY$p1_wei))^(result_RISY$p2_wei)))*length(x_RISY) # Weibull distribution
y_RISY_QWEI = (1-cumsum(qwei_RISY(x_RISY_dbh)*(max(x_RISY)-min(x_RISY))/length(x_RISY_dbh)))*length(x_RISY) # quasi_Weibull distribution

lines(x_RISY_dbh, y_RISY_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_RISY_dbh, y_RISY_METE, col="#999999",lwd=2) #, lty=5)
lines(x_RISY_dbh, y_RISY_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_RISY_dbh, y_RISY_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_RISY_dbh, y_RISY_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_RISY_dbh, y_RISY_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RISY", bty="n",cex=1.5)

#### Symphonia globulifera
BCI_SYGL = subset(bci_2015_live,Latin=="Symphonia globulifera")
x_SYGL = BCI_SYGL$DBH/min(BCI_SYGL$DBH)
length(x_SYGL)
x_SYGL_dbh = seq(min(x_SYGL),max(x_SYGL),length=10*length(x_SYGL))
result_SYGL = subset(result_bci_sp_all,Latin=="Symphonia globulifera")

plot(sort(x_SYGL, decreasing=TRUE), 1:length(x_SYGL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SYGL), max(x_SYGL)), ylim = c(1, length(x_SYGL)),cex=2,cex.axis=1.5,cex.lab=1)

fx_SYGL = function(x){
  b_pop = result_SYGL$b_pmete
  n_pop = result_SYGL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SYGL = function(x){
  b_pop = 2
  n_pop = result_SYGL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SYGL = function(x){
  al_pop = result_SYGL$p1_qwei
  be_pop = result_SYGL$p2_qwei
  ga_pop = result_SYGL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SYGL_PMETE = (1-cumsum(fx_SYGL(x_SYGL_dbh)*(max(x_SYGL)-min(x_SYGL))/length(x_SYGL_dbh)))*length(x_SYGL) # parametrized mete prediction
y_SYGL_METE = (1-cumsum(gx_SYGL(x_SYGL_dbh)*(max(x_SYGL)-min(x_SYGL))/length(x_SYGL_dbh)))*length(x_SYGL) # mete prediction
y_SYGL_EXP = exp(-(result_SYGL$p_exp)*(x_SYGL_dbh-min(x_SYGL_dbh)))*length(x_SYGL)  # exponential distribution
y_SYGL_POW = ((x_SYGL_dbh)^(-(result_SYGL$p_pow)))*length(x_SYGL) # power function distribution
y_SYGL_WEI = (exp(1/((result_SYGL$p1_wei)^(result_SYGL$p2_wei))-(x_SYGL_dbh/(result_SYGL$p1_wei))^(result_SYGL$p2_wei)))*length(x_SYGL) # Weibull distribution
y_SYGL_QWEI = (1-cumsum(qwei_SYGL(x_SYGL_dbh)*(max(x_SYGL)-min(x_SYGL))/length(x_SYGL_dbh)))*length(x_SYGL) # quasi_Weibull distribution

lines(x_SYGL_dbh, y_SYGL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SYGL_dbh, y_SYGL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SYGL_dbh, y_SYGL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SYGL_dbh, y_SYGL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SYGL_dbh, y_SYGL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SYGL_dbh, y_SYGL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SYGL", bty="n",cex=1.5)
```
### BCI (Order=Malvales)
```{r}
par(mfrow=c(2,3),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Apeiba membranacea
BCI_APME = subset(bci_2015_live,Latin=="Apeiba membranacea")
x_APME = BCI_APME$DBH/min(BCI_APME$DBH)
length(x_APME)
x_APME_dbh = seq(min(x_APME),max(x_APME),length=10*length(x_APME))
result_APME = subset(result_bci_sp_all,Latin=="Apeiba membranacea")

plot(sort(x_APME, decreasing=TRUE), 1:length(x_APME), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_APME), max(x_APME)), ylim = c(1, length(x_APME)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_APME = function(x){
  b_pop = result_APME$b_pmete
  n_pop = result_APME$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_APME = function(x){
  b_pop = 2
  n_pop = result_APME$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_APME = function(x){
  al_pop = result_APME$p1_qwei
  be_pop = result_APME$p2_qwei
  ga_pop = result_APME$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_APME_PMETE = (1-cumsum(fx_APME(x_APME_dbh)*(max(x_APME)-min(x_APME))/length(x_APME_dbh)))*length(x_APME) # parametrized mete prediction
y_APME_METE = (1-cumsum(gx_APME(x_APME_dbh)*(max(x_APME)-min(x_APME))/length(x_APME_dbh)))*length(x_APME) # mete prediction
y_APME_EXP = exp(-(result_APME$p_exp)*(x_APME_dbh-min(x_APME_dbh)))*length(x_APME)  # exponential distribution
y_APME_POW = ((x_APME_dbh)^(-(result_APME$p_pow)))*length(x_APME) # power function distribution
y_APME_WEI = (exp(1/((result_APME$p1_wei)^(result_APME$p2_wei))-(x_APME_dbh/(result_APME$p1_wei))^(result_APME$p2_wei)))*length(x_APME) # Weibull distribution
y_APME_QWEI = (1-cumsum(qwei_APME(x_APME_dbh)*(max(x_APME)-min(x_APME))/length(x_APME_dbh)))*length(x_APME) # quasi_Weibull distribution

lines(x_APME_dbh, y_APME_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_APME_dbh, y_APME_METE, col="#999999",lwd=2) #, lty=5)
lines(x_APME_dbh, y_APME_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_APME_dbh, y_APME_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_APME_dbh, y_APME_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_APME_dbh, y_APME_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "APME", bty="n",cex=1.5)

#### Guazuma ulmifolia
BCI_GUUL = subset(bci_2015_live,Latin=="Guazuma ulmifolia")
x_GUUL = BCI_GUUL$DBH/min(BCI_GUUL$DBH)
length(x_GUUL)
x_GUUL_dbh = seq(min(x_GUUL),max(x_GUUL),length=10*length(x_GUUL))
result_GUUL = subset(result_bci_sp_all,Latin=="Guazuma ulmifolia")

plot(sort(x_GUUL, decreasing=TRUE), 1:length(x_GUUL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUUL), max(x_GUUL)), ylim = c(1, length(x_GUUL)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUUL = function(x){
  b_pop = result_GUUL$b_pmete
  n_pop = result_GUUL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUUL = function(x){
  b_pop = 2
  n_pop = result_GUUL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUUL = function(x){
  al_pop = result_GUUL$p1_qwei
  be_pop = result_GUUL$p2_qwei
  ga_pop = result_GUUL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUUL_PMETE = (1-cumsum(fx_GUUL(x_GUUL_dbh)*(max(x_GUUL)-min(x_GUUL))/length(x_GUUL_dbh)))*length(x_GUUL) # parametrized mete prediction
y_GUUL_METE = (1-cumsum(gx_GUUL(x_GUUL_dbh)*(max(x_GUUL)-min(x_GUUL))/length(x_GUUL_dbh)))*length(x_GUUL) # mete prediction
y_GUUL_EXP = exp(-(result_GUUL$p_exp)*(x_GUUL_dbh-min(x_GUUL_dbh)))*length(x_GUUL)  # exponential distribution
y_GUUL_POW = ((x_GUUL_dbh)^(-(result_GUUL$p_pow)))*length(x_GUUL) # power function distribution
y_GUUL_WEI = (exp(1/((result_GUUL$p1_wei)^(result_GUUL$p2_wei))-(x_GUUL_dbh/(result_GUUL$p1_wei))^(result_GUUL$p2_wei)))*length(x_GUUL) # Weibull distribution
y_GUUL_QWEI = (1-cumsum(qwei_GUUL(x_GUUL_dbh)*(max(x_GUUL)-min(x_GUUL))/length(x_GUUL_dbh)))*length(x_GUUL) # quasi_Weibull distribution

lines(x_GUUL_dbh, y_GUUL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUUL_dbh, y_GUUL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUUL_dbh, y_GUUL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUUL_dbh, y_GUUL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUUL_dbh, y_GUUL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUUL_dbh, y_GUUL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUUL", bty="n",cex=1.5)

#### Hampea appendiculata
BCI_HAAP = subset(bci_2015_live,Latin=="Hampea appendiculata")
x_HAAP = BCI_HAAP$DBH/min(BCI_HAAP$DBH)
length(x_HAAP)
x_HAAP_dbh = seq(min(x_HAAP),max(x_HAAP),length=10*length(x_HAAP))
result_HAAP = subset(result_bci_sp_all,Latin=="Hampea appendiculata")

plot(sort(x_HAAP, decreasing=TRUE), 1:length(x_HAAP), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HAAP), max(x_HAAP)), ylim = c(1, length(x_HAAP)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_HAAP = function(x){
  b_pop = result_HAAP$b_pmete
  n_pop = result_HAAP$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HAAP = function(x){
  b_pop = 2
  n_pop = result_HAAP$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HAAP = function(x){
  al_pop = result_HAAP$p1_qwei
  be_pop = result_HAAP$p2_qwei
  ga_pop = result_HAAP$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HAAP_PMETE = (1-cumsum(fx_HAAP(x_HAAP_dbh)*(max(x_HAAP)-min(x_HAAP))/length(x_HAAP_dbh)))*length(x_HAAP) # parametrized mete prediction
y_HAAP_METE = (1-cumsum(gx_HAAP(x_HAAP_dbh)*(max(x_HAAP)-min(x_HAAP))/length(x_HAAP_dbh)))*length(x_HAAP) # mete prediction
y_HAAP_EXP = exp(-(result_HAAP$p_exp)*(x_HAAP_dbh-min(x_HAAP_dbh)))*length(x_HAAP)  # exponential distribution
y_HAAP_POW = ((x_HAAP_dbh)^(-(result_HAAP$p_pow)))*length(x_HAAP) # power function distribution
y_HAAP_WEI = (exp(1/((result_HAAP$p1_wei)^(result_HAAP$p2_wei))-(x_HAAP_dbh/(result_HAAP$p1_wei))^(result_HAAP$p2_wei)))*length(x_HAAP) # Weibull distribution
y_HAAP_QWEI = (1-cumsum(qwei_HAAP(x_HAAP_dbh)*(max(x_HAAP)-min(x_HAAP))/length(x_HAAP_dbh)))*length(x_HAAP) # quasi_Weibull distribution

lines(x_HAAP_dbh, y_HAAP_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HAAP_dbh, y_HAAP_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HAAP_dbh, y_HAAP_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HAAP_dbh, y_HAAP_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HAAP_dbh, y_HAAP_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HAAP_dbh, y_HAAP_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HAAP", bty="n",cex=1.5)

#### Herrania purpurea
BCI_HEPU = subset(bci_2015_live,Latin=="Herrania purpurea")
x_HEPU = BCI_HEPU$DBH/min(BCI_HEPU$DBH)
length(x_HEPU)
x_HEPU_dbh = seq(min(x_HEPU),max(x_HEPU),length=10*length(x_HEPU))
result_HEPU = subset(result_bci_sp_all,Latin=="Herrania purpurea")

plot(sort(x_HEPU, decreasing=TRUE), 1:length(x_HEPU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HEPU), max(x_HEPU)), ylim = c(1, length(x_HEPU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_HEPU = function(x){
  b_pop = result_HEPU$b_pmete
  n_pop = result_HEPU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HEPU = function(x){
  b_pop = 2
  n_pop = result_HEPU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HEPU = function(x){
  al_pop = result_HEPU$p1_qwei
  be_pop = result_HEPU$p2_qwei
  ga_pop = result_HEPU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HEPU_PMETE = (1-cumsum(fx_HEPU(x_HEPU_dbh)*(max(x_HEPU)-min(x_HEPU))/length(x_HEPU_dbh)))*length(x_HEPU) # parametrized mete prediction
y_HEPU_METE = (1-cumsum(gx_HEPU(x_HEPU_dbh)*(max(x_HEPU)-min(x_HEPU))/length(x_HEPU_dbh)))*length(x_HEPU) # mete prediction
y_HEPU_EXP = exp(-(result_HEPU$p_exp)*(x_HEPU_dbh-min(x_HEPU_dbh)))*length(x_HEPU)  # exponential distribution
y_HEPU_POW = ((x_HEPU_dbh)^(-(result_HEPU$p_pow)))*length(x_HEPU) # power function distribution
y_HEPU_WEI = (exp(1/((result_HEPU$p1_wei)^(result_HEPU$p2_wei))-(x_HEPU_dbh/(result_HEPU$p1_wei))^(result_HEPU$p2_wei)))*length(x_HEPU) # Weibull distribution
y_HEPU_QWEI = (1-cumsum(qwei_HEPU(x_HEPU_dbh)*(max(x_HEPU)-min(x_HEPU))/length(x_HEPU_dbh)))*length(x_HEPU) # quasi_Weibull distribution

lines(x_HEPU_dbh, y_HEPU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HEPU_dbh, y_HEPU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HEPU_dbh, y_HEPU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HEPU_dbh, y_HEPU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HEPU_dbh, y_HEPU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HEPU_dbh, y_HEPU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HEPU", bty="n",cex=1.5)

#### Luehea seemannii
BCI_LUSE = subset(bci_2015_live,Latin=="Luehea seemannii")
x_LUSE = BCI_LUSE$DBH/min(BCI_LUSE$DBH)
length(x_LUSE)
x_LUSE_dbh = seq(min(x_LUSE),max(x_LUSE),length=10*length(x_LUSE))
result_LUSE = subset(result_bci_sp_all,Latin=="Luehea seemannii")

plot(sort(x_LUSE, decreasing=TRUE), 1:length(x_LUSE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_LUSE), max(x_LUSE)), ylim = c(1, length(x_LUSE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_LUSE = function(x){
  b_pop = result_LUSE$b_pmete
  n_pop = result_LUSE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_LUSE = function(x){
  b_pop = 2
  n_pop = result_LUSE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_LUSE = function(x){
  al_pop = result_LUSE$p1_qwei
  be_pop = result_LUSE$p2_qwei
  ga_pop = result_LUSE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_LUSE_PMETE = (1-cumsum(fx_LUSE(x_LUSE_dbh)*(max(x_LUSE)-min(x_LUSE))/length(x_LUSE_dbh)))*length(x_LUSE) # parametrized mete prediction
y_LUSE_METE = (1-cumsum(gx_LUSE(x_LUSE_dbh)*(max(x_LUSE)-min(x_LUSE))/length(x_LUSE_dbh)))*length(x_LUSE) # mete prediction
y_LUSE_EXP = exp(-(result_LUSE$p_exp)*(x_LUSE_dbh-min(x_LUSE_dbh)))*length(x_LUSE)  # exponential distribution
y_LUSE_POW = ((x_LUSE_dbh)^(-(result_LUSE$p_pow)))*length(x_LUSE) # power function distribution
y_LUSE_WEI = (exp(1/((result_LUSE$p1_wei)^(result_LUSE$p2_wei))-(x_LUSE_dbh/(result_LUSE$p1_wei))^(result_LUSE$p2_wei)))*length(x_LUSE) # Weibull distribution
y_LUSE_QWEI = (1-cumsum(qwei_LUSE(x_LUSE_dbh)*(max(x_LUSE)-min(x_LUSE))/length(x_LUSE_dbh)))*length(x_LUSE) # quasi_Weibull distribution

lines(x_LUSE_dbh, y_LUSE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_LUSE_dbh, y_LUSE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_LUSE_dbh, y_LUSE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_LUSE_dbh, y_LUSE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_LUSE_dbh, y_LUSE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_LUSE_dbh, y_LUSE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "LUSE", bty="n",cex=1.5)

#### Quararibea asterolepis
BCI_QUAS = subset(bci_2015_live,Latin=="Quararibea asterolepis")
x_QUAS = BCI_QUAS$DBH/min(BCI_QUAS$DBH)
length(x_QUAS)
x_QUAS_dbh = seq(min(x_QUAS),max(x_QUAS),length=10*length(x_QUAS))
result_QUAS = subset(result_bci_sp_all,Latin=="Quararibea asterolepis")

plot(sort(x_QUAS, decreasing=TRUE), 1:length(x_QUAS), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_QUAS), max(x_QUAS)), ylim = c(1, length(x_QUAS)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_QUAS = function(x){
  b_pop = result_QUAS$b_pmete
  n_pop = result_QUAS$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_QUAS = function(x){
  b_pop = 2
  n_pop = result_QUAS$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_QUAS = function(x){
  al_pop = result_QUAS$p1_qwei
  be_pop = result_QUAS$p2_qwei
  ga_pop = result_QUAS$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_QUAS_PMETE = (1-cumsum(fx_QUAS(x_QUAS_dbh)*(max(x_QUAS)-min(x_QUAS))/length(x_QUAS_dbh)))*length(x_QUAS) # parametrized mete prediction
y_QUAS_METE = (1-cumsum(gx_QUAS(x_QUAS_dbh)*(max(x_QUAS)-min(x_QUAS))/length(x_QUAS_dbh)))*length(x_QUAS) # mete prediction
y_QUAS_EXP = exp(-(result_QUAS$p_exp)*(x_QUAS_dbh-min(x_QUAS_dbh)))*length(x_QUAS)  # exponential distribution
y_QUAS_POW = ((x_QUAS_dbh)^(-(result_QUAS$p_pow)))*length(x_QUAS) # power function distribution
y_QUAS_WEI = (exp(1/((result_QUAS$p1_wei)^(result_QUAS$p2_wei))-(x_QUAS_dbh/(result_QUAS$p1_wei))^(result_QUAS$p2_wei)))*length(x_QUAS) # Weibull distribution
y_QUAS_QWEI = (1-cumsum(qwei_QUAS(x_QUAS_dbh)*(max(x_QUAS)-min(x_QUAS))/length(x_QUAS_dbh)))*length(x_QUAS) # quasi_Weibull distribution

lines(x_QUAS_dbh, y_QUAS_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_QUAS_dbh, y_QUAS_METE, col="#999999",lwd=2) #, lty=5)
lines(x_QUAS_dbh, y_QUAS_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_QUAS_dbh, y_QUAS_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_QUAS_dbh, y_QUAS_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_QUAS_dbh, y_QUAS_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "QUAS", bty="n",cex=1.5)
```
### BCI (Order=Myrtales)
```{r}
par(mfrow=c(3,4),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Chamguava schippii
BCI_CHSC = subset(bci_2015_live,Latin=="Chamguava schippii")
x_CHSC = BCI_CHSC$DBH/min(BCI_CHSC$DBH)
length(x_CHSC)
x_CHSC_dbh = seq(min(x_CHSC),max(x_CHSC),length=10*length(x_CHSC))
result_CHSC = subset(result_bci_sp_all,Latin=="Chamguava schippii")

plot(sort(x_CHSC, decreasing=TRUE), 1:length(x_CHSC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CHSC), max(x_CHSC)), ylim = c(1, length(x_CHSC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CHSC = function(x){
  b_pop = result_CHSC$b_pmete
  n_pop = result_CHSC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CHSC = function(x){
  b_pop = 2
  n_pop = result_CHSC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CHSC = function(x){
  al_pop = result_CHSC$p1_qwei
  be_pop = result_CHSC$p2_qwei
  ga_pop = result_CHSC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CHSC_PMETE = (1-cumsum(fx_CHSC(x_CHSC_dbh)*(max(x_CHSC)-min(x_CHSC))/length(x_CHSC_dbh)))*length(x_CHSC) # parametrized mete prediction
y_CHSC_METE = (1-cumsum(gx_CHSC(x_CHSC_dbh)*(max(x_CHSC)-min(x_CHSC))/length(x_CHSC_dbh)))*length(x_CHSC) # mete prediction
y_CHSC_EXP = exp(-(result_CHSC$p_exp)*(x_CHSC_dbh-min(x_CHSC_dbh)))*length(x_CHSC)  # exponential distribution
y_CHSC_POW = ((x_CHSC_dbh)^(-(result_CHSC$p_pow)))*length(x_CHSC) # power function distribution
y_CHSC_WEI = (exp(1/((result_CHSC$p1_wei)^(result_CHSC$p2_wei))-(x_CHSC_dbh/(result_CHSC$p1_wei))^(result_CHSC$p2_wei)))*length(x_CHSC) # Weibull distribution
y_CHSC_QWEI = (1-cumsum(qwei_CHSC(x_CHSC_dbh)*(max(x_CHSC)-min(x_CHSC))/length(x_CHSC_dbh)))*length(x_CHSC) # quasi_Weibull distribution

lines(x_CHSC_dbh, y_CHSC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CHSC_dbh, y_CHSC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CHSC_dbh, y_CHSC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CHSC_dbh, y_CHSC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CHSC_dbh, y_CHSC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CHSC_dbh, y_CHSC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CHSC", bty="n",cex=1.5)

#### Conostegia cinnamomea
BCI_COCI = subset(bci_2015_live,Latin=="Conostegia cinnamomea")
x_COCI = BCI_COCI$DBH/min(BCI_COCI$DBH)
length(x_COCI)
x_COCI_dbh = seq(min(x_COCI),max(x_COCI),length=10*length(x_COCI))
result_COCI = subset(result_bci_sp_all,Latin=="Conostegia cinnamomea")

plot(sort(x_COCI, decreasing=TRUE), 1:length(x_COCI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_COCI), max(x_COCI)), ylim = c(1, length(x_COCI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_COCI = function(x){
  b_pop = result_COCI$b_pmete
  n_pop = result_COCI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_COCI = function(x){
  b_pop = 2
  n_pop = result_COCI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_COCI = function(x){
  al_pop = result_COCI$p1_qwei
  be_pop = result_COCI$p2_qwei
  ga_pop = result_COCI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_COCI_PMETE = (1-cumsum(fx_COCI(x_COCI_dbh)*(max(x_COCI)-min(x_COCI))/length(x_COCI_dbh)))*length(x_COCI) # parametrized mete prediction
y_COCI_METE = (1-cumsum(gx_COCI(x_COCI_dbh)*(max(x_COCI)-min(x_COCI))/length(x_COCI_dbh)))*length(x_COCI) # mete prediction
y_COCI_EXP = exp(-(result_COCI$p_exp)*(x_COCI_dbh-min(x_COCI_dbh)))*length(x_COCI)  # exponential distribution
y_COCI_POW = ((x_COCI_dbh)^(-(result_COCI$p_pow)))*length(x_COCI) # power function distribution
y_COCI_WEI = (exp(1/((result_COCI$p1_wei)^(result_COCI$p2_wei))-(x_COCI_dbh/(result_COCI$p1_wei))^(result_COCI$p2_wei)))*length(x_COCI) # Weibull distribution
y_COCI_QWEI = (1-cumsum(qwei_COCI(x_COCI_dbh)*(max(x_COCI)-min(x_COCI))/length(x_COCI_dbh)))*length(x_COCI) # quasi_Weibull distribution

lines(x_COCI_dbh, y_COCI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_COCI_dbh, y_COCI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_COCI_dbh, y_COCI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_COCI_dbh, y_COCI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_COCI_dbh, y_COCI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_COCI_dbh, y_COCI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "COCI", bty="n",cex=1.5)

#### Eugenia coloradoensis
BCI_EUCO = subset(bci_2015_live,Latin=="Eugenia coloradoensis")
x_EUCO = BCI_EUCO$DBH/min(BCI_EUCO$DBH)
length(x_EUCO)
x_EUCO_dbh = seq(min(x_EUCO),max(x_EUCO),length=10*length(x_EUCO))
result_EUCO = subset(result_bci_sp_all,Latin=="Eugenia coloradoensis")

plot(sort(x_EUCO, decreasing=TRUE), 1:length(x_EUCO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_EUCO), max(x_EUCO)), ylim = c(1, length(x_EUCO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_EUCO = function(x){
  b_pop = result_EUCO$b_pmete
  n_pop = result_EUCO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_EUCO = function(x){
  b_pop = 2
  n_pop = result_EUCO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_EUCO = function(x){
  al_pop = result_EUCO$p1_qwei
  be_pop = result_EUCO$p2_qwei
  ga_pop = result_EUCO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_EUCO_PMETE = (1-cumsum(fx_EUCO(x_EUCO_dbh)*(max(x_EUCO)-min(x_EUCO))/length(x_EUCO_dbh)))*length(x_EUCO) # parametrized mete prediction
y_EUCO_METE = (1-cumsum(gx_EUCO(x_EUCO_dbh)*(max(x_EUCO)-min(x_EUCO))/length(x_EUCO_dbh)))*length(x_EUCO) # mete prediction
y_EUCO_EXP = exp(-(result_EUCO$p_exp)*(x_EUCO_dbh-min(x_EUCO_dbh)))*length(x_EUCO)  # exponential distribution
y_EUCO_POW = ((x_EUCO_dbh)^(-(result_EUCO$p_pow)))*length(x_EUCO) # power function distribution
y_EUCO_WEI = (exp(1/((result_EUCO$p1_wei)^(result_EUCO$p2_wei))-(x_EUCO_dbh/(result_EUCO$p1_wei))^(result_EUCO$p2_wei)))*length(x_EUCO) # Weibull distribution
y_EUCO_QWEI = (1-cumsum(qwei_EUCO(x_EUCO_dbh)*(max(x_EUCO)-min(x_EUCO))/length(x_EUCO_dbh)))*length(x_EUCO) # quasi_Weibull distribution

lines(x_EUCO_dbh, y_EUCO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_EUCO_dbh, y_EUCO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_EUCO_dbh, y_EUCO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_EUCO_dbh, y_EUCO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_EUCO_dbh, y_EUCO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_EUCO_dbh, y_EUCO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "EUCO", bty="n",cex=1.5)

#### Eugenia galalonensis
BCI_EUGA = subset(bci_2015_live,Latin=="Eugenia galalonensis")
x_EUGA = BCI_EUGA$DBH/min(BCI_EUGA$DBH)
length(x_EUGA)
x_EUGA_dbh = seq(min(x_EUGA),max(x_EUGA),length=10*length(x_EUGA))
result_EUGA = subset(result_bci_sp_all,Latin=="Eugenia galalonensis")

plot(sort(x_EUGA, decreasing=TRUE), 1:length(x_EUGA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_EUGA), max(x_EUGA)), ylim = c(1, length(x_EUGA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_EUGA = function(x){
  b_pop = result_EUGA$b_pmete
  n_pop = result_EUGA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_EUGA = function(x){
  b_pop = 2
  n_pop = result_EUGA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_EUGA = function(x){
  al_pop = result_EUGA$p1_qwei
  be_pop = result_EUGA$p2_qwei
  ga_pop = result_EUGA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_EUGA_PMETE = (1-cumsum(fx_EUGA(x_EUGA_dbh)*(max(x_EUGA)-min(x_EUGA))/length(x_EUGA_dbh)))*length(x_EUGA) # parametrized mete prediction
y_EUGA_METE = (1-cumsum(gx_EUGA(x_EUGA_dbh)*(max(x_EUGA)-min(x_EUGA))/length(x_EUGA_dbh)))*length(x_EUGA) # mete prediction
y_EUGA_EXP = exp(-(result_EUGA$p_exp)*(x_EUGA_dbh-min(x_EUGA_dbh)))*length(x_EUGA)  # exponential distribution
y_EUGA_POW = ((x_EUGA_dbh)^(-(result_EUGA$p_pow)))*length(x_EUGA) # power function distribution
y_EUGA_WEI = (exp(1/((result_EUGA$p1_wei)^(result_EUGA$p2_wei))-(x_EUGA_dbh/(result_EUGA$p1_wei))^(result_EUGA$p2_wei)))*length(x_EUGA) # Weibull distribution
y_EUGA_QWEI = (1-cumsum(qwei_EUGA(x_EUGA_dbh)*(max(x_EUGA)-min(x_EUGA))/length(x_EUGA_dbh)))*length(x_EUGA) # quasi_Weibull distribution

lines(x_EUGA_dbh, y_EUGA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_EUGA_dbh, y_EUGA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_EUGA_dbh, y_EUGA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_EUGA_dbh, y_EUGA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_EUGA_dbh, y_EUGA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_EUGA_dbh, y_EUGA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "EUGA", bty="n",cex=1.5)

#### Eugenia nesiotica
BCI_EUNE = subset(bci_2015_live,Latin=="Eugenia nesiotica")
x_EUNE = BCI_EUNE$DBH/min(BCI_EUNE$DBH)
length(x_EUNE)
x_EUNE_dbh = seq(min(x_EUNE),max(x_EUNE),length=10*length(x_EUNE))
result_EUNE = subset(result_bci_sp_all,Latin=="Eugenia nesiotica")

plot(sort(x_EUNE, decreasing=TRUE), 1:length(x_EUNE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_EUNE), max(x_EUNE)), ylim = c(1, length(x_EUNE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_EUNE = function(x){
  b_pop = result_EUNE$b_pmete
  n_pop = result_EUNE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_EUNE = function(x){
  b_pop = 2
  n_pop = result_EUNE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_EUNE = function(x){
  al_pop = result_EUNE$p1_qwei
  be_pop = result_EUNE$p2_qwei
  ga_pop = result_EUNE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_EUNE_PMETE = (1-cumsum(fx_EUNE(x_EUNE_dbh)*(max(x_EUNE)-min(x_EUNE))/length(x_EUNE_dbh)))*length(x_EUNE) # parametrized mete prediction
y_EUNE_METE = (1-cumsum(gx_EUNE(x_EUNE_dbh)*(max(x_EUNE)-min(x_EUNE))/length(x_EUNE_dbh)))*length(x_EUNE) # mete prediction
y_EUNE_EXP = exp(-(result_EUNE$p_exp)*(x_EUNE_dbh-min(x_EUNE_dbh)))*length(x_EUNE)  # exponential distribution
y_EUNE_POW = ((x_EUNE_dbh)^(-(result_EUNE$p_pow)))*length(x_EUNE) # power function distribution
y_EUNE_WEI = (exp(1/((result_EUNE$p1_wei)^(result_EUNE$p2_wei))-(x_EUNE_dbh/(result_EUNE$p1_wei))^(result_EUNE$p2_wei)))*length(x_EUNE) # Weibull distribution
y_EUNE_QWEI = (1-cumsum(qwei_EUNE(x_EUNE_dbh)*(max(x_EUNE)-min(x_EUNE))/length(x_EUNE_dbh)))*length(x_EUNE) # quasi_Weibull distribution

lines(x_EUNE_dbh, y_EUNE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_EUNE_dbh, y_EUNE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_EUNE_dbh, y_EUNE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_EUNE_dbh, y_EUNE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_EUNE_dbh, y_EUNE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_EUNE_dbh, y_EUNE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "EUNE", bty="n",cex=1.5)

#### Eugenia oerstediana
BCI_EUOE = subset(bci_2015_live,Latin=="Eugenia oerstediana")
x_EUOE = BCI_EUOE$DBH/min(BCI_EUOE$DBH)
length(x_EUOE)
x_EUOE_dbh = seq(min(x_EUOE),max(x_EUOE),length=10*length(x_EUOE))
result_EUOE = subset(result_bci_sp_all,Latin=="Eugenia oerstediana")

plot(sort(x_EUOE, decreasing=TRUE), 1:length(x_EUOE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_EUOE), max(x_EUOE)), ylim = c(1, length(x_EUOE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_EUOE = function(x){
  b_pop = result_EUOE$b_pmete
  n_pop = result_EUOE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_EUOE = function(x){
  b_pop = 2
  n_pop = result_EUOE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_EUOE = function(x){
  al_pop = result_EUOE$p1_qwei
  be_pop = result_EUOE$p2_qwei
  ga_pop = result_EUOE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_EUOE_PMETE = (1-cumsum(fx_EUOE(x_EUOE_dbh)*(max(x_EUOE)-min(x_EUOE))/length(x_EUOE_dbh)))*length(x_EUOE) # parametrized mete prediction
y_EUOE_METE = (1-cumsum(gx_EUOE(x_EUOE_dbh)*(max(x_EUOE)-min(x_EUOE))/length(x_EUOE_dbh)))*length(x_EUOE) # mete prediction
y_EUOE_EXP = exp(-(result_EUOE$p_exp)*(x_EUOE_dbh-min(x_EUOE_dbh)))*length(x_EUOE)  # exponential distribution
y_EUOE_POW = ((x_EUOE_dbh)^(-(result_EUOE$p_pow)))*length(x_EUOE) # power function distribution
y_EUOE_WEI = (exp(1/((result_EUOE$p1_wei)^(result_EUOE$p2_wei))-(x_EUOE_dbh/(result_EUOE$p1_wei))^(result_EUOE$p2_wei)))*length(x_EUOE) # Weibull distribution
y_EUOE_QWEI = (1-cumsum(qwei_EUOE(x_EUOE_dbh)*(max(x_EUOE)-min(x_EUOE))/length(x_EUOE_dbh)))*length(x_EUOE) # quasi_Weibull distribution

lines(x_EUOE_dbh, y_EUOE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_EUOE_dbh, y_EUOE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_EUOE_dbh, y_EUOE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_EUOE_dbh, y_EUOE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_EUOE_dbh, y_EUOE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_EUOE_dbh, y_EUOE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "EUOE", bty="n",cex=1.5)

#### Miconia affinis
BCI_MIAF = subset(bci_2015_live,Latin=="Miconia affinis")
x_MIAF = BCI_MIAF$DBH/min(BCI_MIAF$DBH)
length(x_MIAF)
x_MIAF_dbh = seq(min(x_MIAF),max(x_MIAF),length=10*length(x_MIAF))
result_MIAF = subset(result_bci_sp_all,Latin=="Miconia affinis")

plot(sort(x_MIAF, decreasing=TRUE), 1:length(x_MIAF), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MIAF), max(x_MIAF)), ylim = c(1, length(x_MIAF)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MIAF = function(x){
  b_pop = result_MIAF$b_pmete
  n_pop = result_MIAF$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MIAF = function(x){
  b_pop = 2
  n_pop = result_MIAF$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MIAF = function(x){
  al_pop = result_MIAF$p1_qwei
  be_pop = result_MIAF$p2_qwei
  ga_pop = result_MIAF$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MIAF_PMETE = (1-cumsum(fx_MIAF(x_MIAF_dbh)*(max(x_MIAF)-min(x_MIAF))/length(x_MIAF_dbh)))*length(x_MIAF) # parametrized mete prediction
y_MIAF_METE = (1-cumsum(gx_MIAF(x_MIAF_dbh)*(max(x_MIAF)-min(x_MIAF))/length(x_MIAF_dbh)))*length(x_MIAF) # mete prediction
y_MIAF_EXP = exp(-(result_MIAF$p_exp)*(x_MIAF_dbh-min(x_MIAF_dbh)))*length(x_MIAF)  # exponential distribution
y_MIAF_POW = ((x_MIAF_dbh)^(-(result_MIAF$p_pow)))*length(x_MIAF) # power function distribution
y_MIAF_WEI = (exp(1/((result_MIAF$p1_wei)^(result_MIAF$p2_wei))-(x_MIAF_dbh/(result_MIAF$p1_wei))^(result_MIAF$p2_wei)))*length(x_MIAF) # Weibull distribution
y_MIAF_QWEI = (1-cumsum(qwei_MIAF(x_MIAF_dbh)*(max(x_MIAF)-min(x_MIAF))/length(x_MIAF_dbh)))*length(x_MIAF) # quasi_Weibull distribution

lines(x_MIAF_dbh, y_MIAF_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MIAF_dbh, y_MIAF_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MIAF_dbh, y_MIAF_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MIAF_dbh, y_MIAF_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MIAF_dbh, y_MIAF_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MIAF_dbh, y_MIAF_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MIAF", bty="n",cex=1.5)

#### Miconia argentea
BCI_MIAR = subset(bci_2015_live,Latin=="Miconia argentea")
x_MIAR = BCI_MIAR$DBH/min(BCI_MIAR$DBH)
length(x_MIAR)
x_MIAR_dbh = seq(min(x_MIAR),max(x_MIAR),length=10*length(x_MIAR))
result_MIAR = subset(result_bci_sp_all,Latin=="Miconia argentea")

plot(sort(x_MIAR, decreasing=TRUE), 1:length(x_MIAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MIAR), max(x_MIAR)), ylim = c(1, length(x_MIAR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MIAR = function(x){
  b_pop = result_MIAR$b_pmete
  n_pop = result_MIAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MIAR = function(x){
  b_pop = 2
  n_pop = result_MIAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MIAR = function(x){
  al_pop = result_MIAR$p1_qwei
  be_pop = result_MIAR$p2_qwei
  ga_pop = result_MIAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MIAR_PMETE = (1-cumsum(fx_MIAR(x_MIAR_dbh)*(max(x_MIAR)-min(x_MIAR))/length(x_MIAR_dbh)))*length(x_MIAR) # parametrized mete prediction
y_MIAR_METE = (1-cumsum(gx_MIAR(x_MIAR_dbh)*(max(x_MIAR)-min(x_MIAR))/length(x_MIAR_dbh)))*length(x_MIAR) # mete prediction
y_MIAR_EXP = exp(-(result_MIAR$p_exp)*(x_MIAR_dbh-min(x_MIAR_dbh)))*length(x_MIAR)  # exponential distribution
y_MIAR_POW = ((x_MIAR_dbh)^(-(result_MIAR$p_pow)))*length(x_MIAR) # power function distribution
y_MIAR_WEI = (exp(1/((result_MIAR$p1_wei)^(result_MIAR$p2_wei))-(x_MIAR_dbh/(result_MIAR$p1_wei))^(result_MIAR$p2_wei)))*length(x_MIAR) # Weibull distribution
y_MIAR_QWEI = (1-cumsum(qwei_MIAR(x_MIAR_dbh)*(max(x_MIAR)-min(x_MIAR))/length(x_MIAR_dbh)))*length(x_MIAR) # quasi_Weibull distribution

lines(x_MIAR_dbh, y_MIAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MIAR_dbh, y_MIAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MIAR_dbh, y_MIAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MIAR_dbh, y_MIAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MIAR_dbh, y_MIAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MIAR_dbh, y_MIAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MIAR", bty="n",cex=1.5)

#### Miconia hondurensis
BCI_MIHO = subset(bci_2015_live,Latin=="Miconia hondurensis")
x_MIHO = BCI_MIHO$DBH/min(BCI_MIHO$DBH)
length(x_MIHO)
x_MIHO_dbh = seq(min(x_MIHO),max(x_MIHO),length=10*length(x_MIHO))
result_MIHO = subset(result_bci_sp_all,Latin=="Miconia hondurensis")

plot(sort(x_MIHO, decreasing=TRUE), 1:length(x_MIHO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MIHO), max(x_MIHO)), ylim = c(1, length(x_MIHO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MIHO = function(x){
  b_pop = result_MIHO$b_pmete
  n_pop = result_MIHO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MIHO = function(x){
  b_pop = 2
  n_pop = result_MIHO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MIHO = function(x){
  al_pop = result_MIHO$p1_qwei
  be_pop = result_MIHO$p2_qwei
  ga_pop = result_MIHO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MIHO_PMETE = (1-cumsum(fx_MIHO(x_MIHO_dbh)*(max(x_MIHO)-min(x_MIHO))/length(x_MIHO_dbh)))*length(x_MIHO) # parametrized mete prediction
y_MIHO_METE = (1-cumsum(gx_MIHO(x_MIHO_dbh)*(max(x_MIHO)-min(x_MIHO))/length(x_MIHO_dbh)))*length(x_MIHO) # mete prediction
y_MIHO_EXP = exp(-(result_MIHO$p_exp)*(x_MIHO_dbh-min(x_MIHO_dbh)))*length(x_MIHO)  # exponential distribution
y_MIHO_POW = ((x_MIHO_dbh)^(-(result_MIHO$p_pow)))*length(x_MIHO) # power function distribution
y_MIHO_WEI = (exp(1/((result_MIHO$p1_wei)^(result_MIHO$p2_wei))-(x_MIHO_dbh/(result_MIHO$p1_wei))^(result_MIHO$p2_wei)))*length(x_MIHO) # Weibull distribution
y_MIHO_QWEI = (1-cumsum(qwei_MIHO(x_MIHO_dbh)*(max(x_MIHO)-min(x_MIHO))/length(x_MIHO_dbh)))*length(x_MIHO) # quasi_Weibull distribution

lines(x_MIHO_dbh, y_MIHO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MIHO_dbh, y_MIHO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MIHO_dbh, y_MIHO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MIHO_dbh, y_MIHO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MIHO_dbh, y_MIHO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MIHO_dbh, y_MIHO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MIHO", bty="n",cex=1.5)

#### Miconia nervosa
BCI_MINE = subset(bci_2015_live,Latin=="Miconia nervosa")
x_MINE = BCI_MINE$DBH/min(BCI_MINE$DBH)
length(x_MINE)
x_MINE_dbh = seq(min(x_MINE),max(x_MINE),length=10*length(x_MINE))
result_MINE = subset(result_bci_sp_all,Latin=="Miconia nervosa")

plot(sort(x_MINE, decreasing=TRUE), 1:length(x_MINE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MINE), max(x_MINE)), ylim = c(1, length(x_MINE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MINE = function(x){
  b_pop = result_MINE$b_pmete
  n_pop = result_MINE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MINE = function(x){
  b_pop = 2
  n_pop = result_MINE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MINE = function(x){
  al_pop = result_MINE$p1_qwei
  be_pop = result_MINE$p2_qwei
  ga_pop = result_MINE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MINE_PMETE = (1-cumsum(fx_MINE(x_MINE_dbh)*(max(x_MINE)-min(x_MINE))/length(x_MINE_dbh)))*length(x_MINE) # parametrized mete prediction
y_MINE_METE = (1-cumsum(gx_MINE(x_MINE_dbh)*(max(x_MINE)-min(x_MINE))/length(x_MINE_dbh)))*length(x_MINE) # mete prediction
y_MINE_EXP = exp(-(result_MINE$p_exp)*(x_MINE_dbh-min(x_MINE_dbh)))*length(x_MINE)  # exponential distribution
y_MINE_POW = ((x_MINE_dbh)^(-(result_MINE$p_pow)))*length(x_MINE) # power function distribution
y_MINE_WEI = (exp(1/((result_MINE$p1_wei)^(result_MINE$p2_wei))-(x_MINE_dbh/(result_MINE$p1_wei))^(result_MINE$p2_wei)))*length(x_MINE) # Weibull distribution
y_MINE_QWEI = (1-cumsum(qwei_MINE(x_MINE_dbh)*(max(x_MINE)-min(x_MINE))/length(x_MINE_dbh)))*length(x_MINE) # quasi_Weibull distribution

lines(x_MINE_dbh, y_MINE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MINE_dbh, y_MINE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MINE_dbh, y_MINE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MINE_dbh, y_MINE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MINE_dbh, y_MINE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MINE_dbh, y_MINE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MINE", bty="n",cex=1.5)

#### Mouriri myrtilloides
BCI_MOMY = subset(bci_2015_live,Latin=="Mouriri myrtilloides")
x_MOMY = BCI_MOMY$DBH/min(BCI_MOMY$DBH)
length(x_MOMY)
x_MOMY_dbh = seq(min(x_MOMY),max(x_MOMY),length=10*length(x_MOMY))
result_MOMY = subset(result_bci_sp_all,Latin=="Mouriri myrtilloides")

plot(sort(x_MOMY, decreasing=TRUE), 1:length(x_MOMY), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MOMY), max(x_MOMY)), ylim = c(1, length(x_MOMY)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MOMY = function(x){
  b_pop = result_MOMY$b_pmete
  n_pop = result_MOMY$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MOMY = function(x){
  b_pop = 2
  n_pop = result_MOMY$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MOMY = function(x){
  al_pop = result_MOMY$p1_qwei
  be_pop = result_MOMY$p2_qwei
  ga_pop = result_MOMY$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MOMY_PMETE = (1-cumsum(fx_MOMY(x_MOMY_dbh)*(max(x_MOMY)-min(x_MOMY))/length(x_MOMY_dbh)))*length(x_MOMY) # parametrized mete prediction
y_MOMY_METE = (1-cumsum(gx_MOMY(x_MOMY_dbh)*(max(x_MOMY)-min(x_MOMY))/length(x_MOMY_dbh)))*length(x_MOMY) # mete prediction
y_MOMY_EXP = exp(-(result_MOMY$p_exp)*(x_MOMY_dbh-min(x_MOMY_dbh)))*length(x_MOMY)  # exponential distribution
y_MOMY_POW = ((x_MOMY_dbh)^(-(result_MOMY$p_pow)))*length(x_MOMY) # power function distribution
y_MOMY_WEI = (exp(1/((result_MOMY$p1_wei)^(result_MOMY$p2_wei))-(x_MOMY_dbh/(result_MOMY$p1_wei))^(result_MOMY$p2_wei)))*length(x_MOMY) # Weibull distribution
y_MOMY_QWEI = (1-cumsum(qwei_MOMY(x_MOMY_dbh)*(max(x_MOMY)-min(x_MOMY))/length(x_MOMY_dbh)))*length(x_MOMY) # quasi_Weibull distribution

lines(x_MOMY_dbh, y_MOMY_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MOMY_dbh, y_MOMY_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MOMY_dbh, y_MOMY_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MOMY_dbh, y_MOMY_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MOMY_dbh, y_MOMY_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MOMY_dbh, y_MOMY_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MOMY", bty="n",cex=1.5)
```
### BCI (Order=Oxalidales)
```{r}
par(mfrow=c(1,1),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Sloanea terniflora
BCI_SLTE = subset(bci_2015_live,Latin=="Sloanea terniflora")
x_SLTE = BCI_SLTE$DBH/min(BCI_SLTE$DBH)
length(x_SLTE)
x_SLTE_dbh = seq(min(x_SLTE),max(x_SLTE),length=10*length(x_SLTE))
result_SLTE = subset(result_bci_sp_all,Latin=="Sloanea terniflora")

plot(sort(x_SLTE, decreasing=TRUE), 1:length(x_SLTE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SLTE), max(x_SLTE)), ylim = c(1, length(x_SLTE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SLTE = function(x){
  b_pop = result_SLTE$b_pmete
  n_pop = result_SLTE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SLTE = function(x){
  b_pop = 2
  n_pop = result_SLTE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SLTE = function(x){
  al_pop = result_SLTE$p1_qwei
  be_pop = result_SLTE$p2_qwei
  ga_pop = result_SLTE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SLTE_PMETE = (1-cumsum(fx_SLTE(x_SLTE_dbh)*(max(x_SLTE)-min(x_SLTE))/length(x_SLTE_dbh)))*length(x_SLTE) # parametrized mete prediction
y_SLTE_METE = (1-cumsum(gx_SLTE(x_SLTE_dbh)*(max(x_SLTE)-min(x_SLTE))/length(x_SLTE_dbh)))*length(x_SLTE) # mete prediction
y_SLTE_EXP = exp(-(result_SLTE$p_exp)*(x_SLTE_dbh-min(x_SLTE_dbh)))*length(x_SLTE)  # exponential distribution
y_SLTE_POW = ((x_SLTE_dbh)^(-(result_SLTE$p_pow)))*length(x_SLTE) # power function distribution
y_SLTE_WEI = (exp(1/((result_SLTE$p1_wei)^(result_SLTE$p2_wei))-(x_SLTE_dbh/(result_SLTE$p1_wei))^(result_SLTE$p2_wei)))*length(x_SLTE) # Weibull distribution
y_SLTE_QWEI = (1-cumsum(qwei_SLTE(x_SLTE_dbh)*(max(x_SLTE)-min(x_SLTE))/length(x_SLTE_dbh)))*length(x_SLTE) # quasi_Weibull distribution

lines(x_SLTE_dbh, y_SLTE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SLTE_dbh, y_SLTE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SLTE_dbh, y_SLTE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SLTE_dbh, y_SLTE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SLTE_dbh, y_SLTE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SLTE_dbh, y_SLTE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SLTE", bty="n",cex=1.5)
```

### BCI (Order=Picramniales)
```{r}
par(mfrow=c(1,1),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Picramnia latifolia
BCI_PILA = subset(bci_2015_live,Latin=="Picramnia latifolia")
x_PILA = BCI_PILA$DBH/min(BCI_PILA$DBH)
length(x_PILA)
x_PILA_dbh = seq(min(x_PILA),max(x_PILA),length=10*length(x_PILA))
result_PILA = subset(result_bci_sp_all,Latin=="Picramnia latifolia")

plot(sort(x_PILA, decreasing=TRUE), 1:length(x_PILA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PILA), max(x_PILA)), ylim = c(1, length(x_PILA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PILA = function(x){
  b_pop = result_PILA$b_pmete
  n_pop = result_PILA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PILA = function(x){
  b_pop = 2
  n_pop = result_PILA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PILA = function(x){
  al_pop = result_PILA$p1_qwei
  be_pop = result_PILA$p2_qwei
  ga_pop = result_PILA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PILA_PMETE = (1-cumsum(fx_PILA(x_PILA_dbh)*(max(x_PILA)-min(x_PILA))/length(x_PILA_dbh)))*length(x_PILA) # parametrized mete prediction
y_PILA_METE = (1-cumsum(gx_PILA(x_PILA_dbh)*(max(x_PILA)-min(x_PILA))/length(x_PILA_dbh)))*length(x_PILA) # mete prediction
y_PILA_EXP = exp(-(result_PILA$p_exp)*(x_PILA_dbh-min(x_PILA_dbh)))*length(x_PILA)  # exponential distribution
y_PILA_POW = ((x_PILA_dbh)^(-(result_PILA$p_pow)))*length(x_PILA) # power function distribution
y_PILA_WEI = (exp(1/((result_PILA$p1_wei)^(result_PILA$p2_wei))-(x_PILA_dbh/(result_PILA$p1_wei))^(result_PILA$p2_wei)))*length(x_PILA) # Weibull distribution
y_PILA_QWEI = (1-cumsum(qwei_PILA(x_PILA_dbh)*(max(x_PILA)-min(x_PILA))/length(x_PILA_dbh)))*length(x_PILA) # quasi_Weibull distribution

lines(x_PILA_dbh, y_PILA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PILA_dbh, y_PILA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PILA_dbh, y_PILA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PILA_dbh, y_PILA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PILA_dbh, y_PILA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PILA_dbh, y_PILA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PILA", bty="n",cex=1.5)
```
### BCI (Order=Piperales)
```{r}
par(mfrow=c(1,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Piper cordulatum
BCI_PICO = subset(bci_2015_live,Latin=="Piper cordulatum")
x_PICO = BCI_PICO$DBH/min(BCI_PICO$DBH)
length(x_PICO)
x_PICO_dbh = seq(min(x_PICO),max(x_PICO),length=10*length(x_PICO))
result_PICO = subset(result_bci_sp_all,Latin=="Piper cordulatum")

plot(sort(x_PICO, decreasing=TRUE), 1:length(x_PICO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PICO), max(x_PICO)), ylim = c(1, length(x_PICO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PICO = function(x){
  b_pop = result_PICO$b_pmete
  n_pop = result_PICO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PICO = function(x){
  b_pop = 2
  n_pop = result_PICO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PICO = function(x){
  al_pop = result_PICO$p1_qwei
  be_pop = result_PICO$p2_qwei
  ga_pop = result_PICO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PICO_PMETE = (1-cumsum(fx_PICO(x_PICO_dbh)*(max(x_PICO)-min(x_PICO))/length(x_PICO_dbh)))*length(x_PICO) # parametrized mete prediction
y_PICO_METE = (1-cumsum(gx_PICO(x_PICO_dbh)*(max(x_PICO)-min(x_PICO))/length(x_PICO_dbh)))*length(x_PICO) # mete prediction
y_PICO_EXP = exp(-(result_PICO$p_exp)*(x_PICO_dbh-min(x_PICO_dbh)))*length(x_PICO)  # exponential distribution
y_PICO_POW = ((x_PICO_dbh)^(-(result_PICO$p_pow)))*length(x_PICO) # power function distribution
y_PICO_WEI = (exp(1/((result_PICO$p1_wei)^(result_PICO$p2_wei))-(x_PICO_dbh/(result_PICO$p1_wei))^(result_PICO$p2_wei)))*length(x_PICO) # Weibull distribution
y_PICO_QWEI = (1-cumsum(qwei_PICO(x_PICO_dbh)*(max(x_PICO)-min(x_PICO))/length(x_PICO_dbh)))*length(x_PICO) # quasi_Weibull distribution

lines(x_PICO_dbh, y_PICO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PICO_dbh, y_PICO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PICO_dbh, y_PICO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PICO_dbh, y_PICO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PICO_dbh, y_PICO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PICO_dbh, y_PICO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PICO", bty="n",cex=1.5)

#### Piper reticulatum
BCI_PIRE = subset(bci_2015_live,Latin=="Piper reticulatum")
x_PIRE = BCI_PIRE$DBH/min(BCI_PIRE$DBH)
length(x_PIRE)
x_PIRE_dbh = seq(min(x_PIRE),max(x_PIRE),length=10*length(x_PIRE))
result_PIRE = subset(result_bci_sp_all,Latin=="Piper reticulatum")

plot(sort(x_PIRE, decreasing=TRUE), 1:length(x_PIRE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PIRE), max(x_PIRE)), ylim = c(1, length(x_PIRE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PIRE = function(x){
  b_pop = result_PIRE$b_pmete
  n_pop = result_PIRE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PIRE = function(x){
  b_pop = 2
  n_pop = result_PIRE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PIRE = function(x){
  al_pop = result_PIRE$p1_qwei
  be_pop = result_PIRE$p2_qwei
  ga_pop = result_PIRE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PIRE_PMETE = (1-cumsum(fx_PIRE(x_PIRE_dbh)*(max(x_PIRE)-min(x_PIRE))/length(x_PIRE_dbh)))*length(x_PIRE) # parametrized mete prediction
y_PIRE_METE = (1-cumsum(gx_PIRE(x_PIRE_dbh)*(max(x_PIRE)-min(x_PIRE))/length(x_PIRE_dbh)))*length(x_PIRE) # mete prediction
y_PIRE_EXP = exp(-(result_PIRE$p_exp)*(x_PIRE_dbh-min(x_PIRE_dbh)))*length(x_PIRE)  # exponential distribution
y_PIRE_POW = ((x_PIRE_dbh)^(-(result_PIRE$p_pow)))*length(x_PIRE) # power function distribution
y_PIRE_WEI = (exp(1/((result_PIRE$p1_wei)^(result_PIRE$p2_wei))-(x_PIRE_dbh/(result_PIRE$p1_wei))^(result_PIRE$p2_wei)))*length(x_PIRE) # Weibull distribution
y_PIRE_QWEI = (1-cumsum(qwei_PIRE(x_PIRE_dbh)*(max(x_PIRE)-min(x_PIRE))/length(x_PIRE_dbh)))*length(x_PIRE) # quasi_Weibull distribution

lines(x_PIRE_dbh, y_PIRE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PIRE_dbh, y_PIRE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PIRE_dbh, y_PIRE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PIRE_dbh, y_PIRE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PIRE_dbh, y_PIRE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PIRE_dbh, y_PIRE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PIRE", bty="n",cex=1.5)
```
### BCI (Order=Rosales)
```{r}
par(mfrow=c(3,4),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Brosimum alicastrum
BCI_BRAL = subset(bci_2015_live,Latin=="Brosimum alicastrum")
x_BRAL = BCI_BRAL$DBH/min(BCI_BRAL$DBH)
length(x_BRAL)
x_BRAL_dbh = seq(min(x_BRAL),max(x_BRAL),length=10*length(x_BRAL))
result_BRAL = subset(result_bci_sp_all,Latin=="Brosimum alicastrum")

plot(sort(x_BRAL, decreasing=TRUE), 1:length(x_BRAL), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_BRAL), max(x_BRAL)), ylim = c(1, length(x_BRAL)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_BRAL = function(x){
  b_pop = result_BRAL$b_pmete
  n_pop = result_BRAL$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_BRAL = function(x){
  b_pop = 2
  n_pop = result_BRAL$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_BRAL = function(x){
  al_pop = result_BRAL$p1_qwei
  be_pop = result_BRAL$p2_qwei
  ga_pop = result_BRAL$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_BRAL_PMETE = (1-cumsum(fx_BRAL(x_BRAL_dbh)*(max(x_BRAL)-min(x_BRAL))/length(x_BRAL_dbh)))*length(x_BRAL) # parametrized mete prediction
y_BRAL_METE = (1-cumsum(gx_BRAL(x_BRAL_dbh)*(max(x_BRAL)-min(x_BRAL))/length(x_BRAL_dbh)))*length(x_BRAL) # mete prediction
y_BRAL_EXP = exp(-(result_BRAL$p_exp)*(x_BRAL_dbh-min(x_BRAL_dbh)))*length(x_BRAL)  # exponential distribution
y_BRAL_POW = ((x_BRAL_dbh)^(-(result_BRAL$p_pow)))*length(x_BRAL) # power function distribution
y_BRAL_WEI = (exp(1/((result_BRAL$p1_wei)^(result_BRAL$p2_wei))-(x_BRAL_dbh/(result_BRAL$p1_wei))^(result_BRAL$p2_wei)))*length(x_BRAL) # Weibull distribution
y_BRAL_QWEI = (1-cumsum(qwei_BRAL(x_BRAL_dbh)*(max(x_BRAL)-min(x_BRAL))/length(x_BRAL_dbh)))*length(x_BRAL) # quasi_Weibull distribution

lines(x_BRAL_dbh, y_BRAL_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_BRAL_dbh, y_BRAL_METE, col="#999999",lwd=2) #, lty=5)
lines(x_BRAL_dbh, y_BRAL_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_BRAL_dbh, y_BRAL_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_BRAL_dbh, y_BRAL_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_BRAL_dbh, y_BRAL_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BRAL", bty="n",cex=1.5)

#### Cecropia insignis
BCI_CEIN = subset(bci_2015_live,Latin=="Cecropia insignis")
x_CEIN = BCI_CEIN$DBH/min(BCI_CEIN$DBH)
length(x_CEIN)
x_CEIN_dbh = seq(min(x_CEIN),max(x_CEIN),length=10*length(x_CEIN))
result_CEIN = subset(result_bci_sp_all,Latin=="Cecropia insignis")

plot(sort(x_CEIN, decreasing=TRUE), 1:length(x_CEIN), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CEIN), max(x_CEIN)), ylim = c(1, length(x_CEIN)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CEIN = function(x){
  b_pop = result_CEIN$b_pmete
  n_pop = result_CEIN$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CEIN = function(x){
  b_pop = 2
  n_pop = result_CEIN$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CEIN = function(x){
  al_pop = result_CEIN$p1_qwei
  be_pop = result_CEIN$p2_qwei
  ga_pop = result_CEIN$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CEIN_PMETE = (1-cumsum(fx_CEIN(x_CEIN_dbh)*(max(x_CEIN)-min(x_CEIN))/length(x_CEIN_dbh)))*length(x_CEIN) # parametrized mete prediction
y_CEIN_METE = (1-cumsum(gx_CEIN(x_CEIN_dbh)*(max(x_CEIN)-min(x_CEIN))/length(x_CEIN_dbh)))*length(x_CEIN) # mete prediction
y_CEIN_EXP = exp(-(result_CEIN$p_exp)*(x_CEIN_dbh-min(x_CEIN_dbh)))*length(x_CEIN)  # exponential distribution
y_CEIN_POW = ((x_CEIN_dbh)^(-(result_CEIN$p_pow)))*length(x_CEIN) # power function distribution
y_CEIN_WEI = (exp(1/((result_CEIN$p1_wei)^(result_CEIN$p2_wei))-(x_CEIN_dbh/(result_CEIN$p1_wei))^(result_CEIN$p2_wei)))*length(x_CEIN) # Weibull distribution
y_CEIN_QWEI = (1-cumsum(qwei_CEIN(x_CEIN_dbh)*(max(x_CEIN)-min(x_CEIN))/length(x_CEIN_dbh)))*length(x_CEIN) # quasi_Weibull distribution

lines(x_CEIN_dbh, y_CEIN_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CEIN_dbh, y_CEIN_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CEIN_dbh, y_CEIN_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CEIN_dbh, y_CEIN_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CEIN_dbh, y_CEIN_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CEIN_dbh, y_CEIN_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CEIN", bty="n",cex=1.5)

#### Cecropia obtusifolia
BCI_CEOB = subset(bci_2015_live,Latin=="Cecropia obtusifolia")
x_CEOB = BCI_CEOB$DBH/min(BCI_CEOB$DBH)
length(x_CEOB)
x_CEOB_dbh = seq(min(x_CEOB),max(x_CEOB),length=10*length(x_CEOB))
result_CEOB = subset(result_bci_sp_all,Latin=="Cecropia obtusifolia")

plot(sort(x_CEOB, decreasing=TRUE), 1:length(x_CEOB), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CEOB), max(x_CEOB)), ylim = c(1, length(x_CEOB)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CEOB = function(x){
  b_pop = result_CEOB$b_pmete
  n_pop = result_CEOB$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CEOB = function(x){
  b_pop = 2
  n_pop = result_CEOB$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CEOB = function(x){
  al_pop = result_CEOB$p1_qwei
  be_pop = result_CEOB$p2_qwei
  ga_pop = result_CEOB$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CEOB_PMETE = (1-cumsum(fx_CEOB(x_CEOB_dbh)*(max(x_CEOB)-min(x_CEOB))/length(x_CEOB_dbh)))*length(x_CEOB) # parametrized mete prediction
y_CEOB_METE = (1-cumsum(gx_CEOB(x_CEOB_dbh)*(max(x_CEOB)-min(x_CEOB))/length(x_CEOB_dbh)))*length(x_CEOB) # mete prediction
y_CEOB_EXP = exp(-(result_CEOB$p_exp)*(x_CEOB_dbh-min(x_CEOB_dbh)))*length(x_CEOB)  # exponential distribution
y_CEOB_POW = ((x_CEOB_dbh)^(-(result_CEOB$p_pow)))*length(x_CEOB) # power function distribution
y_CEOB_WEI = (exp(1/((result_CEOB$p1_wei)^(result_CEOB$p2_wei))-(x_CEOB_dbh/(result_CEOB$p1_wei))^(result_CEOB$p2_wei)))*length(x_CEOB) # Weibull distribution
y_CEOB_QWEI = (1-cumsum(qwei_CEOB(x_CEOB_dbh)*(max(x_CEOB)-min(x_CEOB))/length(x_CEOB_dbh)))*length(x_CEOB) # quasi_Weibull distribution

lines(x_CEOB_dbh, y_CEOB_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CEOB_dbh, y_CEOB_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CEOB_dbh, y_CEOB_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CEOB_dbh, y_CEOB_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CEOB_dbh, y_CEOB_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CEOB_dbh, y_CEOB_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CEOB", bty="n",cex=1.5)

#### Celtis schippii
BCI_CESC = subset(bci_2015_live,Latin=="Celtis schippii")
x_CESC = BCI_CESC$DBH/min(BCI_CESC$DBH)
length(x_CESC)
x_CESC_dbh = seq(min(x_CESC),max(x_CESC),length=10*length(x_CESC))
result_CESC = subset(result_bci_sp_all,Latin=="Celtis schippii")

plot(sort(x_CESC, decreasing=TRUE), 1:length(x_CESC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CESC), max(x_CESC)), ylim = c(1, length(x_CESC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CESC = function(x){
  b_pop = result_CESC$b_pmete
  n_pop = result_CESC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CESC = function(x){
  b_pop = 2
  n_pop = result_CESC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CESC = function(x){
  al_pop = result_CESC$p1_qwei
  be_pop = result_CESC$p2_qwei
  ga_pop = result_CESC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CESC_PMETE = (1-cumsum(fx_CESC(x_CESC_dbh)*(max(x_CESC)-min(x_CESC))/length(x_CESC_dbh)))*length(x_CESC) # parametrized mete prediction
y_CESC_METE = (1-cumsum(gx_CESC(x_CESC_dbh)*(max(x_CESC)-min(x_CESC))/length(x_CESC_dbh)))*length(x_CESC) # mete prediction
y_CESC_EXP = exp(-(result_CESC$p_exp)*(x_CESC_dbh-min(x_CESC_dbh)))*length(x_CESC)  # exponential distribution
y_CESC_POW = ((x_CESC_dbh)^(-(result_CESC$p_pow)))*length(x_CESC) # power function distribution
y_CESC_WEI = (exp(1/((result_CESC$p1_wei)^(result_CESC$p2_wei))-(x_CESC_dbh/(result_CESC$p1_wei))^(result_CESC$p2_wei)))*length(x_CESC) # Weibull distribution
y_CESC_QWEI = (1-cumsum(qwei_CESC(x_CESC_dbh)*(max(x_CESC)-min(x_CESC))/length(x_CESC_dbh)))*length(x_CESC) # quasi_Weibull distribution

lines(x_CESC_dbh, y_CESC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CESC_dbh, y_CESC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CESC_dbh, y_CESC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CESC_dbh, y_CESC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CESC_dbh, y_CESC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CESC_dbh, y_CESC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CESC", bty="n",cex=1.5)

#### Maquira guianensis
BCI_MAGU = subset(bci_2015_live,Latin=="Maquira guianensis")
x_MAGU = BCI_MAGU$DBH/min(BCI_MAGU$DBH)
length(x_MAGU)
x_MAGU_dbh = seq(min(x_MAGU),max(x_MAGU),length=10*length(x_MAGU))
result_MAGU = subset(result_bci_sp_all,Latin=="Maquira guianensis")

plot(sort(x_MAGU, decreasing=TRUE), 1:length(x_MAGU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_MAGU), max(x_MAGU)), ylim = c(1, length(x_MAGU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_MAGU = function(x){
  b_pop = result_MAGU$b_pmete
  n_pop = result_MAGU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_MAGU = function(x){
  b_pop = 2
  n_pop = result_MAGU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_MAGU = function(x){
  al_pop = result_MAGU$p1_qwei
  be_pop = result_MAGU$p2_qwei
  ga_pop = result_MAGU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_MAGU_PMETE = (1-cumsum(fx_MAGU(x_MAGU_dbh)*(max(x_MAGU)-min(x_MAGU))/length(x_MAGU_dbh)))*length(x_MAGU) # parametrized mete prediction
y_MAGU_METE = (1-cumsum(gx_MAGU(x_MAGU_dbh)*(max(x_MAGU)-min(x_MAGU))/length(x_MAGU_dbh)))*length(x_MAGU) # mete prediction
y_MAGU_EXP = exp(-(result_MAGU$p_exp)*(x_MAGU_dbh-min(x_MAGU_dbh)))*length(x_MAGU)  # exponential distribution
y_MAGU_POW = ((x_MAGU_dbh)^(-(result_MAGU$p_pow)))*length(x_MAGU) # power function distribution
y_MAGU_WEI = (exp(1/((result_MAGU$p1_wei)^(result_MAGU$p2_wei))-(x_MAGU_dbh/(result_MAGU$p1_wei))^(result_MAGU$p2_wei)))*length(x_MAGU) # Weibull distribution
y_MAGU_QWEI = (1-cumsum(qwei_MAGU(x_MAGU_dbh)*(max(x_MAGU)-min(x_MAGU))/length(x_MAGU_dbh)))*length(x_MAGU) # quasi_Weibull distribution

lines(x_MAGU_dbh, y_MAGU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_MAGU_dbh, y_MAGU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_MAGU_dbh, y_MAGU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_MAGU_dbh, y_MAGU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_MAGU_dbh, y_MAGU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_MAGU_dbh, y_MAGU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "MAGU", bty="n",cex=1.5)

#### Perebea xanthochyma
BCI_PEXA = subset(bci_2015_live,Latin=="Perebea xanthochyma")
x_PEXA = BCI_PEXA$DBH/min(BCI_PEXA$DBH)
length(x_PEXA)
x_PEXA_dbh = seq(min(x_PEXA),max(x_PEXA),length=10*length(x_PEXA))
result_PEXA = subset(result_bci_sp_all,Latin=="Perebea xanthochyma")

plot(sort(x_PEXA, decreasing=TRUE), 1:length(x_PEXA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PEXA), max(x_PEXA)), ylim = c(1, length(x_PEXA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PEXA = function(x){
  b_pop = result_PEXA$b_pmete
  n_pop = result_PEXA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PEXA = function(x){
  b_pop = 2
  n_pop = result_PEXA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PEXA = function(x){
  al_pop = result_PEXA$p1_qwei
  be_pop = result_PEXA$p2_qwei
  ga_pop = result_PEXA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PEXA_PMETE = (1-cumsum(fx_PEXA(x_PEXA_dbh)*(max(x_PEXA)-min(x_PEXA))/length(x_PEXA_dbh)))*length(x_PEXA) # parametrized mete prediction
y_PEXA_METE = (1-cumsum(gx_PEXA(x_PEXA_dbh)*(max(x_PEXA)-min(x_PEXA))/length(x_PEXA_dbh)))*length(x_PEXA) # mete prediction
y_PEXA_EXP = exp(-(result_PEXA$p_exp)*(x_PEXA_dbh-min(x_PEXA_dbh)))*length(x_PEXA)  # exponential distribution
y_PEXA_POW = ((x_PEXA_dbh)^(-(result_PEXA$p_pow)))*length(x_PEXA) # power function distribution
y_PEXA_WEI = (exp(1/((result_PEXA$p1_wei)^(result_PEXA$p2_wei))-(x_PEXA_dbh/(result_PEXA$p1_wei))^(result_PEXA$p2_wei)))*length(x_PEXA) # Weibull distribution
y_PEXA_QWEI = (1-cumsum(qwei_PEXA(x_PEXA_dbh)*(max(x_PEXA)-min(x_PEXA))/length(x_PEXA_dbh)))*length(x_PEXA) # quasi_Weibull distribution

lines(x_PEXA_dbh, y_PEXA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PEXA_dbh, y_PEXA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PEXA_dbh, y_PEXA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PEXA_dbh, y_PEXA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PEXA_dbh, y_PEXA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PEXA_dbh, y_PEXA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PEXA", bty="n",cex=1.5)

#### Poulsenia armata
BCI_POAR = subset(bci_2015_live,Latin=="Poulsenia armata")
x_POAR = BCI_POAR$DBH/min(BCI_POAR$DBH)
length(x_POAR)
x_POAR_dbh = seq(min(x_POAR),max(x_POAR),length=10*length(x_POAR))
result_POAR = subset(result_bci_sp_all,Latin=="Poulsenia armata")

plot(sort(x_POAR, decreasing=TRUE), 1:length(x_POAR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_POAR), max(x_POAR)), ylim = c(1, length(x_POAR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_POAR = function(x){
  b_pop = result_POAR$b_pmete
  n_pop = result_POAR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_POAR = function(x){
  b_pop = 2
  n_pop = result_POAR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_POAR = function(x){
  al_pop = result_POAR$p1_qwei
  be_pop = result_POAR$p2_qwei
  ga_pop = result_POAR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_POAR_PMETE = (1-cumsum(fx_POAR(x_POAR_dbh)*(max(x_POAR)-min(x_POAR))/length(x_POAR_dbh)))*length(x_POAR) # parametrized mete prediction
y_POAR_METE = (1-cumsum(gx_POAR(x_POAR_dbh)*(max(x_POAR)-min(x_POAR))/length(x_POAR_dbh)))*length(x_POAR) # mete prediction
y_POAR_EXP = exp(-(result_POAR$p_exp)*(x_POAR_dbh-min(x_POAR_dbh)))*length(x_POAR)  # exponential distribution
y_POAR_POW = ((x_POAR_dbh)^(-(result_POAR$p_pow)))*length(x_POAR) # power function distribution
y_POAR_WEI = (exp(1/((result_POAR$p1_wei)^(result_POAR$p2_wei))-(x_POAR_dbh/(result_POAR$p1_wei))^(result_POAR$p2_wei)))*length(x_POAR) # Weibull distribution
y_POAR_QWEI = (1-cumsum(qwei_POAR(x_POAR_dbh)*(max(x_POAR)-min(x_POAR))/length(x_POAR_dbh)))*length(x_POAR) # quasi_Weibull distribution

lines(x_POAR_dbh, y_POAR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_POAR_dbh, y_POAR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_POAR_dbh, y_POAR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_POAR_dbh, y_POAR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_POAR_dbh, y_POAR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_POAR_dbh, y_POAR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "POAR", bty="n",cex=1.5)

#### Pourouma bicolor
BCI_POBI = subset(bci_2015_live,Latin=="Pourouma bicolor")
x_POBI = BCI_POBI$DBH/min(BCI_POBI$DBH)
length(x_POBI)
x_POBI_dbh = seq(min(x_POBI),max(x_POBI),length=10*length(x_POBI))
result_POBI = subset(result_bci_sp_all,Latin=="Pourouma bicolor")

plot(sort(x_POBI, decreasing=TRUE), 1:length(x_POBI), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_POBI), max(x_POBI)), ylim = c(1, length(x_POBI)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_POBI = function(x){
  b_pop = result_POBI$b_pmete
  n_pop = result_POBI$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_POBI = function(x){
  b_pop = 2
  n_pop = result_POBI$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_POBI = function(x){
  al_pop = result_POBI$p1_qwei
  be_pop = result_POBI$p2_qwei
  ga_pop = result_POBI$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_POBI_PMETE = (1-cumsum(fx_POBI(x_POBI_dbh)*(max(x_POBI)-min(x_POBI))/length(x_POBI_dbh)))*length(x_POBI) # parametrized mete prediction
y_POBI_METE = (1-cumsum(gx_POBI(x_POBI_dbh)*(max(x_POBI)-min(x_POBI))/length(x_POBI_dbh)))*length(x_POBI) # mete prediction
y_POBI_EXP = exp(-(result_POBI$p_exp)*(x_POBI_dbh-min(x_POBI_dbh)))*length(x_POBI)  # exponential distribution
y_POBI_POW = ((x_POBI_dbh)^(-(result_POBI$p_pow)))*length(x_POBI) # power function distribution
y_POBI_WEI = (exp(1/((result_POBI$p1_wei)^(result_POBI$p2_wei))-(x_POBI_dbh/(result_POBI$p1_wei))^(result_POBI$p2_wei)))*length(x_POBI) # Weibull distribution
y_POBI_QWEI = (1-cumsum(qwei_POBI(x_POBI_dbh)*(max(x_POBI)-min(x_POBI))/length(x_POBI_dbh)))*length(x_POBI) # quasi_Weibull distribution

lines(x_POBI_dbh, y_POBI_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_POBI_dbh, y_POBI_METE, col="#999999",lwd=2) #, lty=5)
lines(x_POBI_dbh, y_POBI_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_POBI_dbh, y_POBI_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_POBI_dbh, y_POBI_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_POBI_dbh, y_POBI_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "POBI", bty="n",cex=1.5)

#### Sorocea affinis
BCI_SOAF = subset(bci_2015_live,Latin=="Sorocea affinis")
x_SOAF = BCI_SOAF$DBH/min(BCI_SOAF$DBH)
length(x_SOAF)
x_SOAF_dbh = seq(min(x_SOAF),max(x_SOAF),length=10*length(x_SOAF))
result_SOAF = subset(result_bci_sp_all,Latin=="Sorocea affinis")

plot(sort(x_SOAF, decreasing=TRUE), 1:length(x_SOAF), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SOAF), max(x_SOAF)), ylim = c(1, length(x_SOAF)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SOAF = function(x){
  b_pop = result_SOAF$b_pmete
  n_pop = result_SOAF$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SOAF = function(x){
  b_pop = 2
  n_pop = result_SOAF$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SOAF = function(x){
  al_pop = result_SOAF$p1_qwei
  be_pop = result_SOAF$p2_qwei
  ga_pop = result_SOAF$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SOAF_PMETE = (1-cumsum(fx_SOAF(x_SOAF_dbh)*(max(x_SOAF)-min(x_SOAF))/length(x_SOAF_dbh)))*length(x_SOAF) # parametrized mete prediction
y_SOAF_METE = (1-cumsum(gx_SOAF(x_SOAF_dbh)*(max(x_SOAF)-min(x_SOAF))/length(x_SOAF_dbh)))*length(x_SOAF) # mete prediction
y_SOAF_EXP = exp(-(result_SOAF$p_exp)*(x_SOAF_dbh-min(x_SOAF_dbh)))*length(x_SOAF)  # exponential distribution
y_SOAF_POW = ((x_SOAF_dbh)^(-(result_SOAF$p_pow)))*length(x_SOAF) # power function distribution
y_SOAF_WEI = (exp(1/((result_SOAF$p1_wei)^(result_SOAF$p2_wei))-(x_SOAF_dbh/(result_SOAF$p1_wei))^(result_SOAF$p2_wei)))*length(x_SOAF) # Weibull distribution
y_SOAF_QWEI = (1-cumsum(qwei_SOAF(x_SOAF_dbh)*(max(x_SOAF)-min(x_SOAF))/length(x_SOAF_dbh)))*length(x_SOAF) # quasi_Weibull distribution

lines(x_SOAF_dbh, y_SOAF_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SOAF_dbh, y_SOAF_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SOAF_dbh, y_SOAF_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SOAF_dbh, y_SOAF_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SOAF_dbh, y_SOAF_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SOAF_dbh, y_SOAF_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SOAF", bty="n",cex=1.5)

#### Trophis caucana
BCI_TRCA = subset(bci_2015_live,Latin=="Trophis caucana")
x_TRCA = BCI_TRCA$DBH/min(BCI_TRCA$DBH)
length(x_TRCA)
x_TRCA_dbh = seq(min(x_TRCA),max(x_TRCA),length=10*length(x_TRCA))
result_TRCA = subset(result_bci_sp_all,Latin=="Trophis caucana")

plot(sort(x_TRCA, decreasing=TRUE), 1:length(x_TRCA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TRCA), max(x_TRCA)), ylim = c(1, length(x_TRCA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TRCA = function(x){
  b_pop = result_TRCA$b_pmete
  n_pop = result_TRCA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TRCA = function(x){
  b_pop = 2
  n_pop = result_TRCA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TRCA = function(x){
  al_pop = result_TRCA$p1_qwei
  be_pop = result_TRCA$p2_qwei
  ga_pop = result_TRCA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TRCA_PMETE = (1-cumsum(fx_TRCA(x_TRCA_dbh)*(max(x_TRCA)-min(x_TRCA))/length(x_TRCA_dbh)))*length(x_TRCA) # parametrized mete prediction
y_TRCA_METE = (1-cumsum(gx_TRCA(x_TRCA_dbh)*(max(x_TRCA)-min(x_TRCA))/length(x_TRCA_dbh)))*length(x_TRCA) # mete prediction
y_TRCA_EXP = exp(-(result_TRCA$p_exp)*(x_TRCA_dbh-min(x_TRCA_dbh)))*length(x_TRCA)  # exponential distribution
y_TRCA_POW = ((x_TRCA_dbh)^(-(result_TRCA$p_pow)))*length(x_TRCA) # power function distribution
y_TRCA_WEI = (exp(1/((result_TRCA$p1_wei)^(result_TRCA$p2_wei))-(x_TRCA_dbh/(result_TRCA$p1_wei))^(result_TRCA$p2_wei)))*length(x_TRCA) # Weibull distribution
y_TRCA_QWEI = (1-cumsum(qwei_TRCA(x_TRCA_dbh)*(max(x_TRCA)-min(x_TRCA))/length(x_TRCA_dbh)))*length(x_TRCA) # quasi_Weibull distribution

lines(x_TRCA_dbh, y_TRCA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TRCA_dbh, y_TRCA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TRCA_dbh, y_TRCA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TRCA_dbh, y_TRCA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TRCA_dbh, y_TRCA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TRCA_dbh, y_TRCA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TRCA", bty="n",cex=1.5)

#### Trophis racemosa
BCI_TRRA = subset(bci_2015_live,Latin=="Trophis racemosa")
x_TRRA = BCI_TRRA$DBH/min(BCI_TRRA$DBH)
length(x_TRRA)
x_TRRA_dbh = seq(min(x_TRRA),max(x_TRRA),length=10*length(x_TRRA))
result_TRRA = subset(result_bci_sp_all,Latin=="Trophis racemosa")

plot(sort(x_TRRA, decreasing=TRUE), 1:length(x_TRRA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TRRA), max(x_TRRA)), ylim = c(1, length(x_TRRA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TRRA = function(x){
  b_pop = result_TRRA$b_pmete
  n_pop = result_TRRA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TRRA = function(x){
  b_pop = 2
  n_pop = result_TRRA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TRRA = function(x){
  al_pop = result_TRRA$p1_qwei
  be_pop = result_TRRA$p2_qwei
  ga_pop = result_TRRA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TRRA_PMETE = (1-cumsum(fx_TRRA(x_TRRA_dbh)*(max(x_TRRA)-min(x_TRRA))/length(x_TRRA_dbh)))*length(x_TRRA) # parametrized mete prediction
y_TRRA_METE = (1-cumsum(gx_TRRA(x_TRRA_dbh)*(max(x_TRRA)-min(x_TRRA))/length(x_TRRA_dbh)))*length(x_TRRA) # mete prediction
y_TRRA_EXP = exp(-(result_TRRA$p_exp)*(x_TRRA_dbh-min(x_TRRA_dbh)))*length(x_TRRA)  # exponential distribution
y_TRRA_POW = ((x_TRRA_dbh)^(-(result_TRRA$p_pow)))*length(x_TRRA) # power function distribution
y_TRRA_WEI = (exp(1/((result_TRRA$p1_wei)^(result_TRRA$p2_wei))-(x_TRRA_dbh/(result_TRRA$p1_wei))^(result_TRRA$p2_wei)))*length(x_TRRA) # Weibull distribution
y_TRRA_QWEI = (1-cumsum(qwei_TRRA(x_TRRA_dbh)*(max(x_TRRA)-min(x_TRRA))/length(x_TRRA_dbh)))*length(x_TRRA) # quasi_Weibull distribution

lines(x_TRRA_dbh, y_TRRA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TRRA_dbh, y_TRRA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TRRA_dbh, y_TRRA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TRRA_dbh, y_TRRA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TRRA_dbh, y_TRRA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TRRA_dbh, y_TRRA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TRRA", bty="n",cex=1.5)
```
### BCI (Order=Santalales)
```{r}
par(mfrow=c(1,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Heisteria acuminata
BCI_HEAC = subset(bci_2015_live,Latin=="Heisteria acuminata")
x_HEAC = BCI_HEAC$DBH/min(BCI_HEAC$DBH)
length(x_HEAC)
x_HEAC_dbh = seq(min(x_HEAC),max(x_HEAC),length=10*length(x_HEAC))
result_HEAC = subset(result_bci_sp_all,Latin=="Heisteria acuminata")

plot(sort(x_HEAC, decreasing=TRUE), 1:length(x_HEAC), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HEAC), max(x_HEAC)), ylim = c(1, length(x_HEAC)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_HEAC = function(x){
  b_pop = result_HEAC$b_pmete
  n_pop = result_HEAC$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HEAC = function(x){
  b_pop = 2
  n_pop = result_HEAC$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HEAC = function(x){
  al_pop = result_HEAC$p1_qwei
  be_pop = result_HEAC$p2_qwei
  ga_pop = result_HEAC$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HEAC_PMETE = (1-cumsum(fx_HEAC(x_HEAC_dbh)*(max(x_HEAC)-min(x_HEAC))/length(x_HEAC_dbh)))*length(x_HEAC) # parametrized mete prediction
y_HEAC_METE = (1-cumsum(gx_HEAC(x_HEAC_dbh)*(max(x_HEAC)-min(x_HEAC))/length(x_HEAC_dbh)))*length(x_HEAC) # mete prediction
y_HEAC_EXP = exp(-(result_HEAC$p_exp)*(x_HEAC_dbh-min(x_HEAC_dbh)))*length(x_HEAC)  # exponential distribution
y_HEAC_POW = ((x_HEAC_dbh)^(-(result_HEAC$p_pow)))*length(x_HEAC) # power function distribution
y_HEAC_WEI = (exp(1/((result_HEAC$p1_wei)^(result_HEAC$p2_wei))-(x_HEAC_dbh/(result_HEAC$p1_wei))^(result_HEAC$p2_wei)))*length(x_HEAC) # Weibull distribution
y_HEAC_QWEI = (1-cumsum(qwei_HEAC(x_HEAC_dbh)*(max(x_HEAC)-min(x_HEAC))/length(x_HEAC_dbh)))*length(x_HEAC) # quasi_Weibull distribution

lines(x_HEAC_dbh, y_HEAC_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HEAC_dbh, y_HEAC_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HEAC_dbh, y_HEAC_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HEAC_dbh, y_HEAC_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HEAC_dbh, y_HEAC_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HEAC_dbh, y_HEAC_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HEAC", bty="n",cex=1.5)

#### Heisteria concinna
BCI_HECO = subset(bci_2015_live,Latin=="Heisteria concinna")
x_HECO = BCI_HECO$DBH/min(BCI_HECO$DBH)
length(x_HECO)
x_HECO_dbh = seq(min(x_HECO),max(x_HECO),length=10*length(x_HECO))
result_HECO = subset(result_bci_sp_all,Latin=="Heisteria concinna")

plot(sort(x_HECO, decreasing=TRUE), 1:length(x_HECO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_HECO), max(x_HECO)), ylim = c(1, length(x_HECO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_HECO = function(x){
  b_pop = result_HECO$b_pmete
  n_pop = result_HECO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_HECO = function(x){
  b_pop = 2
  n_pop = result_HECO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_HECO = function(x){
  al_pop = result_HECO$p1_qwei
  be_pop = result_HECO$p2_qwei
  ga_pop = result_HECO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_HECO_PMETE = (1-cumsum(fx_HECO(x_HECO_dbh)*(max(x_HECO)-min(x_HECO))/length(x_HECO_dbh)))*length(x_HECO) # parametrized mete p#CC79A7iction
y_HECO_METE = (1-cumsum(gx_HECO(x_HECO_dbh)*(max(x_HECO)-min(x_HECO))/length(x_HECO_dbh)))*length(x_HECO) # mete prediction
y_HECO_EXP = exp(-(result_HECO$p_exp)*(x_HECO_dbh-min(x_HECO_dbh)))*length(x_HECO)  # exponential distribution
y_HECO_POW = ((x_HECO_dbh)^(-(result_HECO$p_pow)))*length(x_HECO) # power function distribution
y_HECO_WEI = (exp(1/((result_HECO$p1_wei)^(result_HECO$p2_wei))-(x_HECO_dbh/(result_HECO$p1_wei))^(result_HECO$p2_wei)))*length(x_HECO) # Weibull distribution
y_HECO_QWEI = (1-cumsum(qwei_HECO(x_HECO_dbh)*(max(x_HECO)-min(x_HECO))/length(x_HECO_dbh)))*length(x_HECO) # quasi_Weibull distribution

lines(x_HECO_dbh, y_HECO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_HECO_dbh, y_HECO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_HECO_dbh, y_HECO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_HECO_dbh, y_HECO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_HECO_dbh, y_HECO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_HECO_dbh, y_HECO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "HECO", bty="n",cex=1.5)
```
### BCI (Order=Sapindales)
```{r}
par(mfrow=c(4,5),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Allophylus psilospermus
BCI_ALPS = subset(bci_2015_live,Latin=="Allophylus psilospermus")
x_ALPS = BCI_ALPS$DBH/min(BCI_ALPS$DBH)
length(x_ALPS)
x_ALPS_dbh = seq(min(x_ALPS),max(x_ALPS),length=10*length(x_ALPS))
result_ALPS = subset(result_bci_sp_all,Latin=="Allophylus psilospermus")

plot(sort(x_ALPS, decreasing=TRUE), 1:length(x_ALPS), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ALPS), max(x_ALPS)), ylim = c(1, length(x_ALPS)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ALPS = function(x){
  b_pop = result_ALPS$b_pmete
  n_pop = result_ALPS$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ALPS = function(x){
  b_pop = 2
  n_pop = result_ALPS$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ALPS = function(x){
  al_pop = result_ALPS$p1_qwei
  be_pop = result_ALPS$p2_qwei
  ga_pop = result_ALPS$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ALPS_PMETE = (1-cumsum(fx_ALPS(x_ALPS_dbh)*(max(x_ALPS)-min(x_ALPS))/length(x_ALPS_dbh)))*length(x_ALPS) # parametrized mete prediction
y_ALPS_METE = (1-cumsum(gx_ALPS(x_ALPS_dbh)*(max(x_ALPS)-min(x_ALPS))/length(x_ALPS_dbh)))*length(x_ALPS) # mete prediction
y_ALPS_EXP = exp(-(result_ALPS$p_exp)*(x_ALPS_dbh-min(x_ALPS_dbh)))*length(x_ALPS)  # exponential distribution
y_ALPS_POW = ((x_ALPS_dbh)^(-(result_ALPS$p_pow)))*length(x_ALPS) # power function distribution
y_ALPS_WEI = (exp(1/((result_ALPS$p1_wei)^(result_ALPS$p2_wei))-(x_ALPS_dbh/(result_ALPS$p1_wei))^(result_ALPS$p2_wei)))*length(x_ALPS) # Weibull distribution
y_ALPS_QWEI = (1-cumsum(qwei_ALPS(x_ALPS_dbh)*(max(x_ALPS)-min(x_ALPS))/length(x_ALPS_dbh)))*length(x_ALPS) # quasi_Weibull distribution

lines(x_ALPS_dbh, y_ALPS_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ALPS_dbh, y_ALPS_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ALPS_dbh, y_ALPS_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ALPS_dbh, y_ALPS_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ALPS_dbh, y_ALPS_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ALPS_dbh, y_ALPS_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ALPS", bty="n",cex=1.5)

#### Astronium graveolens
BCI_ASGR = subset(bci_2015_live,Latin=="Astronium graveolens")
x_ASGR = BCI_ASGR$DBH/min(BCI_ASGR$DBH)
length(x_ASGR)
x_ASGR_dbh = seq(min(x_ASGR),max(x_ASGR),length=10*length(x_ASGR))
result_ASGR = subset(result_bci_sp_all,Latin=="Astronium graveolens")

plot(sort(x_ASGR, decreasing=TRUE), 1:length(x_ASGR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ASGR), max(x_ASGR)), ylim = c(1, length(x_ASGR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ASGR = function(x){
  b_pop = result_ASGR$b_pmete
  n_pop = result_ASGR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ASGR = function(x){
  b_pop = 2
  n_pop = result_ASGR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ASGR = function(x){
  al_pop = result_ASGR$p1_qwei
  be_pop = result_ASGR$p2_qwei
  ga_pop = result_ASGR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ASGR_PMETE = (1-cumsum(fx_ASGR(x_ASGR_dbh)*(max(x_ASGR)-min(x_ASGR))/length(x_ASGR_dbh)))*length(x_ASGR) # parametrized mete prediction
y_ASGR_METE = (1-cumsum(gx_ASGR(x_ASGR_dbh)*(max(x_ASGR)-min(x_ASGR))/length(x_ASGR_dbh)))*length(x_ASGR) # mete prediction
y_ASGR_EXP = exp(-(result_ASGR$p_exp)*(x_ASGR_dbh-min(x_ASGR_dbh)))*length(x_ASGR)  # exponential distribution
y_ASGR_POW = ((x_ASGR_dbh)^(-(result_ASGR$p_pow)))*length(x_ASGR) # power function distribution
y_ASGR_WEI = (exp(1/((result_ASGR$p1_wei)^(result_ASGR$p2_wei))-(x_ASGR_dbh/(result_ASGR$p1_wei))^(result_ASGR$p2_wei)))*length(x_ASGR) # Weibull distribution
y_ASGR_QWEI = (1-cumsum(qwei_ASGR(x_ASGR_dbh)*(max(x_ASGR)-min(x_ASGR))/length(x_ASGR_dbh)))*length(x_ASGR) # quasi_Weibull distribution

lines(x_ASGR_dbh, y_ASGR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ASGR_dbh, y_ASGR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ASGR_dbh, y_ASGR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ASGR_dbh, y_ASGR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ASGR_dbh, y_ASGR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ASGR_dbh, y_ASGR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ASGR", bty="n",cex=1.5)

#### Cupania rufescens
BCI_CURU = subset(bci_2015_live,Latin=="Cupania rufescens")
x_CURU = BCI_CURU$DBH/min(BCI_CURU$DBH)
length(x_CURU)
x_CURU_dbh = seq(min(x_CURU),max(x_CURU),length=10*length(x_CURU))
result_CURU = subset(result_bci_sp_all,Latin=="Cupania rufescens")

plot(sort(x_CURU, decreasing=TRUE), 1:length(x_CURU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CURU), max(x_CURU)), ylim = c(1, length(x_CURU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CURU = function(x){
  b_pop = result_CURU$b_pmete
  n_pop = result_CURU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CURU = function(x){
  b_pop = 2
  n_pop = result_CURU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CURU = function(x){
  al_pop = result_CURU$p1_qwei
  be_pop = result_CURU$p2_qwei
  ga_pop = result_CURU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CURU_PMETE = (1-cumsum(fx_CURU(x_CURU_dbh)*(max(x_CURU)-min(x_CURU))/length(x_CURU_dbh)))*length(x_CURU) # parametrized mete prediction
y_CURU_METE = (1-cumsum(gx_CURU(x_CURU_dbh)*(max(x_CURU)-min(x_CURU))/length(x_CURU_dbh)))*length(x_CURU) # mete prediction
y_CURU_EXP = exp(-(result_CURU$p_exp)*(x_CURU_dbh-min(x_CURU_dbh)))*length(x_CURU)  # exponential distribution
y_CURU_POW = ((x_CURU_dbh)^(-(result_CURU$p_pow)))*length(x_CURU) # power function distribution
y_CURU_WEI = (exp(1/((result_CURU$p1_wei)^(result_CURU$p2_wei))-(x_CURU_dbh/(result_CURU$p1_wei))^(result_CURU$p2_wei)))*length(x_CURU) # Weibull distribution
y_CURU_QWEI = (1-cumsum(qwei_CURU(x_CURU_dbh)*(max(x_CURU)-min(x_CURU))/length(x_CURU_dbh)))*length(x_CURU) # quasi_Weibull distribution

lines(x_CURU_dbh, y_CURU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CURU_dbh, y_CURU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CURU_dbh, y_CURU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CURU_dbh, y_CURU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CURU_dbh, y_CURU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CURU_dbh, y_CURU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CURU", bty="n",cex=1.5)

#### Cupania seemannii
BCI_CUSE = subset(bci_2015_live,Latin=="Cupania seemannii")
x_CUSE = BCI_CUSE$DBH/min(BCI_CUSE$DBH)
length(x_CUSE)
x_CUSE_dbh = seq(min(x_CUSE),max(x_CUSE),length=10*length(x_CUSE))
result_CUSE = subset(result_bci_sp_all,Latin=="Cupania seemannii")

plot(sort(x_CUSE, decreasing=TRUE), 1:length(x_CUSE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CUSE), max(x_CUSE)), ylim = c(1, length(x_CUSE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CUSE = function(x){
  b_pop = result_CUSE$b_pmete
  n_pop = result_CUSE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CUSE = function(x){
  b_pop = 2
  n_pop = result_CUSE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CUSE = function(x){
  al_pop = result_CUSE$p1_qwei
  be_pop = result_CUSE$p2_qwei
  ga_pop = result_CUSE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CUSE_PMETE = (1-cumsum(fx_CUSE(x_CUSE_dbh)*(max(x_CUSE)-min(x_CUSE))/length(x_CUSE_dbh)))*length(x_CUSE) # parametrized mete prediction
y_CUSE_METE = (1-cumsum(gx_CUSE(x_CUSE_dbh)*(max(x_CUSE)-min(x_CUSE))/length(x_CUSE_dbh)))*length(x_CUSE) # mete prediction
y_CUSE_EXP = exp(-(result_CUSE$p_exp)*(x_CUSE_dbh-min(x_CUSE_dbh)))*length(x_CUSE)  # exponential distribution
y_CUSE_POW = ((x_CUSE_dbh)^(-(result_CUSE$p_pow)))*length(x_CUSE) # power function distribution
y_CUSE_WEI = (exp(1/((result_CUSE$p1_wei)^(result_CUSE$p2_wei))-(x_CUSE_dbh/(result_CUSE$p1_wei))^(result_CUSE$p2_wei)))*length(x_CUSE) # Weibull distribution
y_CUSE_QWEI = (1-cumsum(qwei_CUSE(x_CUSE_dbh)*(max(x_CUSE)-min(x_CUSE))/length(x_CUSE_dbh)))*length(x_CUSE) # quasi_Weibull distribution

lines(x_CUSE_dbh, y_CUSE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CUSE_dbh, y_CUSE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CUSE_dbh, y_CUSE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CUSE_dbh, y_CUSE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CUSE_dbh, y_CUSE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CUSE_dbh, y_CUSE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CUSE", bty="n",cex=1.5)

#### Guarea bullata
BCI_GUBU = subset(bci_2015_live,Latin=="Guarea bullata")
x_GUBU = BCI_GUBU$DBH/min(BCI_GUBU$DBH)
length(x_GUBU)
x_GUBU_dbh = seq(min(x_GUBU),max(x_GUBU),length=10*length(x_GUBU))
result_GUBU = subset(result_bci_sp_all,Latin=="Guarea bullata")

plot(sort(x_GUBU, decreasing=TRUE), 1:length(x_GUBU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUBU), max(x_GUBU)), ylim = c(1, length(x_GUBU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUBU = function(x){
  b_pop = result_GUBU$b_pmete
  n_pop = result_GUBU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUBU = function(x){
  b_pop = 2
  n_pop = result_GUBU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUBU = function(x){
  al_pop = result_GUBU$p1_qwei
  be_pop = result_GUBU$p2_qwei
  ga_pop = result_GUBU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUBU_PMETE = (1-cumsum(fx_GUBU(x_GUBU_dbh)*(max(x_GUBU)-min(x_GUBU))/length(x_GUBU_dbh)))*length(x_GUBU) # parametrized mete prediction
y_GUBU_METE = (1-cumsum(gx_GUBU(x_GUBU_dbh)*(max(x_GUBU)-min(x_GUBU))/length(x_GUBU_dbh)))*length(x_GUBU) # mete prediction
y_GUBU_EXP = exp(-(result_GUBU$p_exp)*(x_GUBU_dbh-min(x_GUBU_dbh)))*length(x_GUBU)  # exponential distribution
y_GUBU_POW = ((x_GUBU_dbh)^(-(result_GUBU$p_pow)))*length(x_GUBU) # power function distribution
y_GUBU_WEI = (exp(1/((result_GUBU$p1_wei)^(result_GUBU$p2_wei))-(x_GUBU_dbh/(result_GUBU$p1_wei))^(result_GUBU$p2_wei)))*length(x_GUBU) # Weibull distribution
y_GUBU_QWEI = (1-cumsum(qwei_GUBU(x_GUBU_dbh)*(max(x_GUBU)-min(x_GUBU))/length(x_GUBU_dbh)))*length(x_GUBU) # quasi_Weibull distribution

lines(x_GUBU_dbh, y_GUBU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUBU_dbh, y_GUBU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUBU_dbh, y_GUBU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUBU_dbh, y_GUBU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUBU_dbh, y_GUBU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUBU_dbh, y_GUBU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUBU", bty="n",cex=1.5)

#### Guarea guidonia
BCI_GUGU = subset(bci_2015_live,Latin=="Guarea guidonia")
x_GUGU = BCI_GUGU$DBH/min(BCI_GUGU$DBH)
length(x_GUGU)
x_GUGU_dbh = seq(min(x_GUGU),max(x_GUGU),length=10*length(x_GUGU))
result_GUGU = subset(result_bci_sp_all,Latin=="Guarea guidonia")

plot(sort(x_GUGU, decreasing=TRUE), 1:length(x_GUGU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_GUGU), max(x_GUGU)), ylim = c(1, length(x_GUGU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_GUGU = function(x){
  b_pop = result_GUGU$b_pmete
  n_pop = result_GUGU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_GUGU = function(x){
  b_pop = 2
  n_pop = result_GUGU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_GUGU = function(x){
  al_pop = result_GUGU$p1_qwei
  be_pop = result_GUGU$p2_qwei
  ga_pop = result_GUGU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_GUGU_PMETE = (1-cumsum(fx_GUGU(x_GUGU_dbh)*(max(x_GUGU)-min(x_GUGU))/length(x_GUGU_dbh)))*length(x_GUGU) # parametrized mete prediction
y_GUGU_METE = (1-cumsum(gx_GUGU(x_GUGU_dbh)*(max(x_GUGU)-min(x_GUGU))/length(x_GUGU_dbh)))*length(x_GUGU) # mete prediction
y_GUGU_EXP = exp(-(result_GUGU$p_exp)*(x_GUGU_dbh-min(x_GUGU_dbh)))*length(x_GUGU)  # exponential distribution
y_GUGU_POW = ((x_GUGU_dbh)^(-(result_GUGU$p_pow)))*length(x_GUGU) # power function distribution
y_GUGU_WEI = (exp(1/((result_GUGU$p1_wei)^(result_GUGU$p2_wei))-(x_GUGU_dbh/(result_GUGU$p1_wei))^(result_GUGU$p2_wei)))*length(x_GUGU) # Weibull distribution
y_GUGU_QWEI = (1-cumsum(qwei_GUGU(x_GUGU_dbh)*(max(x_GUGU)-min(x_GUGU))/length(x_GUGU_dbh)))*length(x_GUGU) # quasi_Weibull distribution

lines(x_GUGU_dbh, y_GUGU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_GUGU_dbh, y_GUGU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_GUGU_dbh, y_GUGU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_GUGU_dbh, y_GUGU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_GUGU_dbh, y_GUGU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_GUGU_dbh, y_GUGU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "GUGU", bty="n",cex=1.5)

#### Protium costaricense
BCI_PRCO = subset(bci_2015_live,Latin=="Protium costaricense")
x_PRCO = BCI_PRCO$DBH/min(BCI_PRCO$DBH)
length(x_PRCO)
x_PRCO_dbh = seq(min(x_PRCO),max(x_PRCO),length=10*length(x_PRCO))
result_PRCO = subset(result_bci_sp_all,Latin=="Protium costaricense")

plot(sort(x_PRCO, decreasing=TRUE), 1:length(x_PRCO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PRCO), max(x_PRCO)), ylim = c(1, length(x_PRCO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PRCO = function(x){
  b_pop = result_PRCO$b_pmete
  n_pop = result_PRCO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PRCO = function(x){
  b_pop = 2
  n_pop = result_PRCO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PRCO = function(x){
  al_pop = result_PRCO$p1_qwei
  be_pop = result_PRCO$p2_qwei
  ga_pop = result_PRCO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PRCO_PMETE = (1-cumsum(fx_PRCO(x_PRCO_dbh)*(max(x_PRCO)-min(x_PRCO))/length(x_PRCO_dbh)))*length(x_PRCO) # parametrized mete prediction
y_PRCO_METE = (1-cumsum(gx_PRCO(x_PRCO_dbh)*(max(x_PRCO)-min(x_PRCO))/length(x_PRCO_dbh)))*length(x_PRCO) # mete prediction
y_PRCO_EXP = exp(-(result_PRCO$p_exp)*(x_PRCO_dbh-min(x_PRCO_dbh)))*length(x_PRCO)  # exponential distribution
y_PRCO_POW = ((x_PRCO_dbh)^(-(result_PRCO$p_pow)))*length(x_PRCO) # power function distribution
y_PRCO_WEI = (exp(1/((result_PRCO$p1_wei)^(result_PRCO$p2_wei))-(x_PRCO_dbh/(result_PRCO$p1_wei))^(result_PRCO$p2_wei)))*length(x_PRCO) # Weibull distribution
y_PRCO_QWEI = (1-cumsum(qwei_PRCO(x_PRCO_dbh)*(max(x_PRCO)-min(x_PRCO))/length(x_PRCO_dbh)))*length(x_PRCO) # quasi_Weibull distribution

lines(x_PRCO_dbh, y_PRCO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PRCO_dbh, y_PRCO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PRCO", bty="n",cex=1.5)

#### Protium panamense
BCI_PRPA = subset(bci_2015_live,Latin=="Protium panamense")
x_PRPA = BCI_PRPA$DBH/min(BCI_PRPA$DBH)
length(x_PRPA)
x_PRPA_dbh = seq(min(x_PRPA),max(x_PRPA),length=10*length(x_PRPA))
result_PRPA = subset(result_bci_sp_all,Latin=="Protium panamense")

plot(sort(x_PRPA, decreasing=TRUE), 1:length(x_PRPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PRPA), max(x_PRPA)), ylim = c(1, length(x_PRPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PRPA = function(x){
  b_pop = result_PRPA$b_pmete
  n_pop = result_PRPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PRPA = function(x){
  b_pop = 2
  n_pop = result_PRPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PRPA = function(x){
  al_pop = result_PRPA$p1_qwei
  be_pop = result_PRPA$p2_qwei
  ga_pop = result_PRPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PRPA_PMETE = (1-cumsum(fx_PRPA(x_PRPA_dbh)*(max(x_PRPA)-min(x_PRPA))/length(x_PRPA_dbh)))*length(x_PRPA) # parametrized mete prediction
y_PRPA_METE = (1-cumsum(gx_PRPA(x_PRPA_dbh)*(max(x_PRPA)-min(x_PRPA))/length(x_PRPA_dbh)))*length(x_PRPA) # mete prediction
y_PRPA_EXP = exp(-(result_PRPA$p_exp)*(x_PRPA_dbh-min(x_PRPA_dbh)))*length(x_PRPA)  # exponential distribution
y_PRPA_POW = ((x_PRPA_dbh)^(-(result_PRPA$p_pow)))*length(x_PRPA) # power function distribution
y_PRPA_WEI = (exp(1/((result_PRPA$p1_wei)^(result_PRPA$p2_wei))-(x_PRPA_dbh/(result_PRPA$p1_wei))^(result_PRPA$p2_wei)))*length(x_PRPA) # Weibull distribution
y_PRPA_QWEI = (1-cumsum(qwei_PRPA(x_PRPA_dbh)*(max(x_PRPA)-min(x_PRPA))/length(x_PRPA_dbh)))*length(x_PRPA) # quasi_Weibull distribution

lines(x_PRPA_dbh, y_PRPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PRPA_dbh, y_PRPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PRPA_dbh, y_PRPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PRPA_dbh, y_PRPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PRPA_dbh, y_PRPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PRPA_dbh, y_PRPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PRPA", bty="n",cex=1.5)

#### Protium tenuifolium
BCI_PRTE = subset(bci_2015_live,Latin=="Protium tenuifolium")
x_PRTE = BCI_PRTE$DBH/min(BCI_PRTE$DBH)
length(x_PRTE)
x_PRTE_dbh = seq(min(x_PRTE),max(x_PRTE),length=10*length(x_PRTE))
result_PRTE = subset(result_bci_sp_all,Latin=="Protium tenuifolium")

plot(sort(x_PRTE, decreasing=TRUE), 1:length(x_PRTE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_PRTE), max(x_PRTE)), ylim = c(1, length(x_PRTE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_PRTE = function(x){
  b_pop = result_PRTE$b_pmete
  n_pop = result_PRTE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_PRTE = function(x){
  b_pop = 2
  n_pop = result_PRTE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_PRTE = function(x){
  al_pop = result_PRTE$p1_qwei
  be_pop = result_PRTE$p2_qwei
  ga_pop = result_PRTE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_PRTE_PMETE = (1-cumsum(fx_PRTE(x_PRTE_dbh)*(max(x_PRTE)-min(x_PRTE))/length(x_PRTE_dbh)))*length(x_PRTE) # parametrized mete prediction
y_PRTE_METE = (1-cumsum(gx_PRTE(x_PRTE_dbh)*(max(x_PRTE)-min(x_PRTE))/length(x_PRTE_dbh)))*length(x_PRTE) # mete prediction
y_PRTE_EXP = exp(-(result_PRTE$p_exp)*(x_PRTE_dbh-min(x_PRTE_dbh)))*length(x_PRTE)  # exponential distribution
y_PRTE_POW = ((x_PRTE_dbh)^(-(result_PRTE$p_pow)))*length(x_PRTE) # power function distribution
y_PRTE_WEI = (exp(1/((result_PRTE$p1_wei)^(result_PRTE$p2_wei))-(x_PRTE_dbh/(result_PRTE$p1_wei))^(result_PRTE$p2_wei)))*length(x_PRTE) # Weibull distribution
y_PRTE_QWEI = (1-cumsum(qwei_PRTE(x_PRTE_dbh)*(max(x_PRTE)-min(x_PRTE))/length(x_PRTE_dbh)))*length(x_PRTE) # quasi_Weibull distribution

lines(x_PRTE_dbh, y_PRTE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_PRTE_dbh, y_PRTE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_PRTE_dbh, y_PRTE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_PRTE_dbh, y_PRTE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_PRTE_dbh, y_PRTE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_PRTE_dbh, y_PRTE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "PRTE", bty="n",cex=1.5)

#### Quassia amara
BCI_QUAM = subset(bci_2015_live,Latin=="Quassia amara")
x_QUAM = BCI_QUAM$DBH/min(BCI_QUAM$DBH)
length(x_QUAM)
x_QUAM_dbh = seq(min(x_QUAM),max(x_QUAM),length=10*length(x_QUAM))
result_QUAM = subset(result_bci_sp_all,Latin=="Quassia amara")

plot(sort(x_QUAM, decreasing=TRUE), 1:length(x_QUAM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_QUAM), max(x_QUAM)), ylim = c(1, length(x_QUAM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_QUAM = function(x){
  b_pop = result_QUAM$b_pmete
  n_pop = result_QUAM$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_QUAM = function(x){
  b_pop = 2
  n_pop = result_QUAM$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_QUAM = function(x){
  al_pop = result_QUAM$p1_qwei
  be_pop = result_QUAM$p2_qwei
  ga_pop = result_QUAM$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_QUAM_PMETE = (1-cumsum(fx_QUAM(x_QUAM_dbh)*(max(x_QUAM)-min(x_QUAM))/length(x_QUAM_dbh)))*length(x_QUAM) # parametrized mete prediction
y_QUAM_METE = (1-cumsum(gx_QUAM(x_QUAM_dbh)*(max(x_QUAM)-min(x_QUAM))/length(x_QUAM_dbh)))*length(x_QUAM) # mete prediction
y_QUAM_EXP = exp(-(result_QUAM$p_exp)*(x_QUAM_dbh-min(x_QUAM_dbh)))*length(x_QUAM)  # exponential distribution
y_QUAM_POW = ((x_QUAM_dbh)^(-(result_QUAM$p_pow)))*length(x_QUAM) # power function distribution
y_QUAM_WEI = (exp(1/((result_QUAM$p1_wei)^(result_QUAM$p2_wei))-(x_QUAM_dbh/(result_QUAM$p1_wei))^(result_QUAM$p2_wei)))*length(x_QUAM) # Weibull distribution
y_QUAM_QWEI = (1-cumsum(qwei_QUAM(x_QUAM_dbh)*(max(x_QUAM)-min(x_QUAM))/length(x_QUAM_dbh)))*length(x_QUAM) # quasi_Weibull distribution

lines(x_QUAM_dbh, y_QUAM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_QUAM_dbh, y_QUAM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_QUAM_dbh, y_QUAM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_QUAM_dbh, y_QUAM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_QUAM_dbh, y_QUAM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_QUAM_dbh, y_QUAM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "QUAM", bty="n",cex=1.5)

#### Simarouba amara
BCI_SIAM = subset(bci_2015_live,Latin=="Simarouba amara")
x_SIAM = BCI_SIAM$DBH/min(BCI_SIAM$DBH)
length(x_SIAM)
x_SIAM_dbh = seq(min(x_SIAM),max(x_SIAM),length=10*length(x_SIAM))
result_SIAM = subset(result_bci_sp_all,Latin=="Simarouba amara")

plot(sort(x_SIAM, decreasing=TRUE), 1:length(x_SIAM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SIAM), max(x_SIAM)), ylim = c(1, length(x_SIAM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SIAM = function(x){
  b_pop = result_SIAM$b_pmete
  n_pop = result_SIAM$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SIAM = function(x){
  b_pop = 2
  n_pop = result_SIAM$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SIAM = function(x){
  al_pop = result_SIAM$p1_qwei
  be_pop = result_SIAM$p2_qwei
  ga_pop = result_SIAM$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SIAM_PMETE = (1-cumsum(fx_SIAM(x_SIAM_dbh)*(max(x_SIAM)-min(x_SIAM))/length(x_SIAM_dbh)))*length(x_SIAM) # parametrized mete prediction
y_SIAM_METE = (1-cumsum(gx_SIAM(x_SIAM_dbh)*(max(x_SIAM)-min(x_SIAM))/length(x_SIAM_dbh)))*length(x_SIAM) # mete prediction
y_SIAM_EXP = exp(-(result_SIAM$p_exp)*(x_SIAM_dbh-min(x_SIAM_dbh)))*length(x_SIAM)  # exponential distribution
y_SIAM_POW = ((x_SIAM_dbh)^(-(result_SIAM$p_pow)))*length(x_SIAM) # power function distribution
y_SIAM_WEI = (exp(1/((result_SIAM$p1_wei)^(result_SIAM$p2_wei))-(x_SIAM_dbh/(result_SIAM$p1_wei))^(result_SIAM$p2_wei)))*length(x_SIAM) # Weibull distribution
y_SIAM_QWEI = (1-cumsum(qwei_SIAM(x_SIAM_dbh)*(max(x_SIAM)-min(x_SIAM))/length(x_SIAM_dbh)))*length(x_SIAM) # quasi_Weibull distribution

lines(x_SIAM_dbh, y_SIAM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SIAM_dbh, y_SIAM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SIAM_dbh, y_SIAM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SIAM_dbh, y_SIAM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SIAM_dbh, y_SIAM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SIAM_dbh, y_SIAM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SIAM", bty="n",cex=1.5)

#### Spondias mombin
BCI_SPMO = subset(bci_2015_live,Latin=="Spondias mombin")
x_SPMO = BCI_SPMO$DBH/min(BCI_SPMO$DBH)
length(x_SPMO)
x_SPMO_dbh = seq(min(x_SPMO),max(x_SPMO),length=10*length(x_SPMO))
result_SPMO = subset(result_bci_sp_all,Latin=="Spondias mombin")

plot(sort(x_SPMO, decreasing=TRUE), 1:length(x_SPMO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SPMO), max(x_SPMO)), ylim = c(1, length(x_SPMO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SPMO = function(x){
  b_pop = result_SPMO$b_pmete
  n_pop = result_SPMO$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SPMO = function(x){
  b_pop = 2
  n_pop = result_SPMO$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SPMO = function(x){
  al_pop = result_SPMO$p1_qwei
  be_pop = result_SPMO$p2_qwei
  ga_pop = result_SPMO$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SPMO_PMETE = (1-cumsum(fx_SPMO(x_SPMO_dbh)*(max(x_SPMO)-min(x_SPMO))/length(x_SPMO_dbh)))*length(x_SPMO) # parametrized mete prediction
y_SPMO_METE = (1-cumsum(gx_SPMO(x_SPMO_dbh)*(max(x_SPMO)-min(x_SPMO))/length(x_SPMO_dbh)))*length(x_SPMO) # mete prediction
y_SPMO_EXP = exp(-(result_SPMO$p_exp)*(x_SPMO_dbh-min(x_SPMO_dbh)))*length(x_SPMO)  # exponential distribution
y_SPMO_POW = ((x_SPMO_dbh)^(-(result_SPMO$p_pow)))*length(x_SPMO) # power function distribution
y_SPMO_WEI = (exp(1/((result_SPMO$p1_wei)^(result_SPMO$p2_wei))-(x_SPMO_dbh/(result_SPMO$p1_wei))^(result_SPMO$p2_wei)))*length(x_SPMO) # Weibull distribution
y_SPMO_QWEI = (1-cumsum(qwei_SPMO(x_SPMO_dbh)*(max(x_SPMO)-min(x_SPMO))/length(x_SPMO_dbh)))*length(x_SPMO) # quasi_Weibull distribution

lines(x_SPMO_dbh, y_SPMO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SPMO_dbh, y_SPMO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SPMO_dbh, y_SPMO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SPMO_dbh, y_SPMO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SPMO_dbh, y_SPMO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SPMO_dbh, y_SPMO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SPMO", bty="n",cex=1.5)

#### Spondias radlkoferi
BCI_SPRA = subset(bci_2015_live,Latin=="Spondias radlkoferi")
x_SPRA = BCI_SPRA$DBH/min(BCI_SPRA$DBH)
length(x_SPRA)
x_SPRA_dbh = seq(min(x_SPRA),max(x_SPRA),length=10*length(x_SPRA))
result_SPRA = subset(result_bci_sp_all,Latin=="Spondias radlkoferi")

plot(sort(x_SPRA, decreasing=TRUE), 1:length(x_SPRA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SPRA), max(x_SPRA)), ylim = c(1, length(x_SPRA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SPRA = function(x){
  b_pop = result_SPRA$b_pmete
  n_pop = result_SPRA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SPRA = function(x){
  b_pop = 2
  n_pop = result_SPRA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SPRA = function(x){
  al_pop = result_SPRA$p1_qwei
  be_pop = result_SPRA$p2_qwei
  ga_pop = result_SPRA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SPRA_PMETE = (1-cumsum(fx_SPRA(x_SPRA_dbh)*(max(x_SPRA)-min(x_SPRA))/length(x_SPRA_dbh)))*length(x_SPRA) # parametrized mete prediction
y_SPRA_METE = (1-cumsum(gx_SPRA(x_SPRA_dbh)*(max(x_SPRA)-min(x_SPRA))/length(x_SPRA_dbh)))*length(x_SPRA) # mete prediction
y_SPRA_EXP = exp(-(result_SPRA$p_exp)*(x_SPRA_dbh-min(x_SPRA_dbh)))*length(x_SPRA)  # exponential distribution
y_SPRA_POW = ((x_SPRA_dbh)^(-(result_SPRA$p_pow)))*length(x_SPRA) # power function distribution
y_SPRA_WEI = (exp(1/((result_SPRA$p1_wei)^(result_SPRA$p2_wei))-(x_SPRA_dbh/(result_SPRA$p1_wei))^(result_SPRA$p2_wei)))*length(x_SPRA) # Weibull distribution
y_SPRA_QWEI = (1-cumsum(qwei_SPRA(x_SPRA_dbh)*(max(x_SPRA)-min(x_SPRA))/length(x_SPRA_dbh)))*length(x_SPRA) # quasi_Weibull distribution

lines(x_SPRA_dbh, y_SPRA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SPRA_dbh, y_SPRA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SPRA_dbh, y_SPRA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SPRA_dbh, y_SPRA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SPRA_dbh, y_SPRA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SPRA_dbh, y_SPRA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SPRA", bty="n",cex=1.5)

#### Talisia croatii
BCI_TACR = subset(bci_2015_live,Latin=="Talisia croatii")
x_TACR = BCI_TACR$DBH/min(BCI_TACR$DBH)
length(x_TACR)
x_TACR_dbh = seq(min(x_TACR),max(x_TACR),length=10*length(x_TACR))
result_TACR = subset(result_bci_sp_all,Latin=="Talisia croatii")

plot(sort(x_TACR, decreasing=TRUE), 1:length(x_TACR), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TACR), max(x_TACR)), ylim = c(1, length(x_TACR)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TACR = function(x){
  b_pop = result_TACR$b_pmete
  n_pop = result_TACR$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TACR = function(x){
  b_pop = 2
  n_pop = result_TACR$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TACR = function(x){
  al_pop = result_TACR$p1_qwei
  be_pop = result_TACR$p2_qwei
  ga_pop = result_TACR$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TACR_PMETE = (1-cumsum(fx_TACR(x_TACR_dbh)*(max(x_TACR)-min(x_TACR))/length(x_TACR_dbh)))*length(x_TACR) # parametrized mete prediction
y_TACR_METE = (1-cumsum(gx_TACR(x_TACR_dbh)*(max(x_TACR)-min(x_TACR))/length(x_TACR_dbh)))*length(x_TACR) # mete prediction
y_TACR_EXP = exp(-(result_TACR$p_exp)*(x_TACR_dbh-min(x_TACR_dbh)))*length(x_TACR)  # exponential distribution
y_TACR_POW = ((x_TACR_dbh)^(-(result_TACR$p_pow)))*length(x_TACR) # power function distribution
y_TACR_WEI = (exp(1/((result_TACR$p1_wei)^(result_TACR$p2_wei))-(x_TACR_dbh/(result_TACR$p1_wei))^(result_TACR$p2_wei)))*length(x_TACR) # Weibull distribution
y_TACR_QWEI = (1-cumsum(qwei_TACR(x_TACR_dbh)*(max(x_TACR)-min(x_TACR))/length(x_TACR_dbh)))*length(x_TACR) # quasi_Weibull distribution

lines(x_TACR_dbh, y_TACR_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TACR_dbh, y_TACR_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TACR_dbh, y_TACR_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TACR_dbh, y_TACR_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TACR_dbh, y_TACR_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TACR_dbh, y_TACR_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TACR", bty="n",cex=1.5)

#### Talisia nervosa
BCI_TANE = subset(bci_2015_live,Latin=="Talisia nervosa")
x_TANE = BCI_TANE$DBH/min(BCI_TANE$DBH)
length(x_TANE)
x_TANE_dbh = seq(min(x_TANE),max(x_TANE),length=10*length(x_TANE))
result_TANE = subset(result_bci_sp_all,Latin=="Talisia nervosa")

plot(sort(x_TANE, decreasing=TRUE), 1:length(x_TANE), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TANE), max(x_TANE)), ylim = c(1, length(x_TANE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TANE = function(x){
  b_pop = result_TANE$b_pmete
  n_pop = result_TANE$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TANE = function(x){
  b_pop = 2
  n_pop = result_TANE$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TANE = function(x){
  al_pop = result_TANE$p1_qwei
  be_pop = result_TANE$p2_qwei
  ga_pop = result_TANE$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TANE_PMETE = (1-cumsum(fx_TANE(x_TANE_dbh)*(max(x_TANE)-min(x_TANE))/length(x_TANE_dbh)))*length(x_TANE) # parametrized mete prediction
y_TANE_METE = (1-cumsum(gx_TANE(x_TANE_dbh)*(max(x_TANE)-min(x_TANE))/length(x_TANE_dbh)))*length(x_TANE) # mete prediction
y_TANE_EXP = exp(-(result_TANE$p_exp)*(x_TANE_dbh-min(x_TANE_dbh)))*length(x_TANE)  # exponential distribution
y_TANE_POW = ((x_TANE_dbh)^(-(result_TANE$p_pow)))*length(x_TANE) # power function distribution
y_TANE_WEI = (exp(1/((result_TANE$p1_wei)^(result_TANE$p2_wei))-(x_TANE_dbh/(result_TANE$p1_wei))^(result_TANE$p2_wei)))*length(x_TANE) # Weibull distribution
y_TANE_QWEI = (1-cumsum(qwei_TANE(x_TANE_dbh)*(max(x_TANE)-min(x_TANE))/length(x_TANE_dbh)))*length(x_TANE) # quasi_Weibull distribution

lines(x_TANE_dbh, y_TANE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TANE_dbh, y_TANE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TANE_dbh, y_TANE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TANE_dbh, y_TANE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TANE_dbh, y_TANE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TANE_dbh, y_TANE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TANE", bty="n",cex=1.5)

#### Tetragastris panamensis
BCI_TEPA = subset(bci_2015_live,Latin=="Tetragastris panamensis")
x_TEPA = BCI_TEPA$DBH/min(BCI_TEPA$DBH)
length(x_TEPA)
x_TEPA_dbh = seq(min(x_TEPA),max(x_TEPA),length=10*length(x_TEPA))
result_TEPA = subset(result_bci_sp_all,Latin=="Tetragastris panamensis")

plot(sort(x_TEPA, decreasing=TRUE), 1:length(x_TEPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TEPA), max(x_TEPA)), ylim = c(1, length(x_TEPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TEPA = function(x){
  b_pop = result_TEPA$b_pmete
  n_pop = result_TEPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TEPA = function(x){
  b_pop = 2
  n_pop = result_TEPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TEPA = function(x){
  al_pop = result_TEPA$p1_qwei
  be_pop = result_TEPA$p2_qwei
  ga_pop = result_TEPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TEPA_PMETE = (1-cumsum(fx_TEPA(x_TEPA_dbh)*(max(x_TEPA)-min(x_TEPA))/length(x_TEPA_dbh)))*length(x_TEPA) # parametrized mete prediction
y_TEPA_METE = (1-cumsum(gx_TEPA(x_TEPA_dbh)*(max(x_TEPA)-min(x_TEPA))/length(x_TEPA_dbh)))*length(x_TEPA) # mete prediction
y_TEPA_EXP = exp(-(result_TEPA$p_exp)*(x_TEPA_dbh-min(x_TEPA_dbh)))*length(x_TEPA)  # exponential distribution
y_TEPA_POW = ((x_TEPA_dbh)^(-(result_TEPA$p_pow)))*length(x_TEPA) # power function distribution
y_TEPA_WEI = (exp(1/((result_TEPA$p1_wei)^(result_TEPA$p2_wei))-(x_TEPA_dbh/(result_TEPA$p1_wei))^(result_TEPA$p2_wei)))*length(x_TEPA) # Weibull distribution
y_TEPA_QWEI = (1-cumsum(qwei_TEPA(x_TEPA_dbh)*(max(x_TEPA)-min(x_TEPA))/length(x_TEPA_dbh)))*length(x_TEPA) # quasi_Weibull distribution

lines(x_TEPA_dbh, y_TEPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TEPA_dbh, y_TEPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TEPA_dbh, y_TEPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TEPA_dbh, y_TEPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TEPA_dbh, y_TEPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TEPA_dbh, y_TEPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TEPA", bty="n",cex=1.5)

#### Trichilia pallida
BCI_TRPA = subset(bci_2015_live,Latin=="Trichilia pallida")
x_TRPA = BCI_TRPA$DBH/min(BCI_TRPA$DBH)
length(x_TRPA)
x_TRPA_dbh = seq(min(x_TRPA),max(x_TRPA),length=10*length(x_TRPA))
result_TRPA = subset(result_bci_sp_all,Latin=="Trichilia pallida")

plot(sort(x_TRPA, decreasing=TRUE), 1:length(x_TRPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TRPA), max(x_TRPA)), ylim = c(1, length(x_TRPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TRPA = function(x){
  b_pop = result_TRPA$b_pmete
  n_pop = result_TRPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TRPA = function(x){
  b_pop = 2
  n_pop = result_TRPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TRPA = function(x){
  al_pop = result_TRPA$p1_qwei
  be_pop = result_TRPA$p2_qwei
  ga_pop = result_TRPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TRPA_PMETE = (1-cumsum(fx_TRPA(x_TRPA_dbh)*(max(x_TRPA)-min(x_TRPA))/length(x_TRPA_dbh)))*length(x_TRPA) # parametrized mete prediction
y_TRPA_METE = (1-cumsum(gx_TRPA(x_TRPA_dbh)*(max(x_TRPA)-min(x_TRPA))/length(x_TRPA_dbh)))*length(x_TRPA) # mete prediction
y_TRPA_EXP = exp(-(result_TRPA$p_exp)*(x_TRPA_dbh-min(x_TRPA_dbh)))*length(x_TRPA)  # exponential distribution
y_TRPA_POW = ((x_TRPA_dbh)^(-(result_TRPA$p_pow)))*length(x_TRPA) # power function distribution
y_TRPA_WEI = (exp(1/((result_TRPA$p1_wei)^(result_TRPA$p2_wei))-(x_TRPA_dbh/(result_TRPA$p1_wei))^(result_TRPA$p2_wei)))*length(x_TRPA) # Weibull distribution
y_TRPA_QWEI = (1-cumsum(qwei_TRPA(x_TRPA_dbh)*(max(x_TRPA)-min(x_TRPA))/length(x_TRPA_dbh)))*length(x_TRPA) # quasi_Weibull distribution

lines(x_TRPA_dbh, y_TRPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TRPA_dbh, y_TRPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TRPA_dbh, y_TRPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TRPA_dbh, y_TRPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TRPA_dbh, y_TRPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TRPA_dbh, y_TRPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TRPA", bty="n",cex=1.5)

#### Trichilia tuberculata
BCI_TRTU = subset(bci_2015_live,Latin=="Trichilia tuberculata")
x_TRTU = BCI_TRTU$DBH/min(BCI_TRTU$DBH)
length(x_TRTU)
x_TRTU_dbh = seq(min(x_TRTU),max(x_TRTU),length=10*length(x_TRTU))
result_TRTU = subset(result_bci_sp_all,Latin=="Trichilia tuberculata")

plot(sort(x_TRTU, decreasing=TRUE), 1:length(x_TRTU), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_TRTU), max(x_TRTU)), ylim = c(1, length(x_TRTU)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_TRTU = function(x){
  b_pop = result_TRTU$b_pmete
  n_pop = result_TRTU$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_TRTU = function(x){
  b_pop = 2
  n_pop = result_TRTU$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_TRTU = function(x){
  al_pop = result_TRTU$p1_qwei
  be_pop = result_TRTU$p2_qwei
  ga_pop = result_TRTU$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_TRTU_PMETE = (1-cumsum(fx_TRTU(x_TRTU_dbh)*(max(x_TRTU)-min(x_TRTU))/length(x_TRTU_dbh)))*length(x_TRTU) # parametrized mete prediction
y_TRTU_METE = (1-cumsum(gx_TRTU(x_TRTU_dbh)*(max(x_TRTU)-min(x_TRTU))/length(x_TRTU_dbh)))*length(x_TRTU) # mete prediction
y_TRTU_EXP = exp(-(result_TRTU$p_exp)*(x_TRTU_dbh-min(x_TRTU_dbh)))*length(x_TRTU)  # exponential distribution
y_TRTU_POW = ((x_TRTU_dbh)^(-(result_TRTU$p_pow)))*length(x_TRTU) # power function distribution
y_TRTU_WEI = (exp(1/((result_TRTU$p1_wei)^(result_TRTU$p2_wei))-(x_TRTU_dbh/(result_TRTU$p1_wei))^(result_TRTU$p2_wei)))*length(x_TRTU) # Weibull distribution
y_TRTU_QWEI = (1-cumsum(qwei_TRTU(x_TRTU_dbh)*(max(x_TRTU)-min(x_TRTU))/length(x_TRTU_dbh)))*length(x_TRTU) # quasi_Weibull distribution

lines(x_TRTU_dbh, y_TRTU_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_TRTU_dbh, y_TRTU_METE, col="#999999",lwd=2) #, lty=5)
lines(x_TRTU_dbh, y_TRTU_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_TRTU_dbh, y_TRTU_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_TRTU_dbh, y_TRTU_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_TRTU_dbh, y_TRTU_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "TRTU", bty="n",cex=1.5)

#### Zanthoxylum ekmanii
BCI_ZAEK = subset(bci_2015_live,Latin=="Zanthoxylum ekmanii")
x_ZAEK = BCI_ZAEK$DBH/min(BCI_ZAEK$DBH)
length(x_ZAEK)
x_ZAEK_dbh = seq(min(x_ZAEK),max(x_ZAEK),length=10*length(x_ZAEK))
result_ZAEK = subset(result_bci_sp_all,Latin=="Zanthoxylum ekmanii")

plot(sort(x_ZAEK, decreasing=TRUE), 1:length(x_ZAEK), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ZAEK), max(x_ZAEK)), ylim = c(1, length(x_ZAEK)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ZAEK = function(x){
  b_pop = result_ZAEK$b_pmete
  n_pop = result_ZAEK$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ZAEK = function(x){
  b_pop = 2
  n_pop = result_ZAEK$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ZAEK = function(x){
  al_pop = result_ZAEK$p1_qwei
  be_pop = result_ZAEK$p2_qwei
  ga_pop = result_ZAEK$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ZAEK_PMETE = (1-cumsum(fx_ZAEK(x_ZAEK_dbh)*(max(x_ZAEK)-min(x_ZAEK))/length(x_ZAEK_dbh)))*length(x_ZAEK) # parametrized mete prediction
y_ZAEK_METE = (1-cumsum(gx_ZAEK(x_ZAEK_dbh)*(max(x_ZAEK)-min(x_ZAEK))/length(x_ZAEK_dbh)))*length(x_ZAEK) # mete prediction
y_ZAEK_EXP = exp(-(result_ZAEK$p_exp)*(x_ZAEK_dbh-min(x_ZAEK_dbh)))*length(x_ZAEK)  # exponential distribution
y_ZAEK_POW = ((x_ZAEK_dbh)^(-(result_ZAEK$p_pow)))*length(x_ZAEK) # power function distribution
y_ZAEK_WEI = (exp(1/((result_ZAEK$p1_wei)^(result_ZAEK$p2_wei))-(x_ZAEK_dbh/(result_ZAEK$p1_wei))^(result_ZAEK$p2_wei)))*length(x_ZAEK) # Weibull distribution
y_ZAEK_QWEI = (1-cumsum(qwei_ZAEK(x_ZAEK_dbh)*(max(x_ZAEK)-min(x_ZAEK))/length(x_ZAEK_dbh)))*length(x_ZAEK) # quasi_Weibull distribution

lines(x_ZAEK_dbh, y_ZAEK_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ZAEK_dbh, y_ZAEK_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ZAEK_dbh, y_ZAEK_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ZAEK_dbh, y_ZAEK_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ZAEK_dbh, y_ZAEK_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ZAEK_dbh, y_ZAEK_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ZAEK", bty="n",cex=1.5)

#### Zanthoxylum panamense
BCI_ZAPA = subset(bci_2015_live,Latin=="Zanthoxylum panamense")
x_ZAPA = BCI_ZAPA$DBH/min(BCI_ZAPA$DBH)
length(x_ZAPA)
x_ZAPA_dbh = seq(min(x_ZAPA),max(x_ZAPA),length=10*length(x_ZAPA))
result_ZAPA = subset(result_bci_sp_all,Latin=="Zanthoxylum panamense")

plot(sort(x_ZAPA, decreasing=TRUE), 1:length(x_ZAPA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_ZAPA), max(x_ZAPA)), ylim = c(1, length(x_ZAPA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_ZAPA = function(x){
  b_pop = result_ZAPA$b_pmete
  n_pop = result_ZAPA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_ZAPA = function(x){
  b_pop = 2
  n_pop = result_ZAPA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_ZAPA = function(x){
  al_pop = result_ZAPA$p1_qwei
  be_pop = result_ZAPA$p2_qwei
  ga_pop = result_ZAPA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_ZAPA_PMETE = (1-cumsum(fx_ZAPA(x_ZAPA_dbh)*(max(x_ZAPA)-min(x_ZAPA))/length(x_ZAPA_dbh)))*length(x_ZAPA) # parametrized mete prediction
y_ZAPA_METE = (1-cumsum(gx_ZAPA(x_ZAPA_dbh)*(max(x_ZAPA)-min(x_ZAPA))/length(x_ZAPA_dbh)))*length(x_ZAPA) # mete prediction
y_ZAPA_EXP = exp(-(result_ZAPA$p_exp)*(x_ZAPA_dbh-min(x_ZAPA_dbh)))*length(x_ZAPA)  # exponential distribution
y_ZAPA_POW = ((x_ZAPA_dbh)^(-(result_ZAPA$p_pow)))*length(x_ZAPA) # power function distribution
y_ZAPA_WEI = (exp(1/((result_ZAPA$p1_wei)^(result_ZAPA$p2_wei))-(x_ZAPA_dbh/(result_ZAPA$p1_wei))^(result_ZAPA$p2_wei)))*length(x_ZAPA) # Weibull distribution
y_ZAPA_QWEI = (1-cumsum(qwei_ZAPA(x_ZAPA_dbh)*(max(x_ZAPA)-min(x_ZAPA))/length(x_ZAPA_dbh)))*length(x_ZAPA) # quasi_Weibull distribution

lines(x_ZAPA_dbh, y_ZAPA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_ZAPA_dbh, y_ZAPA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_ZAPA_dbh, y_ZAPA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_ZAPA_dbh, y_ZAPA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_ZAPA_dbh, y_ZAPA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_ZAPA_dbh, y_ZAPA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "ZAPA", bty="n",cex=1.5)
```
### BCI (Order=Solanales)
```{r}
par(mfrow=c(1,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)
#### Cestrum megalophyllum
BCI_CEME = subset(bci_2015_live,Latin=="Cestrum megalophyllum")
x_CEME = BCI_CEME$DBH/min(BCI_CEME$DBH)
length(x_CEME)
x_CEME_dbh = seq(min(x_CEME),max(x_CEME),length=10*length(x_CEME))
result_CEME = subset(result_bci_sp_all,Latin=="Cestrum megalophyllum")

plot(sort(x_CEME, decreasing=TRUE), 1:length(x_CEME), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_CEME), max(x_CEME)), ylim = c(1, length(x_CEME)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_CEME = function(x){
  b_pop = result_CEME$b_pmete
  n_pop = result_CEME$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_CEME = function(x){
  b_pop = 2
  n_pop = result_CEME$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_CEME = function(x){
  al_pop = result_CEME$p1_qwei
  be_pop = result_CEME$p2_qwei
  ga_pop = result_CEME$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_CEME_PMETE = (1-cumsum(fx_CEME(x_CEME_dbh)*(max(x_CEME)-min(x_CEME))/length(x_CEME_dbh)))*length(x_CEME) # parametrized mete prediction
y_CEME_METE = (1-cumsum(gx_CEME(x_CEME_dbh)*(max(x_CEME)-min(x_CEME))/length(x_CEME_dbh)))*length(x_CEME) # mete prediction
y_CEME_EXP = exp(-(result_CEME$p_exp)*(x_CEME_dbh-min(x_CEME_dbh)))*length(x_CEME)  # exponential distribution
y_CEME_POW = ((x_CEME_dbh)^(-(result_CEME$p_pow)))*length(x_CEME) # power function distribution
y_CEME_WEI = (exp(1/((result_CEME$p1_wei)^(result_CEME$p2_wei))-(x_CEME_dbh/(result_CEME$p1_wei))^(result_CEME$p2_wei)))*length(x_CEME) # Weibull distribution
y_CEME_QWEI = (1-cumsum(qwei_CEME(x_CEME_dbh)*(max(x_CEME)-min(x_CEME))/length(x_CEME_dbh)))*length(x_CEME) # quasi_Weibull distribution

lines(x_CEME_dbh, y_CEME_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_CEME_dbh, y_CEME_METE, col="#999999",lwd=2) #, lty=5)
lines(x_CEME_dbh, y_CEME_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_CEME_dbh, y_CEME_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_CEME_dbh, y_CEME_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_CEME_dbh, y_CEME_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CEME", bty="n",cex=1.5)

#### Solanum hayesii
BCI_SOHA = subset(bci_2015_live,Latin=="Solanum hayesii")
x_SOHA = BCI_SOHA$DBH/min(BCI_SOHA$DBH)
length(x_SOHA)
x_SOHA_dbh = seq(min(x_SOHA),max(x_SOHA),length=10*length(x_SOHA))
result_SOHA = subset(result_bci_sp_all,Latin=="Solanum hayesii")

plot(sort(x_SOHA, decreasing=TRUE), 1:length(x_SOHA), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_SOHA), max(x_SOHA)), ylim = c(1, length(x_SOHA)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_SOHA = function(x){
  b_pop = result_SOHA$b_pmete
  n_pop = result_SOHA$n_sp
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_SOHA = function(x){
  b_pop = 2
  n_pop = result_SOHA$n_sp
  S_0 = 296
  N_0 = 248835
  L2_com = 1.476158e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_SOHA = function(x){
  al_pop = result_SOHA$p1_qwei
  be_pop = result_SOHA$p2_qwei
  ga_pop = result_SOHA$p3_qwei
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

y_SOHA_PMETE = (1-cumsum(fx_SOHA(x_SOHA_dbh)*(max(x_SOHA)-min(x_SOHA))/length(x_SOHA_dbh)))*length(x_SOHA) # parametrized mete prediction
y_SOHA_METE = (1-cumsum(gx_SOHA(x_SOHA_dbh)*(max(x_SOHA)-min(x_SOHA))/length(x_SOHA_dbh)))*length(x_SOHA) # mete prediction
y_SOHA_EXP = exp(-(result_SOHA$p_exp)*(x_SOHA_dbh-min(x_SOHA_dbh)))*length(x_SOHA)  # exponential distribution
y_SOHA_POW = ((x_SOHA_dbh)^(-(result_SOHA$p_pow)))*length(x_SOHA) # power function distribution
y_SOHA_WEI = (exp(1/((result_SOHA$p1_wei)^(result_SOHA$p2_wei))-(x_SOHA_dbh/(result_SOHA$p1_wei))^(result_SOHA$p2_wei)))*length(x_SOHA) # Weibull distribution
y_SOHA_QWEI = (1-cumsum(qwei_SOHA(x_SOHA_dbh)*(max(x_SOHA)-min(x_SOHA))/length(x_SOHA_dbh)))*length(x_SOHA) # quasi_Weibull distribution

lines(x_SOHA_dbh, y_SOHA_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_SOHA_dbh, y_SOHA_METE, col="#999999",lwd=2) #, lty=5)
lines(x_SOHA_dbh, y_SOHA_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_SOHA_dbh, y_SOHA_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_SOHA_dbh, y_SOHA_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_SOHA_dbh, y_SOHA_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SOHA", bty="n",cex=1.5)
```

### plot A1
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)

#### BG
x_A1_BG = subset(alltree,plot=="A1" & sp=="BG")$dbh/min(subset(alltree,plot=="A1" & sp=="BG")$dbh)
length(x_A1_BG)
x_A1_BG_dbh = seq(min(x_A1_BG),max(x_A1_BG),length=1000)

plot(sort(x_A1_BG, decreasing=TRUE), 1:length(x_A1_BG), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A1_BG), max(x_A1_BG)), ylim = c(1, length(x_A1_BG)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A1_BG = function(x){
  b_pop = 1.399567
  n_pop = 25
  L2_com = 0.01031206
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A1_BG = function(x){
  b_pop = 2
  n_pop = 25
  S_0 = 11
  N_0 = 66
  L2_com = S_0/(sum(x_A1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A1_BG = function(x){
  al_pop = 6.916316265
  be_pop = 0.001025191
  ga_pop = -6.540014974
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A1_BG = Vectorize(fx_A1_BG)
# qwei_A1_BG = Vectorize(qwei_A1_BG)
y_A1_BG_PMETE = (1-cumsum(fx_A1_BG(x_A1_BG_dbh)*(max(x_A1_BG)-min(x_A1_BG))/1000))*length(x_A1_BG) # parametrized mete prediction
y_A1_BG_METE = (1-cumsum(gx_A1_BG(x_A1_BG_dbh)*(max(x_A1_BG)-min(x_A1_BG))/1000))*length(x_A1_BG) # mete prediction
y_A1_BG_EXP = exp(-0.5319149*(x_A1_BG_dbh-min(x_A1_BG_dbh)))*length(x_A1_BG)  # exponential distribution
y_A1_BG_POW = ((x_A1_BG_dbh)^(-1.086374))*length(x_A1_BG) # power function distribution
y_A1_BG_WEI = (exp(1/(2.370114^1.254709)-(x_A1_BG_dbh/2.370114)^1.254709))*length(x_A1_BG) # Weibull distribution
y_A1_BG_QWEI = (1-cumsum(qwei_A1_BG(x_A1_BG_dbh)*(max(x_A1_BG)-min(x_A1_BG))/1000))*length(x_A1_BG) # quasi_Weibull distribution

lines(x_A1_BG_dbh, y_A1_BG_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A1_BG_dbh, y_A1_BG_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A1_BG_dbh, y_A1_BG_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A1_BG_dbh, y_A1_BG_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A1_BG_dbh, y_A1_BG_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A1_BG_dbh, y_A1_BG_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BG", bty="n",cex=1.5)

#### RO
x_A1_RO = subset(alltree,plot=="A1" & sp=="RO")$dbh/min(subset(alltree,plot=="A1" & sp=="RO")$dbh)
length(x_A1_RO)
x_A1_RO_dbh = seq(min(x_A1_RO),max(x_A1_RO),length=1000)

plot(sort(x_A1_RO, decreasing=TRUE), 1:length(x_A1_RO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A1_RO), max(x_A1_RO)), ylim = c(1, length(x_A1_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A1_RO = function(x){
  b_pop = 2.108589
  n_pop = 41
  L2_com = 0.01031206
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A1_RO = function(x){
  b_pop = 2
  n_pop = 41
  S_0 = 11
  N_0 = 66
  L2_com = S_0/(sum(x_A1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A1_RO = function(x){
  al_pop = 5.2793425
  be_pop = 1.9395537
  ga_pop = -0.2028854
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A1_RO = Vectorize(fx_A1_RO)
# qwei_A1_RO = Vectorize(qwei_A1_RO)
y_A1_RO_PMETE = (1-cumsum(fx_A1_RO(x_A1_RO_dbh)*(max(x_A1_RO)-min(x_A1_RO))/1000))*length(x_A1_RO) # parametrized mete prediction
y_A1_RO_METE = (1-cumsum(gx_A1_RO(x_A1_RO_dbh)*(max(x_A1_RO)-min(x_A1_RO))/1000))*length(x_A1_RO) # mete prediction
y_A1_RO_EXP = exp(-1.19998*(x_A1_RO_dbh-min(x_A1_RO_dbh)))*length(x_A1_RO)  # exponential distribution
y_A1_RO_POW = ((x_A1_RO_dbh)^(-1.712316))*length(x_A1_RO) # power function distribution
y_A1_RO_WEI = (exp(1/(1.957329^5.178310)-(x_A1_RO_dbh/1.957329)^5.178310))*length(x_A1_RO) # Weibull distribution
y_A1_RO_QWEI = (1-cumsum(qwei_A1_RO(x_A1_RO_dbh)*(max(x_A1_RO)-min(x_A1_RO))/1000))*length(x_A1_RO) # quasi_Weibull distribution

lines(x_A1_RO_dbh, y_A1_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A1_RO_dbh, y_A1_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A1_RO_dbh, y_A1_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A1_RO_dbh, y_A1_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A1_RO_dbh, y_A1_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A1_RO_dbh, y_A1_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)

#### SM
x_A1_SM = subset(alltree,plot=="A1" & sp=="SM")$dbh/min(subset(alltree,plot=="A1" & sp=="SM")$dbh)
length(x_A1_SM)
x_A1_SM_dbh = seq(min(x_A1_SM),max(x_A1_SM),length=1000)

plot(sort(x_A1_SM, decreasing=TRUE), 1:length(x_A1_SM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A1_SM), max(x_A1_SM)), ylim = c(1, length(x_A1_SM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A1_SM = function(x){
  b_pop = 1.26968
  n_pop = 19
  L2_com = 0.01031206
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A1_SM = function(x){
  b_pop = 2
  n_pop = 19
  S_0 = 11
  N_0 = 66
  L2_com = S_0/(sum(x_A1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A1_SM = function(x){
  al_pop = 1.541741e-03
  be_pop = 9.799698e+00
  ga_pop = 3.264745e+02
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A1_SM = Vectorize(fx_A1_SM)
# qwei_A1_SM = Vectorize(qwei_A1_SM)
y_A1_SM_PMETE = (1-cumsum(fx_A1_SM(x_A1_SM_dbh)*(max(x_A1_SM)-min(x_A1_SM))/1000))*length(x_A1_SM) # parametrized mete prediction
y_A1_SM_METE = (1-cumsum(gx_A1_SM(x_A1_SM_dbh)*(max(x_A1_SM)-min(x_A1_SM))/1000))*length(x_A1_SM) # mete prediction
y_A1_SM_EXP = exp(-0.3560477*(x_A1_SM_dbh-min(x_A1_SM_dbh)))*length(x_A1_SM)  # exponential distribution
y_A1_SM_POW = ((x_A1_SM_dbh)^(-0.9009278))*length(x_A1_SM) # power function distribution
y_A1_SM_WEI = (exp(1/(2.847681^1.013207)-(x_A1_SM_dbh/2.847681)^1.013207))*length(x_A1_SM) # Weibull distribution
y_A1_SM_QWEI = (1-cumsum(qwei_A1_SM(x_A1_SM_dbh)*(max(x_A1_SM)-min(x_A1_SM))/1000))*length(x_A1_SM) # quasi_Weibull distribution

lines(x_A1_SM_dbh, y_A1_SM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A1_SM_dbh, y_A1_SM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A1_SM_dbh, y_A1_SM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A1_SM_dbh, y_A1_SM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A1_SM_dbh, y_A1_SM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A1_SM_dbh, y_A1_SM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SM", bty="n",cex=1.5)

#### WO
x_A1_WO = subset(alltree,plot=="A1" & sp=="WO")$dbh/min(subset(alltree,plot=="A1" & sp=="WO")$dbh)
length(x_A1_WO)
x_A1_WO_dbh = seq(min(x_A1_WO),max(x_A1_WO),length=1000)

plot(sort(x_A1_WO, decreasing=TRUE), 1:length(x_A1_WO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A1_WO), max(x_A1_WO)), ylim = c(1, length(x_A1_WO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A1_WO = function(x){
  b_pop = 6.06871
  n_pop = 13
  L2_com = 0.01031206
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A1_WO = function(x){
  b_pop = 2
  n_pop = 13
  S_0 = 11
  N_0 = 66
  L2_com = S_0/(sum(x_A1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A1_WO = function(x){
  al_pop = 0.7373878
  be_pop = 1.6645038
  ga_pop = 8.2514874
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A1_WO = Vectorize(fx_A1_WO)
# qwei_A1_WO = Vectorize(qwei_A1_WO)
y_A1_WO_PMETE = (1-cumsum(fx_A1_WO(x_A1_WO_dbh)*(max(x_A1_WO)-min(x_A1_WO))/1000))*length(x_A1_WO) # parametrized mete prediction
y_A1_WO_METE = (1-cumsum(gx_A1_WO(x_A1_WO_dbh)*(max(x_A1_WO)-min(x_A1_WO))/1000))*length(x_A1_WO) # mete prediction
y_A1_WO_EXP = exp(-3.15201*(x_A1_WO_dbh-min(x_A1_WO_dbh)))*length(x_A1_WO)  # exponential distribution
y_A1_WO_POW = ((x_A1_WO_dbh)^(-3.80773))*length(x_A1_WO) # power function distribution
y_A1_WO_WEI = (exp(1/(1.276267^4.221170)-(x_A1_WO_dbh/1.276267)^4.221170))*length(x_A1_WO) # Weibull distribution
y_A1_WO_QWEI = (1-cumsum(qwei_A1_WO(x_A1_WO_dbh)*(max(x_A1_WO)-min(x_A1_WO))/1000))*length(x_A1_WO) # quasi_Weibull distribution

lines(x_A1_WO_dbh, y_A1_WO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A1_WO_dbh, y_A1_WO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A1_WO_dbh, y_A1_WO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A1_WO_dbh, y_A1_WO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A1_WO_dbh, y_A1_WO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A1_WO_dbh, y_A1_WO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "WO", bty="n",cex=1.5)
```
### plot A2
```{r}
par(mfrow=c(3,3),mar=c(3,3,1,1))
inset = c(-0.08, 0);mgpVals = c(1.6,0.5,0)

#### BB
x_A2_BB = subset(alltree,plot=="A2" & sp=="BB")$dbh/min(subset(alltree,plot=="A2" & sp=="BB")$dbh)
length(x_A2_BB)
x_A2_BB_dbh = seq(min(x_A2_BB),max(x_A2_BB),length=1000)

plot(sort(x_A2_BB, decreasing=TRUE), 1:length(x_A2_BB), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A2_BB), max(x_A2_BB)), ylim = c(1, length(x_A2_BB)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_BB = function(x){
  b_pop = 1.103444
  n_pop = 44
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_BB = function(x){
  b_pop = 2
  n_pop = 44
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_BB = function(x){
  al_pop = 9.273678583
  be_pop = 0.004415998
  ga_pop = -8.791338785
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_BB = Vectorize(fx_A2_BB)
# qwei_A2_BB = Vectorize(qwei_A2_BB)
y_A2_BB_PMETE = (1-cumsum(fx_A2_BB(x_A2_BB_dbh)*(max(x_A2_BB)-min(x_A2_BB))/1000))*length(x_A2_BB) # parametrized mete prediction
y_A2_BB_METE = (1-cumsum(gx_A2_BB(x_A2_BB_dbh)*(max(x_A2_BB)-min(x_A2_BB))/1000))*length(x_A2_BB) # mete prediction
y_A2_BB_EXP = exp(-0.78125*(x_A2_BB_dbh-min(x_A2_BB_dbh)))*length(x_A2_BB)  # exponential distribution
y_A2_BB_POW = ((x_A2_BB_dbh)^(-1.346069))*length(x_A2_BB) # power function distribution
y_A2_BB_WEI = (exp(1/(2.102415^1.720339)-(x_A2_BB_dbh/2.102415)^1.720339))*length(x_A2_BB) # Weibull distribution
y_A2_BB_QWEI = (1-cumsum(qwei_A2_BB(x_A2_BB_dbh)*(max(x_A2_BB)-min(x_A2_BB))/1000))*length(x_A2_BB) # quasi_Weibull distribution

lines(x_A2_BB_dbh, y_A2_BB_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_BB_dbh, y_A2_BB_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_BB_dbh, y_A2_BB_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_BB_dbh, y_A2_BB_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_BB_dbh, y_A2_BB_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_BB_dbh, y_A2_BB_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BB", bty="n",cex=1.5)

#### BG
x_A2_BG = subset(alltree,plot=="A2" & sp=="BG")$dbh/min(subset(alltree,plot=="A2" & sp=="BG")$dbh)
length(x_A2_BG)
x_A2_BG_dbh = seq(min(x_A2_BG),max(x_A2_BG),length=1000)

plot(sort(x_A2_BG, decreasing=TRUE), 1:length(x_A2_BG), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A2_BG), max(x_A2_BG)), ylim = c(1, length(x_A2_BG)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_BG = function(x){
  b_pop = 1.419949
  n_pop = 29
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_BG = function(x){
  b_pop = 2
  n_pop = 29
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_BG = function(x){
  al_pop = 2.705840e-07
  be_pop = 3.587129e+00
  ga_pop = 2.214177e+00
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_BG = Vectorize(fx_A2_BG)
# qwei_A2_BG = Vectorize(qwei_A2_BG)
y_A2_BG_PMETE = (1-cumsum(fx_A2_BG(x_A2_BG_dbh)*(max(x_A2_BG)-min(x_A2_BG))/1000))*length(x_A2_BG) # parametrized mete prediction
y_A2_BG_METE = (1-cumsum(gx_A2_BG(x_A2_BG_dbh)*(max(x_A2_BG)-min(x_A2_BG))/1000))*length(x_A2_BG) # mete prediction
y_A2_BG_EXP = exp(-0.9074316*(x_A2_BG_dbh-min(x_A2_BG_dbh)))*length(x_A2_BG)  # exponential distribution
y_A2_BG_POW = ((x_A2_BG_dbh)^(-1.556176))*length(x_A2_BG) # power function distribution
y_A2_BG_WEI = (exp(1/(1.321315^1.140842)-(x_A2_BG_dbh/1.321315)^1.140842))*length(x_A2_BG) # Weibull distribution
y_A2_BG_QWEI = (1-cumsum(qwei_A2_BG(x_A2_BG_dbh)*(max(x_A2_BG)-min(x_A2_BG))/1000))*length(x_A2_BG) # quasi_Weibull distribution

lines(x_A2_BG_dbh, y_A2_BG_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_BG_dbh, y_A2_BG_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_BG_dbh, y_A2_BG_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_BG_dbh, y_A2_BG_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_BG_dbh, y_A2_BG_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_BG_dbh, y_A2_BG_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BG", bty="n",cex=1.5)

#### CO
x_A2_CO = subset(alltree,plot=="A2" & sp=="CO")$dbh/min(subset(alltree,plot=="A2" & sp=="CO")$dbh)
length(x_A2_CO)
x_A2_CO_dbh = seq(min(x_A2_CO),max(x_A2_CO),length=1000)

plot(sort(x_A2_CO, decreasing=TRUE), 1:length(x_A2_CO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A2_CO), max(x_A2_CO)), ylim = c(1, length(x_A2_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_CO = function(x){
  b_pop = 0.8743982
  n_pop = 18
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_CO = function(x){
  b_pop = 2
  n_pop = 18
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_CO = function(x){
  al_pop = 0.9692541
  be_pop = 11.0146000
  ga_pop = 309.6017077
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_CO = Vectorize(fx_A2_CO)
# qwei_A2_CO = Vectorize(qwei_A2_CO)
y_A2_CO_PMETE = (1-cumsum(fx_A2_CO(x_A2_CO_dbh)*(max(x_A2_CO)-min(x_A2_CO))/1000))*length(x_A2_CO) # parametrized mete prediction
y_A2_CO_METE = (1-cumsum(gx_A2_CO(x_A2_CO_dbh)*(max(x_A2_CO)-min(x_A2_CO))/1000))*length(x_A2_CO) # mete prediction
y_A2_CO_EXP = exp(-0.1952848*(x_A2_CO_dbh-min(x_A2_CO_dbh)))*length(x_A2_CO)  # exponential distribution
y_A2_CO_POW = ((x_A2_CO_dbh)^(-0.6377408))*length(x_A2_CO) # power function distribution
y_A2_CO_WEI = (exp(1/(6.481476^1.613095)-(x_A2_CO_dbh/6.481476)^1.613095))*length(x_A2_CO) # Weibull distribution
y_A2_CO_QWEI = (1-cumsum(qwei_A2_CO(x_A2_CO_dbh)*(max(x_A2_CO)-min(x_A2_CO))/1000))*length(x_A2_CO) # quasi_Weibull distribution

lines(x_A2_CO_dbh, y_A2_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_CO_dbh, y_A2_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_CO_dbh, y_A2_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_CO_dbh, y_A2_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_CO_dbh, y_A2_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_CO_dbh, y_A2_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RM
x_A2_RM = subset(alltree,plot=="A2" & sp=="RM")$dbh/min(subset(alltree,plot=="A2" & sp=="RM")$dbh)
length(x_A2_RM)
x_A2_RM_dbh = seq(min(x_A2_RM),max(x_A2_RM),length=1000)

plot(sort(x_A2_RM, decreasing=TRUE), 1:length(x_A2_RM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A2_RM), max(x_A2_RM)), ylim = c(1, length(x_A2_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_RM = function(x){
  b_pop = 1.539397
  n_pop = 19
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_RM = function(x){
  b_pop = 2
  n_pop = 19
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_RM = function(x){
  al_pop = 2.782035e-05
  be_pop = 4.175191e+00
  ga_pop = 2.097737e+00
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_RM = Vectorize(fx_A2_RM)
# qwei_A2_RM = Vectorize(qwei_A2_RM)
y_A2_RM_PMETE = (1-cumsum(fx_A2_RM(x_A2_RM_dbh)*(max(x_A2_RM)-min(x_A2_RM))/1000))*length(x_A2_RM) # parametrized mete prediction
y_A2_RM_METE = (1-cumsum(gx_A2_RM(x_A2_RM_dbh)*(max(x_A2_RM)-min(x_A2_RM))/1000))*length(x_A2_RM) # mete prediction
y_A2_RM_EXP = exp(-0.7684798*(x_A2_RM_dbh-min(x_A2_RM_dbh)))*length(x_A2_RM)  # exponential distribution
y_A2_RM_POW = ((x_A2_RM_dbh)^(-1.413651))*length(x_A2_RM) # power function distribution
y_A2_RM_WEI = (exp(1/(1.345680^1.024168)-(x_A2_RM_dbh/1.345680)^1.024168))*length(x_A2_RM) # Weibull distribution
y_A2_RM_QWEI = (1-cumsum(qwei_A2_RM(x_A2_RM_dbh)*(max(x_A2_RM)-min(x_A2_RM))/1000))*length(x_A2_RM) # quasi_Weibull distribution

lines(x_A2_RM_dbh, y_A2_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_RM_dbh, y_A2_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_RM_dbh, y_A2_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_RM_dbh, y_A2_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_RM_dbh, y_A2_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_RM_dbh, y_A2_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_A2_RO = subset(alltree,plot=="A2" & sp=="RO")$dbh/min(subset(alltree,plot=="A2" & sp=="RO")$dbh)
length(x_A2_RO)
x_A2_RO_dbh = seq(min(x_A2_RO),max(x_A2_RO),length=1000)

plot(sort(x_A2_RO, decreasing=TRUE), 1:length(x_A2_RO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A2_RO), max(x_A2_RO)), ylim = c(1, length(x_A2_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_RO = function(x){
  b_pop = 1.096232
  n_pop = 51
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_RO = function(x){
  b_pop = 2
  n_pop = 51
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_RO = function(x){
  al_pop = 4.2152106
  be_pop = 2.5244943
  ga_pop = 0.7100005
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_RO = Vectorize(fx_A2_RO)
# qwei_A2_RO = Vectorize(qwei_A2_RO)
y_A2_RO_PMETE = (1-cumsum(fx_A2_RO(x_A2_RO_dbh)*(max(x_A2_RO)-min(x_A2_RO))/1000))*length(x_A2_RO) # parametrized mete prediction
y_A2_RO_METE = (1-cumsum(gx_A2_RO(x_A2_RO_dbh)*(max(x_A2_RO)-min(x_A2_RO))/1000))*length(x_A2_RO) # mete prediction
y_A2_RO_EXP = exp(-0.8034794*(x_A2_RO_dbh-min(x_A2_RO_dbh)))*length(x_A2_RO)  # exponential distribution
y_A2_RO_POW = ((x_A2_RO_dbh)^(-1.288001))*length(x_A2_RO) # power function distribution
y_A2_RO_WEI = (exp(1/(2.428443^4.530740)-(x_A2_RO_dbh/2.428443)^4.530740))*length(x_A2_RO) # Weibull distribution
y_A2_RO_QWEI = (1-cumsum(qwei_A2_RO(x_A2_RO_dbh)*(max(x_A2_RO)-min(x_A2_RO))/1000))*length(x_A2_RO) # quasi_Weibull distribution

lines(x_A2_RO_dbh, y_A2_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_RO_dbh, y_A2_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_RO_dbh, y_A2_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_RO_dbh, y_A2_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_RO_dbh, y_A2_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_RO_dbh, y_A2_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)

#### SM
x_A2_SM = subset(alltree,plot=="A2" & sp=="SM")$dbh/min(subset(alltree,plot=="A2" & sp=="SM")$dbh)
length(x_A2_SM)
x_A2_SM_dbh = seq(min(x_A2_SM),max(x_A2_SM),length=1000)

plot(sort(x_A2_SM, decreasing=TRUE), 1:length(x_A2_SM), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A2_SM), max(x_A2_SM)), ylim = c(1, length(x_A2_SM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_SM = function(x){
  b_pop = 1.732751
  n_pop = 15
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_SM = function(x){
  b_pop = 2
  n_pop = 15
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_SM = function(x){
  al_pop = 1.042606e-02
  be_pop = 7.445307e-40
  ga_pop = 3.288393e-02
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_SM = Vectorize(fx_A2_SM)
# qwei_A2_SM = Vectorize(qwei_A2_SM)
y_A2_SM_PMETE = (1-cumsum(fx_A2_SM(x_A2_SM_dbh)*(max(x_A2_SM)-min(x_A2_SM))/1000))*length(x_A2_SM) # parametrized mete prediction
y_A2_SM_METE = (1-cumsum(gx_A2_SM(x_A2_SM_dbh)*(max(x_A2_SM)-min(x_A2_SM))/1000))*length(x_A2_SM) # mete prediction
y_A2_SM_EXP = exp(-1.205788*(x_A2_SM_dbh-min(x_A2_SM_dbh)))*length(x_A2_SM)  # exponential distribution
y_A2_SM_POW = ((x_A2_SM_dbh)^(-2.220746))*length(x_A2_SM) # power function distribution
y_A2_SM_WEI = (exp(1/(5.170375e-18^8.190525e-02)-(x_A2_SM_dbh/5.170375e-18)^8.190525e-02))*length(x_A2_SM) # Weibull distribution
y_A2_SM_QWEI = (1-cumsum(qwei_A2_SM(x_A2_SM_dbh)*(max(x_A2_SM)-min(x_A2_SM))/1000))*length(x_A2_SM) # quasi_Weibull distribution

lines(x_A2_SM_dbh, y_A2_SM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_SM_dbh, y_A2_SM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_SM_dbh, y_A2_SM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_SM_dbh, y_A2_SM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_SM_dbh, y_A2_SM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_SM_dbh, y_A2_SM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SM", bty="n",cex=1.5)

#### WO
x_A2_WO = subset(alltree,plot=="A2" & sp=="WO")$dbh/min(subset(alltree,plot=="A2" & sp=="WO")$dbh)
length(x_A2_WO)
x_A2_WO_dbh = seq(min(x_A2_WO),max(x_A2_WO),length=1000)

plot(sort(x_A2_WO, decreasing=TRUE), 1:length(x_A2_WO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A2_WO), max(x_A2_WO)), ylim = c(1, length(x_A2_WO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A2_WO = function(x){
  b_pop = 1.254616
  n_pop = 12
  L2_com = 0.01613823
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A2_WO = function(x){
  b_pop = 2
  n_pop = 12
  S_0 = 11
  N_0 = 121
  L2_com = S_0/(sum(x_A2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A2_WO = function(x){
  al_pop = 8.316404e-06
  be_pop = 1.008061e+01
  ga_pop = 1.839601e+00
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A2_WO = Vectorize(fx_A2_WO)
# qwei_A2_WO = Vectorize(qwei_A2_WO)
y_A2_WO_PMETE = (1-cumsum(fx_A2_WO(x_A2_WO_dbh)*(max(x_A2_WO)-min(x_A2_WO))/1000))*length(x_A2_WO) # parametrized mete prediction
y_A2_WO_METE = (1-cumsum(gx_A2_WO(x_A2_WO_dbh)*(max(x_A2_WO)-min(x_A2_WO))/1000))*length(x_A2_WO) # mete prediction
y_A2_WO_EXP = exp(-0.3572149*(x_A2_WO_dbh-min(x_A2_WO_dbh)))*length(x_A2_WO)  # exponential distribution
y_A2_WO_POW = ((x_A2_WO_dbh)^(-0.9461858))*length(x_A2_WO) # power function distribution
y_A2_WO_WEI = (exp(1/(1.8711206^0.7514602)-(x_A2_WO_dbh/1.8711206)^0.7514602))*length(x_A2_WO) # Weibull distribution
y_A2_WO_QWEI = (1-cumsum(qwei_A2_WO(x_A2_WO_dbh)*(max(x_A2_WO)-min(x_A2_WO))/1000))*length(x_A2_WO) # quasi_Weibull distribution

lines(x_A2_WO_dbh, y_A2_WO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A2_WO_dbh, y_A2_WO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A2_WO_dbh, y_A2_WO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A2_WO_dbh, y_A2_WO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A2_WO_dbh, y_A2_WO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A2_WO_dbh, y_A2_WO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "WO", bty="n",cex=1.5)
```
### plot A3
```{r}
par(mfrow=c(3,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### BB
x_A3_BB = subset(alltree,plot=="A3" & sp=="BB")$dbh/min(subset(alltree,plot=="A3" & sp=="BB")$dbh)
length(x_A3_BB)
x_A3_BB_dbh = seq(min(x_A3_BB),max(x_A3_BB),length=1000)

plot(sort(x_A3_BB, decreasing=TRUE), 1:length(x_A3_BB), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A3_BB), max(x_A3_BB)), ylim = c(1, length(x_A3_BB)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A3_BB = function(x){
  b_pop = 2.508083
  n_pop = 13
  L2_com = 0.002781908
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A3_BB = function(x){
  b_pop = 2
  n_pop = 13
  S_0 = 8
  N_0 = 89
  L2_com = S_0/(sum(x_A3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A3_BB = function(x){
  al_pop = 0.5147755
  be_pop = 5.7437610
  ga_pop = 425.7349541
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A3_BB = Vectorize(fx_A3_BB)
# qwei_A3_BB = Vectorize(qwei_A3_BB)
y_A3_BB_PMETE = (1-cumsum(fx_A3_BB(x_A3_BB_dbh)*(max(x_A3_BB)-min(x_A3_BB))/1000))*length(x_A3_BB) # parametrized mete prediction
y_A3_BB_METE = (1-cumsum(gx_A3_BB(x_A3_BB_dbh)*(max(x_A3_BB)-min(x_A3_BB))/1000))*length(x_A3_BB) # mete prediction
y_A3_BB_EXP = exp(-0.4712372*(x_A3_BB_dbh-min(x_A3_BB_dbh)))*length(x_A3_BB)  # exponential distribution
y_A3_BB_POW = ((x_A3_BB_dbh)^(-0.9982085))*length(x_A3_BB) # power function distribution
y_A3_BB_WEI = (exp(1/(3.092030^1.661206)-(x_A3_BB_dbh/3.092030)^1.661206))*length(x_A3_BB) # Weibull distribution
y_A3_BB_QWEI = (1-cumsum(qwei_A3_BB(x_A3_BB_dbh)*(max(x_A3_BB)-min(x_A3_BB))/1000))*length(x_A3_BB) # quasi_Weibull distribution

lines(x_A3_BB_dbh, y_A3_BB_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A3_BB_dbh, y_A3_BB_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A3_BB_dbh, y_A3_BB_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A3_BB_dbh, y_A3_BB_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A3_BB_dbh, y_A3_BB_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A3_BB_dbh, y_A3_BB_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BB", bty="n",cex=1.5)

#### BE
x_A3_BE = subset(alltree,plot=="A3" & sp=="BE")$dbh/min(subset(alltree,plot=="A3" & sp=="BE")$dbh)
length(x_A3_BE)
x_A3_BE_dbh = seq(min(x_A3_BE),max(x_A3_BE),length=1000)

plot(sort(x_A3_BE, decreasing=TRUE), 1:length(x_A3_BE), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A3_BE), max(x_A3_BE)), ylim = c(1, length(x_A3_BE)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A3_BE = function(x){
  b_pop = 1.386863
  n_pop = 37
  L2_com = 0.002781908
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A3_BE = function(x){
  b_pop = 2
  n_pop = 37
  S_0 = 8
  N_0 = 89
  L2_com = S_0/(sum(x_A3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A3_BE = function(x){
  al_pop = 0.04963983
  be_pop = 3.68654478
  ga_pop = 0.64909523
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A3_BE = Vectorize(fx_A3_BE)
# qwei_A3_BE = Vectorize(qwei_A3_BE)
y_A3_BE_PMETE = (1-cumsum(fx_A3_BE(x_A3_BE_dbh)*(max(x_A3_BE)-min(x_A3_BE))/1000))*length(x_A3_BE) # parametrized mete prediction
y_A3_BE_METE = (1-cumsum(gx_A3_BE(x_A3_BE_dbh)*(max(x_A3_BE)-min(x_A3_BE))/1000))*length(x_A3_BE) # mete prediction
y_A3_BE_EXP = exp(-0.3305933*(x_A3_BE_dbh-min(x_A3_BE_dbh)))*length(x_A3_BE)  # exponential distribution
y_A3_BE_POW = ((x_A3_BE_dbh)^(-0.9578934))*length(x_A3_BE) # power function distribution
y_A3_BE_WEI = (exp(1/(0.5895321^0.4789815)-(x_A3_BE_dbh/0.5895321)^0.4789815))*length(x_A3_BE) # Weibull distribution
y_A3_BE_QWEI = (1-cumsum(qwei_A3_BE(x_A3_BE_dbh)*(max(x_A3_BE)-min(x_A3_BE))/1000))*length(x_A3_BE) # quasi_Weibull distribution

lines(x_A3_BE_dbh, y_A3_BE_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A3_BE_dbh, y_A3_BE_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A3_BE_dbh, y_A3_BE_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A3_BE_dbh, y_A3_BE_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A3_BE_dbh, y_A3_BE_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A3_BE_dbh, y_A3_BE_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BE", bty="n",cex=1.5)

#### BO
x_A3_BO = subset(alltree,plot=="A3" & sp=="BO")$dbh/min(subset(alltree,plot=="A3" & sp=="BO")$dbh)
length(x_A3_BO)
x_A3_BO_dbh = seq(min(x_A3_BO),max(x_A3_BO),length=1000)

plot(sort(x_A3_BO, decreasing=TRUE), 1:length(x_A3_BO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A3_BO), max(x_A3_BO)), ylim = c(1, length(x_A3_BO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A3_BO = function(x){
  b_pop = 3.331674
  n_pop = 16
  L2_com = 0.002781908
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A3_BO = function(x){
  b_pop = 2
  n_pop = 16
  S_0 = 8
  N_0 = 89
  L2_com = S_0/(sum(x_A3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A3_BO = function(x){
  al_pop = 1.308247
  be_pop = 3.598633
  ga_pop = 579.318359
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A3_BO = Vectorize(fx_A3_BO)
# qwei_A3_BO = Vectorize(qwei_A3_BO)
y_A3_BO_PMETE = (1-cumsum(fx_A3_BO(x_A3_BO_dbh)*(max(x_A3_BO)-min(x_A3_BO))/1000))*length(x_A3_BO) # parametrized mete prediction
y_A3_BO_METE = (1-cumsum(gx_A3_BO(x_A3_BO_dbh)*(max(x_A3_BO)-min(x_A3_BO))/1000))*length(x_A3_BO) # mete prediction
y_A3_BO_EXP = exp(-0.730779*(x_A3_BO_dbh-min(x_A3_BO_dbh)))*length(x_A3_BO)  # exponential distribution
y_A3_BO_POW = ((x_A3_BO_dbh)^(-1.229251))*length(x_A3_BO) # power function distribution
y_A3_BO_WEI = (exp(1/(2.570006^3.470214)-(x_A3_BO_dbh/2.570006)^3.470214))*length(x_A3_BO) # Weibull distribution
y_A3_BO_QWEI = (1-cumsum(qwei_A3_BO(x_A3_BO_dbh)*(max(x_A3_BO)-min(x_A3_BO))/1000))*length(x_A3_BO) # quasi_Weibull distribution

lines(x_A3_BO_dbh, y_A3_BO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A3_BO_dbh, y_A3_BO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A3_BO_dbh, y_A3_BO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A3_BO_dbh, y_A3_BO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A3_BO_dbh, y_A3_BO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A3_BO_dbh, y_A3_BO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BO", bty="n",cex=1.5)

#### CO
x_A3_CO = subset(alltree,plot=="A3" & sp=="CO")$dbh/min(subset(alltree,plot=="A3" & sp=="CO")$dbh)
length(x_A3_CO)
x_A3_CO_dbh = seq(min(x_A3_CO),max(x_A3_CO),length=1000)

plot(sort(x_A3_CO, decreasing=TRUE), 1:length(x_A3_CO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A3_CO), max(x_A3_CO)), ylim = c(1, length(x_A3_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A3_CO = function(x){
  b_pop = 2.07903
  n_pop = 45
  L2_com = 0.002781908
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A3_CO = function(x){
  b_pop = 2
  n_pop = 45
  S_0 = 8
  N_0 = 89
  L2_com = S_0/(sum(x_A3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A3_CO = function(x){
  al_pop = 1.502619
  be_pop = 4.378406
  ga_pop = 8.137008
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A3_CO = Vectorize(fx_A3_CO)
# qwei_A3_CO = Vectorize(qwei_A3_CO)
y_A3_CO_PMETE = (1-cumsum(fx_A3_CO(x_A3_CO_dbh)*(max(x_A3_CO)-min(x_A3_CO))/1000))*length(x_A3_CO) # parametrized mete prediction
y_A3_CO_METE = (1-cumsum(gx_A3_CO(x_A3_CO_dbh)*(max(x_A3_CO)-min(x_A3_CO))/1000))*length(x_A3_CO) # mete prediction
y_A3_CO_EXP = exp(-0.5532157*(x_A3_CO_dbh-min(x_A3_CO_dbh)))*length(x_A3_CO)  # exponential distribution
y_A3_CO_POW = ((x_A3_CO_dbh)^(-1.035498))*length(x_A3_CO) # power function distribution
y_A3_CO_WEI = (exp(1/(3.069216^2.990917)-(x_A3_CO_dbh/3.069216)^2.990917))*length(x_A3_CO) # Weibull distribution
y_A3_CO_QWEI = (1-cumsum(qwei_A3_CO(x_A3_CO_dbh)*(max(x_A3_CO)-min(x_A3_CO))/1000))*length(x_A3_CO) # quasi_Weibull distribution

lines(x_A3_CO_dbh, y_A3_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A3_CO_dbh, y_A3_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A3_CO_dbh, y_A3_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A3_CO_dbh, y_A3_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A3_CO_dbh, y_A3_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A3_CO_dbh, y_A3_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RO
x_A3_RO = subset(alltree,plot=="A3" & sp=="RO")$dbh/min(subset(alltree,plot=="A3" & sp=="RO")$dbh)
length(x_A3_RO)
x_A3_RO_dbh = seq(min(x_A3_RO),max(x_A3_RO),length=1000)

plot(sort(x_A3_RO, decreasing=TRUE), 1:length(x_A3_RO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A3_RO), max(x_A3_RO)), ylim = c(1, length(x_A3_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A3_RO = function(x){
  b_pop = 2.106498
  n_pop = 38
  L2_com = 0.002781908
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A3_RO = function(x){
  b_pop = 2
  n_pop = 38
  S_0 = 8
  N_0 = 89
  L2_com = S_0/(sum(x_A3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A3_RO = function(x){
  al_pop = 3.584316465
  be_pop = 3.372236256
  ga_pop = -0.008227096
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A3_RO = Vectorize(fx_A3_RO)
# qwei_A3_RO = Vectorize(qwei_A3_RO)
y_A3_RO_PMETE = (1-cumsum(fx_A3_RO(x_A3_RO_dbh)*(max(x_A3_RO)-min(x_A3_RO))/1000))*length(x_A3_RO) # parametrized mete prediction
y_A3_RO_METE = (1-cumsum(gx_A3_RO(x_A3_RO_dbh)*(max(x_A3_RO)-min(x_A3_RO))/1000))*length(x_A3_RO) # mete prediction
y_A3_RO_EXP = exp(-0.4827279*(x_A3_RO_dbh-min(x_A3_RO_dbh)))*length(x_A3_RO)  # exponential distribution
y_A3_RO_POW = ((x_A3_RO_dbh)^(-0.9325271))*length(x_A3_RO) # power function distribution
y_A3_RO_WEI = (exp(1/(3.374498^3.580272)-(x_A3_RO_dbh/3.374498)^3.580272))*length(x_A3_RO) # Weibull distribution
y_A3_RO_QWEI = (1-cumsum(qwei_A3_RO(x_A3_RO_dbh)*(max(x_A3_RO)-min(x_A3_RO))/1000))*length(x_A3_RO) # quasi_Weibull distribution

lines(x_A3_RO_dbh, y_A3_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A3_RO_dbh, y_A3_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A3_RO_dbh, y_A3_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A3_RO_dbh, y_A3_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A3_RO_dbh, y_A3_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A3_RO_dbh, y_A3_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
### plot A4
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### BG
x_A4_BG = subset(alltree,plot=="A4" & sp=="BG")$dbh/min(subset(alltree,plot=="A4" & sp=="BG")$dbh)
length(x_A4_BG)
x_A4_BG_dbh = seq(min(x_A4_BG),max(x_A4_BG),length=1000)

plot(sort(x_A4_BG, decreasing=TRUE), 1:length(x_A4_BG), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A4_BG), max(x_A4_BG)), ylim = c(1, length(x_A4_BG)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A4_BG = function(x){
  b_pop = 1.521444
  n_pop = 20
  L2_com = 0.007243553
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A4_BG = function(x){
  b_pop = 2
  n_pop = 20
  S_0 = 8
  N_0 = 56
  L2_com = S_0/(sum(x_A4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A4_BG = function(x){
  al_pop = 6.248300e-06
  be_pop = 8.830575e+00
  ga_pop = 3.415777e+02
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A4_BG = Vectorize(fx_A4_BG)
# qwei_A4_BG = Vectorize(qwei_A4_BG)
y_A4_BG_PMETE = (1-cumsum(fx_A4_BG(x_A4_BG_dbh)*(max(x_A4_BG)-min(x_A4_BG))/1000))*length(x_A4_BG) # parametrized mete prediction
y_A4_BG_METE = (1-cumsum(gx_A4_BG(x_A4_BG_dbh)*(max(x_A4_BG)-min(x_A4_BG))/1000))*length(x_A4_BG) # mete prediction
y_A4_BG_EXP = exp(-0.4084507*(x_A4_BG_dbh-min(x_A4_BG_dbh)))*length(x_A4_BG)  # exponential distribution
y_A4_BG_POW = ((x_A4_BG_dbh)^(-0.9544281))*length(x_A4_BG) # power function distribution
y_A4_BG_WEI = (exp(1/(2.871910^1.180397)-(x_A4_BG_dbh/2.871910)^1.180397))*length(x_A4_BG) # Weibull distribution
y_A4_BG_QWEI = (1-cumsum(qwei_A4_BG(x_A4_BG_dbh)*(max(x_A4_BG)-min(x_A4_BG))/1000))*length(x_A4_BG) # quasi_Weibull distribution

lines(x_A4_BG_dbh, y_A4_BG_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A4_BG_dbh, y_A4_BG_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A4_BG_dbh, y_A4_BG_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A4_BG_dbh, y_A4_BG_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A4_BG_dbh, y_A4_BG_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A4_BG_dbh, y_A4_BG_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BG", bty="n",cex=1.5)

#### CO
x_A4_CO = subset(alltree,plot=="A4" & sp=="CO")$dbh/min(subset(alltree,plot=="A4" & sp=="CO")$dbh)
length(x_A4_CO)
x_A4_CO_dbh = seq(min(x_A4_CO),max(x_A4_CO),length=1000)

plot(sort(x_A4_CO, decreasing=TRUE), 1:length(x_A4_CO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A4_CO), max(x_A4_CO)), ylim = c(1, length(x_A4_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A4_CO = function(x){
  b_pop = 0.8093221
  n_pop = 46
  L2_com = 0.007243553
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A4_CO = function(x){
  b_pop = 2
  n_pop = 46
  S_0 = 8
  N_0 = 56
  L2_com = S_0/(sum(x_A4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A4_CO = function(x){
  al_pop = 2.513649
  be_pop = 9.527906
  ga_pop = 5.286762
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A4_CO = Vectorize(fx_A4_CO)
# qwei_A4_CO = Vectorize(qwei_A4_CO)
y_A4_CO_PMETE = (1-cumsum(fx_A4_CO(x_A4_CO_dbh)*(max(x_A4_CO)-min(x_A4_CO))/1000))*length(x_A4_CO) # parametrized mete prediction
y_A4_CO_METE = (1-cumsum(gx_A4_CO(x_A4_CO_dbh)*(max(x_A4_CO)-min(x_A4_CO))/1000))*length(x_A4_CO) # mete prediction
y_A4_CO_EXP = exp(-0.1707108*(x_A4_CO_dbh-min(x_A4_CO_dbh)))*length(x_A4_CO)  # exponential distribution
y_A4_CO_POW = ((x_A4_CO_dbh)^(-0.5414401))*length(x_A4_CO) # power function distribution
y_A4_CO_WEI = (exp(1/(7.572749^3.635706)-(x_A4_CO_dbh/7.572749)^3.635706))*length(x_A4_CO) # Weibull distribution
y_A4_CO_QWEI = (1-cumsum(qwei_A4_CO(x_A4_CO_dbh)*(max(x_A4_CO)-min(x_A4_CO))/1000))*length(x_A4_CO) # quasi_Weibull distribution

lines(x_A4_CO_dbh, y_A4_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A4_CO_dbh, y_A4_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A4_CO_dbh, y_A4_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A4_CO_dbh, y_A4_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A4_CO_dbh, y_A4_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A4_CO_dbh, y_A4_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RM
x_A4_RM = subset(alltree,plot=="A4" & sp=="RM")$dbh/min(subset(alltree,plot=="A4" & sp=="RM")$dbh)
length(x_A4_RM)
x_A4_RM_dbh = seq(min(x_A4_RM),max(x_A4_RM),length=1000)

plot(sort(x_A4_RM, decreasing=TRUE), 1:length(x_A4_RM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_A4_RM), max(x_A4_RM)), ylim = c(1, length(x_A4_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A4_RM = function(x){
  b_pop = 2.025387
  n_pop = 18
  L2_com = 0.007243553
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A4_RM = function(x){
  b_pop = 2
  n_pop = 18
  S_0 = 8
  N_0 = 56
  L2_com = S_0/(sum(x_A4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A4_RM = function(x){
  al_pop = 5.6892087
  be_pop = 0.2339407
  ga_pop = -4.8709633
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A4_RM = Vectorize(fx_A4_RM)
# qwei_A4_RM = Vectorize(qwei_A4_RM)
y_A4_RM_PMETE = (1-cumsum(fx_A4_RM(x_A4_RM_dbh)*(max(x_A4_RM)-min(x_A4_RM))/1000))*length(x_A4_RM) # parametrized mete prediction
y_A4_RM_METE = (1-cumsum(gx_A4_RM(x_A4_RM_dbh)*(max(x_A4_RM)-min(x_A4_RM))/1000))*length(x_A4_RM) # mete prediction
y_A4_RM_EXP = exp(-0.6069364*(x_A4_RM_dbh-min(x_A4_RM_dbh)))*length(x_A4_RM)  # exponential distribution
y_A4_RM_POW = ((x_A4_RM_dbh)^(-1.127111))*length(x_A4_RM) # power function distribution
y_A4_RM_WEI = (exp(1/(2.679557^1.951610)-(x_A4_RM_dbh/2.679557)^1.951610))*length(x_A4_RM) # Weibull distribution
y_A4_RM_QWEI = (1-cumsum(qwei_A4_RM(x_A4_RM_dbh)*(max(x_A4_RM)-min(x_A4_RM))/1000))*length(x_A4_RM) # quasi_Weibull distribution

lines(x_A4_RM_dbh, y_A4_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A4_RM_dbh, y_A4_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A4_RM_dbh, y_A4_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A4_RM_dbh, y_A4_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A4_RM_dbh, y_A4_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A4_RM_dbh, y_A4_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_A4_RO = subset(alltree,plot=="A4" & sp=="RO")$dbh/min(subset(alltree,plot=="A4" & sp=="RO")$dbh)
length(x_A4_RO)
x_A4_RO_dbh = seq(min(x_A4_RO),max(x_A4_RO),length=1000)

plot(sort(x_A4_RO, decreasing=TRUE), 1:length(x_A4_RO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_A4_RO), max(x_A4_RO)), ylim = c(1, length(x_A4_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_A4_RO = function(x){
  b_pop = 0.7226214
  n_pop = 47
  L2_com = 0.007243553
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_A4_RO = function(x){
  b_pop = 2
  n_pop = 47
  S_0 = 8
  N_0 = 56
  L2_com = S_0/(sum(x_A4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_A4_RO = function(x){
  al_pop = 2.14373
  be_pop = 11.15249
  ga_pop = 1.17640
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_A4_RO = Vectorize(fx_A4_RO)
# qwei_A4_RO = Vectorize(qwei_A4_RO)
y_A4_RO_PMETE = (1-cumsum(fx_A4_RO(x_A4_RO_dbh)*(max(x_A4_RO)-min(x_A4_RO))/1000))*length(x_A4_RO) # parametrized mete prediction
y_A4_RO_METE = (1-cumsum(gx_A4_RO(x_A4_RO_dbh)*(max(x_A4_RO)-min(x_A4_RO))/1000))*length(x_A4_RO) # mete prediction
y_A4_RO_EXP = exp(-0.1349997*(x_A4_RO_dbh-min(x_A4_RO_dbh)))*length(x_A4_RO)  # exponential distribution
y_A4_RO_POW = ((x_A4_RO_dbh)^(-0.4989581))*length(x_A4_RO) # power function distribution
y_A4_RO_WEI = (exp(1/(9.351228^2.751040)-(x_A4_RO_dbh/9.351228)^2.751040))*length(x_A4_RO) # Weibull distribution
y_A4_RO_QWEI = (1-cumsum(qwei_A4_RO(x_A4_RO_dbh)*(max(x_A4_RO)-min(x_A4_RO))/1000))*length(x_A4_RO) # quasi_Weibull distribution

lines(x_A4_RO_dbh, y_A4_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_A4_RO_dbh, y_A4_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_A4_RO_dbh, y_A4_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_A4_RO_dbh, y_A4_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_A4_RO_dbh, y_A4_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_A4_RO_dbh, y_A4_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
### plot B1
```{r}
par(mfrow=c(3,3),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### BB
x_B1_BB = subset(alltree,plot=="B1" & sp=="BB")$dbh/min(subset(alltree,plot=="B1" & sp=="BB")$dbh)
length(x_B1_BB)
x_B1_BB_dbh = seq(min(x_B1_BB),max(x_B1_BB),length=1000)

plot(sort(x_B1_BB, decreasing=TRUE), 1:length(x_B1_BB), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_B1_BB), max(x_B1_BB)), ylim = c(1, length(x_B1_BB)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_BB = function(x){
  b_pop = 1.354501
  n_pop = 18
  L2_com = 0.0178904
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_BB = function(x){
  b_pop = 2
  n_pop = 18
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_BB = function(x){
  al_pop = 0.05607294
  be_pop = 5.90256905
  ga_pop = 419.64500622
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_BB = Vectorize(fx_B1_BB)
# qwei_B1_BB = Vectorize(qwei_B1_BB)
y_B1_BB_PMETE = (1-cumsum(fx_B1_BB(x_B1_BB_dbh)*(max(x_B1_BB)-min(x_B1_BB))/1000))*length(x_B1_BB) # parametrized mete prediction
y_B1_BB_METE = (1-cumsum(gx_B1_BB(x_B1_BB_dbh)*(max(x_B1_BB)-min(x_B1_BB))/1000))*length(x_B1_BB) # mete prediction
y_B1_BB_EXP = exp(-0.5710928*(x_B1_BB_dbh-min(x_B1_BB_dbh)))*length(x_B1_BB)  # exponential distribution
y_B1_BB_POW = ((x_B1_BB_dbh)^(-1.135565))*length(x_B1_BB) # power function distribution
y_B1_BB_WEI = (exp(1/(2.524625^1.514095)-(x_B1_BB_dbh/2.524625)^1.514095))*length(x_B1_BB) # Weibull distribution
y_B1_BB_QWEI = (1-cumsum(qwei_B1_BB(x_B1_BB_dbh)*(max(x_B1_BB)-min(x_B1_BB))/1000))*length(x_B1_BB) # quasi_Weibull distribution

lines(x_B1_BB_dbh, y_B1_BB_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_BB_dbh, y_B1_BB_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_BB_dbh, y_B1_BB_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_BB_dbh, y_B1_BB_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_BB_dbh, y_B1_BB_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_BB_dbh, y_B1_BB_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BB", bty="n",cex=1.5)

#### BG
x_B1_BG = subset(alltree,plot=="B1" & sp=="BG")$dbh/min(subset(alltree,plot=="B1" & sp=="BG")$dbh)
length(x_B1_BG)
x_B1_BG_dbh = seq(min(x_B1_BG),max(x_B1_BG),length=1000)

plot(sort(x_B1_BG, decreasing=TRUE), 1:length(x_B1_BG), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B1_BG), max(x_B1_BG)), ylim = c(1, length(x_B1_BG)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_BG = function(x){
  b_pop = 1.450028
  n_pop = 20
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_BG = function(x){
  b_pop = 2
  n_pop = 20
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_BG = function(x){
  al_pop = 0.3265689
  be_pop = 4.4084995
  ga_pop = 501.9423062
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_BG = Vectorize(fx_B1_BG)
# qwei_B1_BG = Vectorize(qwei_B1_BG)
y_B1_BG_PMETE = (1-cumsum(fx_B1_BG(x_B1_BG_dbh)*(max(x_B1_BG)-min(x_B1_BG))/1000))*length(x_B1_BG) # parametrized mete prediction
y_B1_BG_METE = (1-cumsum(gx_B1_BG(x_B1_BG_dbh)*(max(x_B1_BG)-min(x_B1_BG))/1000))*length(x_B1_BG) # mete prediction
y_B1_BG_EXP = exp(-0.6847361*(x_B1_BG_dbh-min(x_B1_BG_dbh)))*length(x_B1_BG)  # exponential distribution
y_B1_BG_POW = ((x_B1_BG_dbh)^(-1.250695))*length(x_B1_BG) # power function distribution
y_B1_BG_WEI = (exp(1/(2.408508^1.864105)-(x_B1_BG_dbh/2.408508)^1.864105))*length(x_B1_BG) # Weibull distribution
y_B1_BG_QWEI = (1-cumsum(qwei_B1_BG(x_B1_BG_dbh)*(max(x_B1_BG)-min(x_B1_BG))/1000))*length(x_B1_BG) # quasi_Weibull distribution

lines(x_B1_BG_dbh, y_B1_BG_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_BG_dbh, y_B1_BG_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_BG_dbh, y_B1_BG_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_BG_dbh, y_B1_BG_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_BG_dbh, y_B1_BG_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_BG_dbh, y_B1_BG_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BG", bty="n",cex=1.5)

#### BO
x_B1_BO = subset(alltree,plot=="B1" & sp=="BO")$dbh/min(subset(alltree,plot=="B1" & sp=="BO")$dbh)
length(x_B1_BO)
x_B1_BO_dbh = seq(min(x_B1_BO),max(x_B1_BO),length=1000)

plot(sort(x_B1_BO, decreasing=TRUE), 1:length(x_B1_BO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B1_BO), max(x_B1_BO)), ylim = c(1, length(x_B1_BO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_BO = function(x){
  b_pop = 3.951175
  n_pop = 10
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_BO = function(x){
  b_pop = 2
  n_pop = 10
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_BO = function(x){
  al_pop = 3.538328e+01
  be_pop = 6.848396e-09
  ga_pop = -3.512380e+01
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_BO = Vectorize(fx_B1_BO)
# qwei_B1_BO = Vectorize(qwei_B1_BO)
y_B1_BO_PMETE = (1-cumsum(fx_B1_BO(x_B1_BO_dbh)*(max(x_B1_BO)-min(x_B1_BO))/1000))*length(x_B1_BO) # parametrized mete prediction
y_B1_BO_METE = (1-cumsum(gx_B1_BO(x_B1_BO_dbh)*(max(x_B1_BO)-min(x_B1_BO))/1000))*length(x_B1_BO) # mete prediction
y_B1_BO_EXP = exp(-2.461431*(x_B1_BO_dbh-min(x_B1_BO_dbh)))*length(x_B1_BO)  # exponential distribution
y_B1_BO_POW = ((x_B1_BO_dbh)^(-3.170961))*length(x_B1_BO) # power function distribution
y_B1_BO_WEI = (exp(1/(0.971211^1.828624)-(x_B1_BO_dbh/0.971211)^1.828624))*length(x_B1_BO) # Weibull distribution
y_B1_BO_QWEI = (1-cumsum(qwei_B1_BO(x_B1_BO_dbh)*(max(x_B1_BO)-min(x_B1_BO))/1000))*length(x_B1_BO) # quasi_Weibull distribution

lines(x_B1_BO_dbh, y_B1_BO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_BO_dbh, y_B1_BO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_BO_dbh, y_B1_BO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_BO_dbh, y_B1_BO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_BO_dbh, y_B1_BO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_BO_dbh, y_B1_BO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BO", bty="n",cex=1.5)

#### CO
x_B1_CO = subset(alltree,plot=="B1" & sp=="CO")$dbh/min(subset(alltree,plot=="B1" & sp=="CO")$dbh)
length(x_B1_CO)
x_B1_CO_dbh = seq(min(x_B1_CO),max(x_B1_CO),length=1000)

plot(sort(x_B1_CO, decreasing=TRUE), 1:length(x_B1_CO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_B1_CO), max(x_B1_CO)), ylim = c(1, length(x_B1_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_CO = function(x){
  b_pop = 0.962538
  n_pop = 13
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_CO = function(x){
  b_pop = 2
  n_pop = 13
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_CO = function(x){
  al_pop = 0.6455117
  be_pop = 12.3317570
  ga_pop = 295.9624073
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_CO = Vectorize(fx_B1_CO)
# qwei_B1_CO = Vectorize(qwei_B1_CO)
y_B1_CO_PMETE = (1-cumsum(fx_B1_CO(x_B1_CO_dbh)*(max(x_B1_CO)-min(x_B1_CO))/1000))*length(x_B1_CO) # parametrized mete prediction
y_B1_CO_METE = (1-cumsum(gx_B1_CO(x_B1_CO_dbh)*(max(x_B1_CO)-min(x_B1_CO))/1000))*length(x_B1_CO) # mete prediction
y_B1_CO_EXP = exp(-0.1955587*(x_B1_CO_dbh-min(x_B1_CO_dbh)))*length(x_B1_CO)  # exponential distribution
y_B1_CO_POW = ((x_B1_CO_dbh)^(-0.6321674))*length(x_B1_CO) # power function distribution
y_B1_CO_WEI = (exp(1/(6.376294^1.492998)-(x_B1_CO_dbh/6.376294)^1.492998))*length(x_B1_CO) # Weibull distribution
y_B1_CO_QWEI = (1-cumsum(qwei_B1_CO(x_B1_CO_dbh)*(max(x_B1_CO)-min(x_B1_CO))/1000))*length(x_B1_CO) # quasi_Weibull distribution

lines(x_B1_CO_dbh, y_B1_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_CO_dbh, y_B1_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_CO_dbh, y_B1_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_CO_dbh, y_B1_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_CO_dbh, y_B1_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_CO_dbh, y_B1_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RM
x_B1_RM = subset(alltree,plot=="B1" & sp=="RM")$dbh/min(subset(alltree,plot=="B1" & sp=="RM")$dbh)
length(x_B1_RM)
x_B1_RM_dbh = seq(min(x_B1_RM),max(x_B1_RM),length=1000)

plot(sort(x_B1_RM, decreasing=TRUE), 1:length(x_B1_RM), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B1_RM), max(x_B1_RM)), ylim = c(1, length(x_B1_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_RM = function(x){
  b_pop = 1.64463
  n_pop = 14
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_RM = function(x){
  b_pop = 2
  n_pop = 14
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_RM = function(x){
  al_pop = 1.498638e-06
  be_pop = 3.841146e+00
  ga_pop = 1.743885e+00
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_RM = Vectorize(fx_B1_RM)
# qwei_B1_RM = Vectorize(qwei_B1_RM)
y_B1_RM_PMETE = (1-cumsum(fx_B1_RM(x_B1_RM_dbh)*(max(x_B1_RM)-min(x_B1_RM))/1000))*length(x_B1_RM) # parametrized mete prediction
y_B1_RM_METE = (1-cumsum(gx_B1_RM(x_B1_RM_dbh)*(max(x_B1_RM)-min(x_B1_RM))/1000))*length(x_B1_RM) # mete prediction
y_B1_RM_EXP = exp(-0.8055556*(x_B1_RM_dbh-min(x_B1_RM_dbh)))*length(x_B1_RM)  # exponential distribution
y_B1_RM_POW = ((x_B1_RM_dbh)^(-1.472311))*length(x_B1_RM) # power function distribution
y_B1_RM_WEI = (exp(1/(0.9613768^0.8590239)-(x_B1_RM_dbh/0.9613768)^0.8590239))*length(x_B1_RM) # Weibull distribution
y_B1_RM_QWEI = (1-cumsum(qwei_B1_RM(x_B1_RM_dbh)*(max(x_B1_RM)-min(x_B1_RM))/1000))*length(x_B1_RM) # quasi_Weibull distribution

lines(x_B1_RM_dbh, y_B1_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_RM_dbh, y_B1_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_RM_dbh, y_B1_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_RM_dbh, y_B1_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_RM_dbh, y_B1_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_RM_dbh, y_B1_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_B1_RO = subset(alltree,plot=="B1" & sp=="RO")$dbh/min(subset(alltree,plot=="B1" & sp=="RO")$dbh)
length(x_B1_RO)
x_B1_RO_dbh = seq(min(x_B1_RO),max(x_B1_RO),length=1000)

plot(sort(x_B1_RO, decreasing=TRUE), 1:length(x_B1_RO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B1_RO), max(x_B1_RO)), ylim = c(1, length(x_B1_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_RO = function(x){
  b_pop = 1.06761
  n_pop = 33
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_RO = function(x){
  b_pop = 2
  n_pop = 33
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_RO = function(x){
  al_pop = 6.0955718
  be_pop = 3.0116664
  ga_pop = -0.6597463
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_RO = Vectorize(fx_B1_RO)
# qwei_B1_RO = Vectorize(qwei_B1_RO)
y_B1_RO_PMETE = (1-cumsum(fx_B1_RO(x_B1_RO_dbh)*(max(x_B1_RO)-min(x_B1_RO))/1000))*length(x_B1_RO) # parametrized mete prediction
y_B1_RO_METE = (1-cumsum(gx_B1_RO(x_B1_RO_dbh)*(max(x_B1_RO)-min(x_B1_RO))/1000))*length(x_B1_RO) # mete prediction
y_B1_RO_EXP = exp(-0.5338059*(x_B1_RO_dbh-min(x_B1_RO_dbh)))*length(x_B1_RO)  # exponential distribution
y_B1_RO_POW = ((x_B1_RO_dbh)^(-0.9695391))*length(x_B1_RO) # power function distribution
y_B1_RO_WEI = (exp(1/(3.089733^5.794737)-(x_B1_RO_dbh/3.089733)^5.794737))*length(x_B1_RO) # Weibull distribution
y_B1_RO_QWEI = (1-cumsum(qwei_B1_RO(x_B1_RO_dbh)*(max(x_B1_RO)-min(x_B1_RO))/1000))*length(x_B1_RO) # quasi_Weibull distribution

lines(x_B1_RO_dbh, y_B1_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_RO_dbh, y_B1_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_RO_dbh, y_B1_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_RO_dbh, y_B1_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_RO_dbh, y_B1_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_RO_dbh, y_B1_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)

#### SM
x_B1_SM = subset(alltree,plot=="B1" & sp=="SM")$dbh/min(subset(alltree,plot=="B1" & sp=="SM")$dbh)
length(x_B1_SM)
x_B1_SM_dbh = seq(min(x_B1_SM),max(x_B1_SM),length=1000)

plot(sort(x_B1_SM, decreasing=TRUE), 1:length(x_B1_SM), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_B1_SM), max(x_B1_SM)), ylim = c(1, length(x_B1_SM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B1_SM = function(x){
  b_pop = 1.104046
  n_pop = 16
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B1_SM = function(x){
  b_pop = 2
  n_pop = 16
  S_0 = 13
  N_0 = 84
  L2_com = S_0/(sum(x_B1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B1_SM = function(x){
  al_pop = 0.0037612055
  be_pop = 0.0003108951
  ga_pop = 0.1906999149
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B1_SM = Vectorize(fx_B1_SM)
# qwei_B1_SM = Vectorize(qwei_B1_SM)
y_B1_SM_PMETE = (1-cumsum(fx_B1_SM(x_B1_SM_dbh)*(max(x_B1_SM)-min(x_B1_SM))/1000))*length(x_B1_SM) # parametrized mete prediction
y_B1_SM_METE = (1-cumsum(gx_B1_SM(x_B1_SM_dbh)*(max(x_B1_SM)-min(x_B1_SM))/1000))*length(x_B1_SM) # mete prediction
y_B1_SM_EXP = exp(-0.4716553*(x_B1_SM_dbh-min(x_B1_SM_dbh)))*length(x_B1_SM)  # exponential distribution
y_B1_SM_POW = ((x_B1_SM_dbh)^(-1.255581))*length(x_B1_SM) # power function distribution
y_B1_SM_WEI = (exp(1/(1.262792e-06^1.487059e-01)-(x_B1_SM_dbh/1.262792e-06)^1.487059e-01))*length(x_B1_SM) # Weibull distribution
y_B1_SM_QWEI = (1-cumsum(qwei_B1_SM(x_B1_SM_dbh)*(max(x_B1_SM)-min(x_B1_SM))/1000))*length(x_B1_SM) # quasi_Weibull distribution

lines(x_B1_SM_dbh, y_B1_SM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B1_SM_dbh, y_B1_SM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B1_SM_dbh, y_B1_SM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B1_SM_dbh, y_B1_SM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B1_SM_dbh, y_B1_SM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B1_SM_dbh, y_B1_SM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SM", bty="n",cex=1.5)
```
### plot B2
```{r}
par(mfrow=c(3,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### BG
x_B2_BG = subset(alltree,plot=="B2" & sp=="BG")$dbh/min(subset(alltree,plot=="B2" & sp=="BG")$dbh)
length(x_B2_BG)
x_B2_BG_dbh = seq(min(x_B2_BG),max(x_B2_BG),length=1000)

plot(sort(x_B2_BG, decreasing=TRUE), 1:length(x_B2_BG), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_B2_BG), max(x_B2_BG)), ylim = c(1, length(x_B2_BG)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B2_BG = function(x){
  b_pop = 1.071082
  n_pop = 40
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B2_BG = function(x){
  b_pop = 2
  n_pop = 40
  S_0 = 10
  N_0 = 88
  L2_com = S_0/(sum(x_B2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B2_BG = function(x){
  al_pop = 5.358973e-06
  be_pop = 6.128945e+00
  ga_pop = 2.694377e+00
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B2_BG = Vectorize(fx_B2_BG)
# qwei_B2_BG = Vectorize(qwei_B2_BG)
y_B2_BG_PMETE = (1-cumsum(fx_B2_BG(x_B2_BG_dbh)*(max(x_B2_BG)-min(x_B2_BG))/1000))*length(x_B2_BG) # parametrized mete prediction
y_B2_BG_METE = (1-cumsum(gx_B2_BG(x_B2_BG_dbh)*(max(x_B2_BG)-min(x_B2_BG))/1000))*length(x_B2_BG) # mete prediction
y_B2_BG_EXP = exp(-0.5660377*(x_B2_BG_dbh-min(x_B2_BG_dbh)))*length(x_B2_BG)  # exponential distribution
y_B2_BG_POW = ((x_B2_BG_dbh)^(-1.167629))*length(x_B2_BG) # power function distribution
y_B2_BG_WEI = (exp(1/(1.849078^1.037458)-(x_B2_BG_dbh/1.849078)^1.037458))*length(x_B2_BG) # Weibull distribution
y_B2_BG_QWEI = (1-cumsum(qwei_B2_BG(x_B2_BG_dbh)*(max(x_B2_BG)-min(x_B2_BG))/1000))*length(x_B2_BG) # quasi_Weibull distribution

lines(x_B2_BG_dbh, y_B2_BG_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B2_BG_dbh, y_B2_BG_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B2_BG_dbh, y_B2_BG_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B2_BG_dbh, y_B2_BG_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B2_BG_dbh, y_B2_BG_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B2_BG_dbh, y_B2_BG_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BG", bty="n",cex=1.5)

#### RM
x_B2_RM = subset(alltree,plot=="B2" & sp=="RM")$dbh/min(subset(alltree,plot=="B2" & sp=="RM")$dbh)
length(x_B2_RM)
x_B2_RM_dbh = seq(min(x_B2_RM),max(x_B2_RM),length=1000)

plot(sort(x_B2_RM, decreasing=TRUE), 1:length(x_B2_RM), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B2_RM), max(x_B2_RM)), ylim = c(1, length(x_B2_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B2_RM = function(x){
  b_pop = 2.373575
  n_pop = 16
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B2_RM = function(x){
  b_pop = 2
  n_pop = 16
  S_0 = 10
  N_0 = 88
  L2_com = S_0/(sum(x_B2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B2_RM = function(x){
  al_pop = 0.01194927
  be_pop = 3.33039766
  ga_pop = 619.02737343
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B2_RM = Vectorize(fx_B2_RM)
# qwei_B2_RM = Vectorize(qwei_B2_RM)
y_B2_RM_PMETE = (1-cumsum(fx_B2_RM(x_B2_RM_dbh)*(max(x_B2_RM)-min(x_B2_RM))/1000))*length(x_B2_RM) # parametrized mete prediction
y_B2_RM_METE = (1-cumsum(gx_B2_RM(x_B2_RM_dbh)*(max(x_B2_RM)-min(x_B2_RM))/1000))*length(x_B2_RM) # mete prediction
y_B2_RM_EXP = exp(-1.069124*(x_B2_RM_dbh-min(x_B2_RM_dbh)))*length(x_B2_RM)  # exponential distribution
y_B2_RM_POW = ((x_B2_RM_dbh)^(-1.697426))*length(x_B2_RM) # power function distribution
y_B2_RM_WEI = (exp(1/(1.758613^1.909059)-(x_B2_RM_dbh/1.758613)^1.909059))*length(x_B2_RM) # Weibull distribution
y_B2_RM_QWEI = (1-cumsum(qwei_B2_RM(x_B2_RM_dbh)*(max(x_B2_RM)-min(x_B2_RM))/1000))*length(x_B2_RM) # quasi_Weibull distribution

lines(x_B2_RM_dbh, y_B2_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B2_RM_dbh, y_B2_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B2_RM_dbh, y_B2_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B2_RM_dbh, y_B2_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B2_RM_dbh, y_B2_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B2_RM_dbh, y_B2_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_B2_RO = subset(alltree,plot=="B2" & sp=="RO")$dbh/min(subset(alltree,plot=="B2" & sp=="RO")$dbh)
length(x_B2_RO)
x_B2_RO_dbh = seq(min(x_B2_RO),max(x_B2_RO),length=1000)

plot(sort(x_B2_RO, decreasing=TRUE), 1:length(x_B2_RO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_B2_RO), max(x_B2_RO)), ylim = c(1, length(x_B2_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B2_RO = function(x){
  b_pop = 1.299961
  n_pop = 67
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B2_RO = function(x){
  b_pop = 2
  n_pop = 67
  S_0 = 10
  N_0 = 88
  L2_com = S_0/(sum(x_B2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B2_RO = function(x){
  al_pop = 8.033825
  be_pop = 1.389779
  ga_pop = -5.240425
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B2_RO = Vectorize(fx_B2_RO)
# qwei_B2_RO = Vectorize(qwei_B2_RO)
y_B2_RO_PMETE = (1-cumsum(fx_B2_RO(x_B2_RO_dbh)*(max(x_B2_RO)-min(x_B2_RO))/1000))*length(x_B2_RO) # parametrized mete prediction
y_B2_RO_METE = (1-cumsum(gx_B2_RO(x_B2_RO_dbh)*(max(x_B2_RO)-min(x_B2_RO))/1000))*length(x_B2_RO) # mete prediction
y_B2_RO_EXP = exp(-1.042191*(x_B2_RO_dbh-min(x_B2_RO_dbh)))*length(x_B2_RO)  # exponential distribution
y_B2_RO_POW = ((x_B2_RO_dbh)^(-1.539378))*length(x_B2_RO) # power function distribution
y_B2_RO_WEI = (exp(1/(2.101412^4.774965)-(x_B2_RO_dbh/2.101412)^4.774965))*length(x_B2_RO) # Weibull distribution
y_B2_RO_QWEI = (1-cumsum(qwei_B2_RO(x_B2_RO_dbh)*(max(x_B2_RO)-min(x_B2_RO))/1000))*length(x_B2_RO) # quasi_Weibull distribution

lines(x_B2_RO_dbh, y_B2_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B2_RO_dbh, y_B2_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B2_RO_dbh, y_B2_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B2_RO_dbh, y_B2_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B2_RO_dbh, y_B2_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B2_RO_dbh, y_B2_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)

#### SM
x_B2_SM = subset(alltree,plot=="B2" & sp=="SM")$dbh/min(subset(alltree,plot=="B2" & sp=="SM")$dbh)
length(x_B2_SM)
x_B2_SM_dbh = seq(min(x_B2_SM),max(x_B2_SM),length=1000)

plot(sort(x_B2_SM, decreasing=TRUE), 1:length(x_B2_SM), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B2_SM), max(x_B2_SM)), ylim = c(1, length(x_B2_SM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B2_SM = function(x){
  b_pop = 1.705536
  n_pop = 10
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B2_SM = function(x){
  b_pop = 2
  n_pop = 10
  S_0 = 10
  N_0 = 88
  L2_com = S_0/(sum(x_B2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B2_SM = function(x){
  al_pop = 0.004091452
  be_pop = 0.398575716
  ga_pop = 0.468195371
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B2_SM = Vectorize(fx_B2_SM)
# qwei_B2_SM = Vectorize(qwei_B2_SM)
y_B2_SM_PMETE = (1-cumsum(fx_B2_SM(x_B2_SM_dbh)*(max(x_B2_SM)-min(x_B2_SM))/1000))*length(x_B2_SM) # parametrized mete prediction
y_B2_SM_METE = (1-cumsum(gx_B2_SM(x_B2_SM_dbh)*(max(x_B2_SM)-min(x_B2_SM))/1000))*length(x_B2_SM) # mete prediction
y_B2_SM_EXP = exp(-0.6294964*(x_B2_SM_dbh-min(x_B2_SM_dbh)))*length(x_B2_SM)  # exponential distribution
y_B2_SM_POW = ((x_B2_SM_dbh)^(-1.374076))*length(x_B2_SM) # power function distribution
y_B2_SM_WEI = (exp(1/(0.03994191^0.35054134)-(x_B2_SM_dbh/0.03994191)^0.35054134))*length(x_B2_SM) # Weibull distribution
y_B2_SM_QWEI = (1-cumsum(qwei_B2_SM(x_B2_SM_dbh)*(max(x_B2_SM)-min(x_B2_SM))/1000))*length(x_B2_SM) # quasi_Weibull distribution

lines(x_B2_SM_dbh, y_B2_SM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B2_SM_dbh, y_B2_SM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B2_SM_dbh, y_B2_SM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B2_SM_dbh, y_B2_SM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B2_SM_dbh, y_B2_SM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B2_SM_dbh, y_B2_SM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SM", bty="n",cex=1.5)

#### WO
x_B2_WO = subset(alltree,plot=="B2" & sp=="WO")$dbh/min(subset(alltree,plot=="B2" & sp=="WO")$dbh)
length(x_B2_WO)
x_B2_WO_dbh = seq(min(x_B2_WO),max(x_B2_WO),length=1000)

plot(sort(x_B2_WO, decreasing=TRUE), 1:length(x_B2_WO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_B2_WO), max(x_B2_WO)), ylim = c(1, length(x_B2_WO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B2_WO = function(x){
  b_pop = 0.9806683
  n_pop = 14
  L2_com = 0.01237152
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B2_WO = function(x){
  b_pop = 2
  n_pop = 14
  S_0 = 10
  N_0 = 88
  L2_com = S_0/(sum(x_B2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B2_WO = function(x){
  al_pop = 1.328244
  be_pop = 13.476570
  ga_pop = 7.946150
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B2_WO = Vectorize(fx_B2_WO)
# qwei_B2_WO = Vectorize(qwei_B2_WO)
y_B2_WO_PMETE = (1-cumsum(fx_B2_WO(x_B2_WO_dbh)*(max(x_B2_WO)-min(x_B2_WO))/1000))*length(x_B2_WO) # parametrized mete prediction
y_B2_WO_METE = (1-cumsum(gx_B2_WO(x_B2_WO_dbh)*(max(x_B2_WO)-min(x_B2_WO))/1000))*length(x_B2_WO) # mete prediction
y_B2_WO_EXP = exp(-0.1426307*(x_B2_WO_dbh-min(x_B2_WO_dbh)))*length(x_B2_WO)  # exponential distribution
y_B2_WO_POW = ((x_B2_WO_dbh)^(-0.5266548))*length(x_B2_WO) # power function distribution
y_B2_WO_WEI = (exp(1/(8.869936^2.327280)-(x_B2_WO_dbh/8.869936)^2.327280))*length(x_B2_WO) # Weibull distribution
y_B2_WO_QWEI = (1-cumsum(qwei_B2_WO(x_B2_WO_dbh)*(max(x_B2_WO)-min(x_B2_WO))/1000))*length(x_B2_WO) # quasi_Weibull distribution

lines(x_B2_WO_dbh, y_B2_WO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B2_WO_dbh, y_B2_WO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B2_WO_dbh, y_B2_WO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B2_WO_dbh, y_B2_WO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B2_WO_dbh, y_B2_WO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B2_WO_dbh, y_B2_WO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "WO", bty="n",cex=1.5)
```
### plot B3
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### CO
x_B3_CO = subset(alltree,plot=="B3" & sp=="CO")$dbh/min(subset(alltree,plot=="B3" & sp=="CO")$dbh)
length(x_B3_CO)
x_B3_CO_dbh = seq(min(x_B3_CO),max(x_B3_CO),length=1000)

plot(sort(x_B3_CO, decreasing=TRUE), 1:length(x_B3_CO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_B3_CO), max(x_B3_CO)), ylim = c(1, length(x_B3_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B3_CO = function(x){
  b_pop = 0.7452609
  n_pop = 46
  L2_com = 0.01520995
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B3_CO = function(x){
  b_pop = 2
  n_pop = 46
  S_0 = 9
  N_0 = 61
  L2_com = S_0/(sum(x_B3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B3_CO = function(x){
  al_pop = 2.367074
  be_pop = 5.097022
  ga_pop = 1.699474
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B3_CO = Vectorize(fx_B3_CO)
# qwei_B3_CO = Vectorize(qwei_B3_CO)
y_B3_CO_PMETE = (1-cumsum(fx_B3_CO(x_B3_CO_dbh)*(max(x_B3_CO)-min(x_B3_CO))/1000))*length(x_B3_CO) # parametrized mete prediction
y_B3_CO_METE = (1-cumsum(gx_B3_CO(x_B3_CO_dbh)*(max(x_B3_CO)-min(x_B3_CO))/1000))*length(x_B3_CO) # mete prediction
y_B3_CO_EXP = exp(-0.3501252*(x_B3_CO_dbh-min(x_B3_CO_dbh)))*length(x_B3_CO)  # exponential distribution
y_B3_CO_POW = ((x_B3_CO_dbh)^(-0.785234))*length(x_B3_CO) # power function distribution
y_B3_CO_WEI = (exp(1/(4.270184^2.968223)-(x_B3_CO_dbh/4.270184)^2.968223))*length(x_B3_CO) # Weibull distribution
y_B3_CO_QWEI = (1-cumsum(qwei_B3_CO(x_B3_CO_dbh)*(max(x_B3_CO)-min(x_B3_CO))/1000))*length(x_B3_CO) # quasi_Weibull distribution

lines(x_B3_CO_dbh, y_B3_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B3_CO_dbh, y_B3_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B3_CO_dbh, y_B3_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B3_CO_dbh, y_B3_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B3_CO_dbh, y_B3_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B3_CO_dbh, y_B3_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RM
x_B3_RM = subset(alltree,plot=="B3" & sp=="RM")$dbh/min(subset(alltree,plot=="B3" & sp=="RM")$dbh)
length(x_B3_RM)
x_B3_RM_dbh = seq(min(x_B3_RM),max(x_B3_RM),length=1000)

plot(sort(x_B3_RM, decreasing=TRUE), 1:length(x_B3_RM), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B3_RM), max(x_B3_RM)), ylim = c(1, length(x_B3_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B3_RM = function(x){
  b_pop = 2.084844
  n_pop = 20
  L2_com = 0.01520995
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B3_RM = function(x){
  b_pop = 2
  n_pop = 20
  S_0 = 9
  N_0 = 61
  L2_com = S_0/(sum(x_B3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B3_RM = function(x){
  al_pop = 3.983270e-06
  be_pop = 1.875226e+00
  ga_pop = 1.488904e+00
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B3_RM = Vectorize(fx_B3_RM)
# qwei_B3_RM = Vectorize(qwei_B3_RM)
y_B3_RM_PMETE = (1-cumsum(fx_B3_RM(x_B3_RM_dbh)*(max(x_B3_RM)-min(x_B3_RM))/1000))*length(x_B3_RM) # parametrized mete prediction
y_B3_RM_METE = (1-cumsum(gx_B3_RM(x_B3_RM_dbh)*(max(x_B3_RM)-min(x_B3_RM))/1000))*length(x_B3_RM) # mete prediction
y_B3_RM_EXP = exp(-1.353383*(x_B3_RM_dbh-min(x_B3_RM_dbh)))*length(x_B3_RM)  # exponential distribution
y_B3_RM_POW = ((x_B3_RM_dbh)^(-2.106054))*length(x_B3_RM) # power function distribution
y_B3_RM_WEI = (exp(1/(0.4770594^0.8125715)-(x_B3_RM_dbh/0.4770594)^0.8125715))*length(x_B3_RM) # Weibull distribution
y_B3_RM_QWEI = (1-cumsum(qwei_B3_RM(x_B3_RM_dbh)*(max(x_B3_RM)-min(x_B3_RM))/1000))*length(x_B3_RM) # quasi_Weibull distribution

lines(x_B3_RM_dbh, y_B3_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B3_RM_dbh, y_B3_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B3_RM_dbh, y_B3_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B3_RM_dbh, y_B3_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B3_RM_dbh, y_B3_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B3_RM_dbh, y_B3_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_B3_RO = subset(alltree,plot=="B3" & sp=="RO")$dbh/min(subset(alltree,plot=="B3" & sp=="RO")$dbh)
length(x_B3_RO)
x_B3_RO_dbh = seq(min(x_B3_RO),max(x_B3_RO),length=1000)

plot(sort(x_B3_RO, decreasing=TRUE), 1:length(x_B3_RO), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_B3_RO), max(x_B3_RO)), ylim = c(1, length(x_B3_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B3_RO = function(x){
  b_pop = 0.4345414
  n_pop = 62
  L2_com = 0.01520995
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B3_RO = function(x){
  b_pop = 2
  n_pop = 62
  S_0 = 9
  N_0 = 61
  L2_com = S_0/(sum(x_B3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B3_RO = function(x){
  al_pop = 3.226195
  be_pop = 8.533810
  ga_pop = 1.441086
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B3_RO = Vectorize(fx_B3_RO)
# qwei_B3_RO = Vectorize(qwei_B3_RO)
y_B3_RO_PMETE = (1-cumsum(fx_B3_RO(x_B3_RO_dbh)*(max(x_B3_RO)-min(x_B3_RO))/1000))*length(x_B3_RO) # parametrized mete prediction
y_B3_RO_METE = (1-cumsum(gx_B3_RO(x_B3_RO_dbh)*(max(x_B3_RO)-min(x_B3_RO))/1000))*length(x_B3_RO) # mete prediction
y_B3_RO_EXP = exp(-0.1680385*(x_B3_RO_dbh-min(x_B3_RO_dbh)))*length(x_B3_RO)  # exponential distribution
y_B3_RO_POW = ((x_B3_RO_dbh)^(-0.5320521))*length(x_B3_RO) # power function distribution
y_B3_RO_WEI = (exp(1/(7.677649^3.714760)-(x_B3_RO_dbh/7.677649)^3.714760))*length(x_B3_RO) # Weibull distribution
y_B3_RO_QWEI = (1-cumsum(qwei_B3_RO(x_B3_RO_dbh)*(max(x_B3_RO)-min(x_B3_RO))/1000))*length(x_B3_RO) # quasi_Weibull distribution

lines(x_B3_RO_dbh, y_B3_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B3_RO_dbh, y_B3_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B3_RO_dbh, y_B3_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B3_RO_dbh, y_B3_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B3_RO_dbh, y_B3_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B3_RO_dbh, y_B3_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
### plot B4
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### BB
x_B4_BB = subset(alltree,plot=="B4" & sp=="BB")$dbh/min(subset(alltree,plot=="B4" & sp=="BB")$dbh)
length(x_B4_BB)
x_B4_BB_dbh = seq(min(x_B4_BB),max(x_B4_BB),length=1000)

plot(sort(x_B4_BB, decreasing=TRUE), 1:length(x_B4_BB), log="xy",
     xlab="d",
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_B4_BB), max(x_B4_BB)), ylim = c(1, length(x_B4_BB)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B4_BB = function(x){
  b_pop = 2.298386
  n_pop = 30
  L2_com = 0.002649025
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B4_BB = function(x){
  b_pop = 2
  n_pop = 30
  S_0 = 5
  N_0 = 104
  L2_com = S_0/(sum(x_B4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B4_BB = function(x){
  al_pop = 0.5198272
  be_pop = 4.1286715
  ga_pop = 1.8322846
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B4_BB = Vectorize(fx_B4_BB)
# qwei_B4_BB = Vectorize(qwei_B4_BB)
y_B4_BB_PMETE = (1-cumsum(fx_B4_BB(x_B4_BB_dbh)*(max(x_B4_BB)-min(x_B4_BB))/1000))*length(x_B4_BB) # parametrized mete prediction
y_B4_BB_METE = (1-cumsum(gx_B4_BB(x_B4_BB_dbh)*(max(x_B4_BB)-min(x_B4_BB))/1000))*length(x_B4_BB) # mete prediction
y_B4_BB_EXP = exp(-0.6512605*(x_B4_BB_dbh-min(x_B4_BB_dbh)))*length(x_B4_BB)  # exponential distribution
y_B4_BB_POW = ((x_B4_BB_dbh)^(-1.229324))*length(x_B4_BB) # power function distribution
y_B4_BB_WEI = (exp(1/(2.155874^1.402434)-(x_B4_BB_dbh/2.155874)^1.402434))*length(x_B4_BB) # Weibull distribution
y_B4_BB_QWEI = (1-cumsum(qwei_B4_BB(x_B4_BB_dbh)*(max(x_B4_BB)-min(x_B4_BB))/1000))*length(x_B4_BB) # quasi_Weibull distribution

lines(x_B4_BB_dbh, y_B4_BB_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B4_BB_dbh, y_B4_BB_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B4_BB_dbh, y_B4_BB_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B4_BB_dbh, y_B4_BB_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B4_BB_dbh, y_B4_BB_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B4_BB_dbh, y_B4_BB_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "BB", bty="n",cex=1.5)

#### CO
x_B4_CO = subset(alltree,plot=="B4" & sp=="CO")$dbh/min(subset(alltree,plot=="B4" & sp=="CO")$dbh)
length(x_B4_CO)
x_B4_CO_dbh = seq(min(x_B4_CO),max(x_B4_CO),length=1000)

plot(sort(x_B4_CO, decreasing=TRUE), 1:length(x_B4_CO), log="xy",
     xlab="d",
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B4_CO), max(x_B4_CO)), ylim = c(1, length(x_B4_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B4_CO = function(x){
  b_pop = 0.7355926
  n_pop = 128
  L2_com = 0.002649025
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B4_CO = function(x){
  b_pop = 2
  n_pop = 128
  S_0 = 5
  N_0 = 104
  L2_com = S_0/(sum(x_B4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B4_CO = function(x){
  al_pop = 0.3261981
  be_pop = 18.8006404
  ga_pop = 18.0527818
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B4_CO = Vectorize(fx_B4_CO)
# qwei_B4_CO = Vectorize(qwei_B4_CO)
y_B4_CO_PMETE = (1-cumsum(fx_B4_CO(x_B4_CO_dbh)*(max(x_B4_CO)-min(x_B4_CO))/1000))*length(x_B4_CO) # parametrized mete prediction
y_B4_CO_METE = (1-cumsum(gx_B4_CO(x_B4_CO_dbh)*(max(x_B4_CO)-min(x_B4_CO))/1000))*length(x_B4_CO) # mete prediction
y_B4_CO_EXP = exp(-0.1544899*(x_B4_CO_dbh-min(x_B4_CO_dbh)))*length(x_B4_CO)  # exponential distribution
y_B4_CO_POW = ((x_B4_CO_dbh)^(-0.5947809))*length(x_B4_CO) # power function distribution
y_B4_CO_WEI = (exp(1/(6.920126^1.098824)-(x_B4_CO_dbh/6.920126)^1.098824))*length(x_B4_CO) # Weibull distribution
y_B4_CO_QWEI = (1-cumsum(qwei_B4_CO(x_B4_CO_dbh)*(max(x_B4_CO)-min(x_B4_CO))/1000))*length(x_B4_CO) # quasi_Weibull distribution

lines(x_B4_CO_dbh, y_B4_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B4_CO_dbh, y_B4_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B4_CO_dbh, y_B4_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B4_CO_dbh, y_B4_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B4_CO_dbh, y_B4_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B4_CO_dbh, y_B4_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RM
x_B4_RM = subset(alltree,plot=="B4" & sp=="RM")$dbh/min(subset(alltree,plot=="B4" & sp=="RM")$dbh)
x_B4_RM_dbh = seq(min(x_B4_RM),max(x_B4_RM),length=1000)

plot(sort(x_B4_RM, decreasing=TRUE), 1:length(x_B4_RM), log="xy",
     xlab=expression(paste("d")),
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_B4_RM), max(x_B4_RM)), ylim = c(1, length(x_B4_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B4_RM = function(x){
  b_pop = 2.292361
  n_pop = 35
  L2_com = 0.002649025
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B4_RM = function(x){
  b_pop = 2
  n_pop = 35
  S_0 = 5
  N_0 = 104
  L2_com = S_0/(sum(x_B4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B4_RM = function(x){
  al_pop = 0.2460471
  be_pop = 5.0982699
  ga_pop = 18.5173649
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B4_RM = Vectorize(fx_B4_RM)
# qwei_B4_RM = Vectorize(qwei_B4_RM)
y_B4_RM_PMETE = (1-cumsum(fx_B4_RM(x_B4_RM_dbh)*(max(x_B4_RM)-min(x_B4_RM))/1000))*length(x_B4_RM) # parametrized mete prediction
y_B4_RM_METE = (1-cumsum(gx_B4_RM(x_B4_RM_dbh)*(max(x_B4_RM)-min(x_B4_RM))/1000))*length(x_B4_RM) # mete prediction
y_B4_RM_EXP = exp(-0.634058*(x_B4_RM_dbh-min(x_B4_RM_dbh)))*length(x_B4_RM)  # exponential distribution
y_B4_RM_POW = ((x_B4_RM_dbh)^(-1.171758))*length(x_B4_RM) # power function distribution
y_B4_RM_WEI = (exp(1/(2.575398^1.906675)-(x_B4_RM_dbh/2.575398)^1.906675))*length(x_B4_RM) # Weibull distribution
y_B4_RM_QWEI = (1-cumsum(qwei_B4_RM(x_B4_RM_dbh)*(max(x_B4_RM)-min(x_B4_RM))/1000))*length(x_B4_RM) # quasi_Weibull distribution

lines(x_B4_RM_dbh, y_B4_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B4_RM_dbh, y_B4_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B4_RM_dbh, y_B4_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B4_RM_dbh, y_B4_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B4_RM_dbh, y_B4_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B4_RM_dbh, y_B4_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_B4_RO = subset(alltree,plot=="B4" & sp=="RO")$dbh/min(subset(alltree,plot=="B4" & sp=="RO")$dbh)
x_B4_RO_dbh = seq(min(x_B4_RO),max(x_B4_RO),length=1000)

plot(sort(x_B4_RO, decreasing=TRUE), 1:length(x_B4_RO), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_B4_RO), max(x_B4_RO)), ylim = c(1, length(x_B4_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_B4_RO = function(x){
  b_pop = 0.8821887
  n_pop = 126
  L2_com = 0.002649025
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_B4_RO = function(x){
  b_pop = 2
  n_pop = 126
  S_0 = 5
  N_0 = 104
  L2_com = S_0/(sum(x_B4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_B4_RO = function(x){
  al_pop = 1.7023624
  be_pop = 0.3850321
  ga_pop = -1.1626176
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_B4_RO = Vectorize(fx_B4_RO)
# qwei_B4_RO = Vectorize(qwei_B4_RO)
y_B4_RO_PMETE = (1-cumsum(fx_B4_RO(x_B4_RO_dbh)*(max(x_B4_RO)-min(x_B4_RO))/1000))*length(x_B4_RO) # parametrized mete prediction
y_B4_RO_METE = (1-cumsum(gx_B4_RO(x_B4_RO_dbh)*(max(x_B4_RO)-min(x_B4_RO))/1000))*length(x_B4_RO) # mete prediction
y_B4_RO_EXP = exp(-0.253012*(x_B4_RO_dbh-min(x_B4_RO_dbh)))*length(x_B4_RO)  # exponential distribution
y_B4_RO_POW = ((x_B4_RO_dbh)^(-0.7677182))*length(x_B4_RO) # power function distribution
y_B4_RO_WEI = (exp(1/(3.2683686^0.8478008)-(x_B4_RO_dbh/3.2683686)^0.8478008))*length(x_B4_RO) # Weibull distribution
y_B4_RO_QWEI = (1-cumsum(qwei_B4_RO(x_B4_RO_dbh)*(max(x_B4_RO)-min(x_B4_RO))/1000))*length(x_B4_RO) # quasi_Weibull distribution

lines(x_B4_RO_dbh, y_B4_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_B4_RO_dbh, y_B4_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_B4_RO_dbh, y_B4_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_B4_RO_dbh, y_B4_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_B4_RO_dbh, y_B4_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_B4_RO_dbh, y_B4_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
### plot C1
```{r}
par(mfrow=c(1,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### RO
x_C1_RO = subset(alltree,plot=="C1" & sp=="RO")$dbh/min(subset(alltree,plot=="C1" & sp=="RO")$dbh)
x_C1_RO_dbh = seq(min(x_C1_RO),max(x_C1_RO),length=1000)

plot(sort(x_C1_RO, decreasing=TRUE), 1:length(x_C1_RO), log="xy",
     xlab=expression(paste("d")),
     ylab=expression(paste("number of trees" >=d)), mgp=mgpVals,
     xlim = c(min(x_C1_RO), max(x_C1_RO)), ylim = c(1, length(x_C1_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C1_RO = function(x){
  b_pop = 2.281788
  n_pop = 67
  L2_com = 0.004071871
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C1_RO = function(x){
  b_pop = 2
  n_pop = 67
  S_0 = 7
  N_0 = 32
  L2_com = S_0/(sum(x_C1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C1_RO = function(x){
  al_pop = 33.151322817
  be_pop = 0.004630394
  ga_pop = -32.502427661
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C1_RO = Vectorize(fx_C1_RO)
# qwei_C1_RO = Vectorize(qwei_C1_RO)
y_C1_RO_PMETE = (1-cumsum(fx_C1_RO(x_C1_RO_dbh)*(max(x_C1_RO)-min(x_C1_RO))/1000))*length(x_C1_RO) # parametrized mete prediction
y_C1_RO_METE = (1-cumsum(gx_C1_RO(x_C1_RO_dbh)*(max(x_C1_RO)-min(x_C1_RO))/1000))*length(x_C1_RO) # mete prediction
y_C1_RO_EXP = exp(-0.9943705*(x_C1_RO_dbh-min(x_C1_RO_dbh)))*length(x_C1_RO)  # exponential distribution
y_C1_RO_POW = ((x_C1_RO_dbh)^(-1.485653))*length(x_C1_RO) # power function distribution
y_C1_RO_WEI = (exp(1/(2.141671^4.188993)-(x_C1_RO_dbh/2.141671)^4.188993))*length(x_C1_RO) # Weibull distribution
y_C1_RO_QWEI = (1-cumsum(qwei_C1_RO(x_C1_RO_dbh)*(max(x_C1_RO)-min(x_C1_RO))/1000))*length(x_C1_RO) # quasi_Weibull distribution

lines(x_C1_RO_dbh, y_C1_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C1_RO_dbh, y_C1_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C1_RO_dbh, y_C1_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C1_RO_dbh, y_C1_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C1_RO_dbh, y_C1_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C1_RO_dbh, y_C1_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)

#### SM
x_C1_SM = subset(alltree,plot=="C1" & sp=="SM")$dbh/min(subset(alltree,plot=="C1" & sp=="SM")$dbh)
x_C1_SM_dbh = seq(min(x_C1_SM),max(x_C1_SM),length=1000)

plot(sort(x_C1_SM, decreasing=TRUE), 1:length(x_C1_SM), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_C1_SM), max(x_C1_SM)), ylim = c(1, length(x_C1_SM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C1_SM = function(x){
  b_pop = 1.603808
  n_pop = 15
  L2_com = 0.004071871
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C1_SM = function(x){
  b_pop = 2
  n_pop = 15
  S_0 = 7
  N_0 = 32
  L2_com = S_0/(sum(x_C1_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C1_SM = function(x){
  al_pop = 0.6859056
  be_pop = 9.8327245
  ga_pop = 1.7178190
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C1_SM = Vectorize(fx_C1_SM)
# qwei_C1_SM = Vectorize(qwei_C1_SM)
y_C1_SM_PMETE = (1-cumsum(fx_C1_SM(x_C1_SM_dbh)*(max(x_C1_SM)-min(x_C1_SM))/1000))*length(x_C1_SM) # parametrized mete prediction
y_C1_SM_METE = (1-cumsum(gx_C1_SM(x_C1_SM_dbh)*(max(x_C1_SM)-min(x_C1_SM))/1000))*length(x_C1_SM) # mete prediction
y_C1_SM_EXP = exp(-0.241791*(x_C1_SM_dbh-min(x_C1_SM_dbh)))*length(x_C1_SM)  # exponential distribution
y_C1_SM_POW = ((x_C1_SM_dbh)^(-0.7068837))*length(x_C1_SM) # power function distribution
y_C1_SM_WEI = (exp(1/(5.020038^1.322610)-(x_C1_SM_dbh/5.020038)^1.322610))*length(x_C1_SM) # Weibull distribution
y_C1_SM_QWEI = (1-cumsum(qwei_C1_SM(x_C1_SM_dbh)*(max(x_C1_SM)-min(x_C1_SM))/1000))*length(x_C1_SM) # quasi_Weibull distribution

lines(x_C1_SM_dbh, y_C1_SM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C1_SM_dbh, y_C1_SM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C1_SM_dbh, y_C1_SM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C1_SM_dbh, y_C1_SM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C1_SM_dbh, y_C1_SM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C1_SM_dbh, y_C1_SM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "SM", bty="n",cex=1.5)
```
### plot C2
```{r}
par(mfrow=c(1,1),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### RO
x_C2_RO = subset(alltree,plot=="C2" & sp=="RO")$dbh/min(subset(alltree,plot=="C2" & sp=="RO")$dbh)
x_C2_RO_dbh = seq(min(x_C2_RO),max(x_C2_RO),length=1000)

plot(sort(x_C2_RO, decreasing=TRUE), 1:length(x_C2_RO), log="xy",
     xlab=expression(paste("d")),
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_C2_RO), max(x_C2_RO)), ylim = c(1, length(x_C2_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C2_RO = function(x){
  b_pop = 0.832519
  n_pop = 65
  L2_com = 0.02725915
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C2_RO = function(x){
  b_pop = 2
  n_pop = 65
  S_0 = 4
  N_0 = 19
  L2_com = S_0/(sum(x_C2_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C2_RO = function(x){
  al_pop = 30.15003770
  be_pop = 0.04984344
  ga_pop = -29.19155248
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C2_RO = Vectorize(fx_C2_RO)
# qwei_C2_RO = Vectorize(qwei_C2_RO)
y_C2_RO_PMETE = (1-cumsum(fx_C2_RO(x_C2_RO_dbh)*(max(x_C2_RO)-min(x_C2_RO))/1000))*length(x_C2_RO) # parametrized mete prediction
y_C2_RO_METE = (1-cumsum(gx_C2_RO(x_C2_RO_dbh)*(max(x_C2_RO)-min(x_C2_RO))/1000))*length(x_C2_RO) # mete prediction
y_C2_RO_EXP = exp(-1.213712*(x_C2_RO_dbh-min(x_C2_RO_dbh)))*length(x_C2_RO)  # exponential distribution
y_C2_RO_POW = ((x_C2_RO_dbh)^(-1.712557))*length(x_C2_RO) # power function distribution
y_C2_RO_WEI = (exp(1/(1.940132^5.021362)-(x_C2_RO_dbh/1.940132)^5.021362))*length(x_C2_RO) # Weibull distribution
y_C2_RO_QWEI = (1-cumsum(qwei_C2_RO(x_C2_RO_dbh)*(max(x_C2_RO)-min(x_C2_RO))/1000))*length(x_C2_RO) # quasi_Weibull distribution

lines(x_C2_RO_dbh, y_C2_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C2_RO_dbh, y_C2_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C2_RO_dbh, y_C2_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C2_RO_dbh, y_C2_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C2_RO_dbh, y_C2_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C2_RO_dbh, y_C2_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
### plot C3
```{r}
par(mfrow=c(1,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### CO
x_C3_CO = subset(alltree,plot=="C3" & sp=="CO")$dbh/min(subset(alltree,plot=="C3" & sp=="CO")$dbh)
x_C3_CO_dbh = seq(min(x_C3_CO),max(x_C3_CO),length=1000)

plot(sort(x_C3_CO, decreasing=TRUE), 1:length(x_C3_CO), log="xy",
     xlab=expression(paste("d")),
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_C3_CO), max(x_C3_CO)), ylim = c(1, length(x_C3_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C3_CO = function(x){
  b_pop = 5.132689
  n_pop = 10
  L2_com = 0.01019098
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C3_CO = function(x){
  b_pop = 2
  n_pop = 10
  S_0 = 7
  N_0 = 32
  L2_com = S_0/(sum(x_C3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C3_CO = function(x){
  al_pop = 4.286713e-09
  be_pop = 2.041969e+00
  ga_pop = 3.067767e+02
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C3_CO = Vectorize(fx_C3_CO)
# qwei_C3_CO = Vectorize(qwei_C3_CO)
y_C3_CO_PMETE = (1-cumsum(fx_C3_CO(x_C3_CO_dbh)*(max(x_C3_CO)-min(x_C3_CO))/1000))*length(x_C3_CO) # parametrized mete prediction
y_C3_CO_METE = (1-cumsum(gx_C3_CO(x_C3_CO_dbh)*(max(x_C3_CO)-min(x_C3_CO))/1000))*length(x_C3_CO) # mete prediction
y_C3_CO_EXP = exp(-2.230696*(x_C3_CO_dbh-min(x_C3_CO_dbh)))*length(x_C3_CO)  # exponential distribution
y_C3_CO_POW = ((x_C3_CO_dbh)^(-2.873629))*length(x_C3_CO) # power function distribution
y_C3_CO_WEI = (exp(1/(1.428554^3.635858)-(x_C3_CO_dbh/1.428554)^3.635858))*length(x_C3_CO) # Weibull distribution
y_C3_CO_QWEI = (1-cumsum(qwei_C3_CO(x_C3_CO_dbh)*(max(x_C3_CO)-min(x_C3_CO))/1000))*length(x_C3_CO) # quasi_Weibull distribution

lines(x_C3_CO_dbh, y_C3_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C3_CO_dbh, y_C3_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C3_CO_dbh, y_C3_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C3_CO_dbh, y_C3_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C3_CO_dbh, y_C3_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C3_CO_dbh, y_C3_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RO
x_C3_RO = subset(alltree,plot=="C3" & sp=="RO")$dbh/min(subset(alltree,plot=="C3" & sp=="RO")$dbh)
x_C3_RO_dbh = seq(min(x_C3_RO),max(x_C3_RO),length=1000)

plot(sort(x_C3_RO, decreasing=TRUE), 1:length(x_C3_RO), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_C3_RO), max(x_C3_RO)), ylim = c(1, length(x_C3_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C3_RO = function(x){
  b_pop = 1.259776
  n_pop = 81
  L2_com = 0.01019098
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C3_RO = function(x){
  b_pop = 2
  n_pop = 81
  S_0 = 7
  N_0 = 32
  L2_com = S_0/(sum(x_C3_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C3_RO = function(x){
  al_pop = 17.44667521
  be_pop = 0.04683002
  ga_pop = -16.62707928
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C3_RO = Vectorize(fx_C3_RO)
# qwei_C3_RO = Vectorize(qwei_C3_RO)
y_C3_RO_PMETE = (1-cumsum(fx_C3_RO(x_C3_RO_dbh)*(max(x_C3_RO)-min(x_C3_RO))/1000))*length(x_C3_RO) # parametrized mete prediction
y_C3_RO_METE = (1-cumsum(gx_C3_RO(x_C3_RO_dbh)*(max(x_C3_RO)-min(x_C3_RO))/1000))*length(x_C3_RO) # mete prediction
y_C3_RO_EXP = exp(-1.020274*(x_C3_RO_dbh-min(x_C3_RO_dbh)))*length(x_C3_RO)  # exponential distribution
y_C3_RO_POW = ((x_C3_RO_dbh)^(-1.536835))*length(x_C3_RO) # power function distribution
y_C3_RO_WEI = (exp(1/(2.099587^3.486228)-(x_C3_RO_dbh/2.099587)^3.486228))*length(x_C3_RO) # Weibull distribution
y_C3_RO_QWEI = (1-cumsum(qwei_C3_RO(x_C3_RO_dbh)*(max(x_C3_RO)-min(x_C3_RO))/1000))*length(x_C3_RO) # quasi_Weibull distribution

lines(x_C3_RO_dbh, y_C3_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C3_RO_dbh, y_C3_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C3_RO_dbh, y_C3_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C3_RO_dbh, y_C3_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C3_RO_dbh, y_C3_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C3_RO_dbh, y_C3_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
### plot C4
```{r}
par(mfrow=c(2,2),mar=c(3,3,1,1))
inset = c(0, -0.04);mgpVals = c(1.6,0.5,0)

#### CO
x_C4_CO = subset(alltree,plot=="C4" & sp=="CO")$dbh/min(subset(alltree,plot=="C4" & sp=="CO")$dbh)
x_C4_CO_dbh = seq(min(x_C4_CO),max(x_C4_CO),length=1000)

plot(sort(x_C4_CO, decreasing=TRUE), 1:length(x_C4_CO), log="xy",
     xlab=expression(paste("d")),
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_C4_CO), max(x_C4_CO)), ylim = c(1, length(x_C4_CO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C4_CO = function(x){
  b_pop = 0.337291
  n_pop = 85
  L2_com = 0.01568359
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C4_CO = function(x){
  b_pop = 2
  n_pop = 85
  S_0 = 8
  N_0 = 73
  L2_com = S_0/(sum(x_C4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C4_CO = function(x){
  al_pop = 0.7404566
  be_pop = 14.5480615
  ga_pop = 9.7485720
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C4_CO = Vectorize(fx_C4_CO)
# qwei_C4_CO = Vectorize(qwei_C4_CO)
y_C4_CO_PMETE = (1-cumsum(fx_C4_CO(x_C4_CO_dbh)*(max(x_C4_CO)-min(x_C4_CO))/1000))*length(x_C4_CO) # parametrized mete prediction
y_C4_CO_METE = (1-cumsum(gx_C4_CO(x_C4_CO_dbh)*(max(x_C4_CO)-min(x_C4_CO))/1000))*length(x_C4_CO) # mete prediction
y_C4_CO_EXP = exp(-0.1628811*(x_C4_CO_dbh-min(x_C4_CO_dbh)))*length(x_C4_CO)  # exponential distribution
y_C4_CO_POW = ((x_C4_CO_dbh)^(-0.5809793))*length(x_C4_CO) # power function distribution
y_C4_CO_WEI = (exp(1/(7.583264^1.540256)-(x_C4_CO_dbh/7.583264)^1.540256))*length(x_C4_CO) # Weibull distribution
y_C4_CO_QWEI = (1-cumsum(qwei_C4_CO(x_C4_CO_dbh)*(max(x_C4_CO)-min(x_C4_CO))/1000))*length(x_C4_CO) # quasi_Weibull distribution

lines(x_C4_CO_dbh, y_C4_CO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C4_CO_dbh, y_C4_CO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C4_CO_dbh, y_C4_CO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C4_CO_dbh, y_C4_CO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C4_CO_dbh, y_C4_CO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C4_CO_dbh, y_C4_CO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "CO", bty="n",cex=1.5)

#### RM
x_C4_RM = subset(alltree,plot=="C4" & sp=="RM")$dbh/min(subset(alltree,plot=="C4" & sp=="RM")$dbh)
x_C4_RM_dbh = seq(min(x_C4_RM),max(x_C4_RM),length=1000)

plot(sort(x_C4_RM, decreasing=TRUE), 1:length(x_C4_RM), log="xy",
     xlab=expression(paste("d")),
     ylab="", mgp=mgpVals,
     xlim = c(min(x_C4_RM), max(x_C4_RM)), ylim = c(1, length(x_C4_RM)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C4_RM = function(x){
  b_pop = 1.352426
  n_pop = 41
  L2_com = 0.01568359
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C4_RM = function(x){
  b_pop = 2
  n_pop = 41
  S_0 = 8
  N_0 = 73
  L2_com = S_0/(sum(x_C4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C4_RM = function(x){
  al_pop = 1.664553e+01
  be_pop = 9.063284e-07
  ga_pop = -1.636256e+01
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C4_RM = Vectorize(fx_C4_RM)
# qwei_C4_RM = Vectorize(qwei_C4_RM)
y_C4_RM_PMETE = (1-cumsum(fx_C4_RM(x_C4_RM_dbh)*(max(x_C4_RM)-min(x_C4_RM))/1000))*length(x_C4_RM) # parametrized mete prediction
y_C4_RM_METE = (1-cumsum(gx_C4_RM(x_C4_RM_dbh)*(max(x_C4_RM)-min(x_C4_RM))/1000))*length(x_C4_RM) # mete prediction
y_C4_RM_EXP = exp(-1.058884*(x_C4_RM_dbh-min(x_C4_RM_dbh)))*length(x_C4_RM)  # exponential distribution
y_C4_RM_POW = ((x_C4_RM_dbh)^(-1.683917))*length(x_C4_RM) # power function distribution
y_C4_RM_WEI = (exp(1/(1.396749^1.361598)-(x_C4_RM_dbh/1.396749)^1.361598))*length(x_C4_RM) # Weibull distribution
y_C4_RM_QWEI = (1-cumsum(qwei_C4_RM(x_C4_RM_dbh)*(max(x_C4_RM)-min(x_C4_RM))/1000))*length(x_C4_RM) # quasi_Weibull distribution

lines(x_C4_RM_dbh, y_C4_RM_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C4_RM_dbh, y_C4_RM_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C4_RM_dbh, y_C4_RM_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C4_RM_dbh, y_C4_RM_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C4_RM_dbh, y_C4_RM_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C4_RM_dbh, y_C4_RM_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RM", bty="n",cex=1.5)

#### RO
x_C4_RO = subset(alltree,plot=="C4" & sp=="RO")$dbh/min(subset(alltree,plot=="C4" & sp=="RO")$dbh)
x_C4_RO_dbh = seq(min(x_C4_RO),max(x_C4_RO),length=1000)

plot(sort(x_C4_RO, decreasing=TRUE), 1:length(x_C4_RO), log="xy",
     xlab=expression(paste("d")),
     ylab=expression(paste("number of trees" >= d)), mgp=mgpVals,
     xlim = c(min(x_C4_RO), max(x_C4_RO)), ylim = c(1, length(x_C4_RO)),cex=2,cex.axis=1.5,cex.lab=1.5)

fx_C4_RO = function(x){
  b_pop = 0.3267023
  n_pop = 104
  L2_com = 0.01568359
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

gx_C4_RO = function(x){
  b_pop = 2
  n_pop = 104
  S_0 = 8
  N_0 = 73
  L2_com = S_0/(sum(x_C4_s^2)-N_0)
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

qwei_C4_RO = function(x){
  al_pop = 0.75459839
  be_pop = 4.15906590
  ga_pop = 0.06480582
  pdf_qwei_pop = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_pop)
}

# fx_C4_RO = Vectorize(fx_C4_RO)
# qwei_C4_RO = Vectorize(qwei_C4_RO)
y_C4_RO_PMETE = (1-cumsum(fx_C4_RO(x_C4_RO_dbh)*(max(x_C4_RO)-min(x_C4_RO))/1000))*length(x_C4_RO) # parametrized mete prediction
y_C4_RO_METE = (1-cumsum(gx_C4_RO(x_C4_RO_dbh)*(max(x_C4_RO)-min(x_C4_RO))/1000))*length(x_C4_RO) # mete prediction
y_C4_RO_EXP = exp(-0.2028499*(x_C4_RO_dbh-min(x_C4_RO_dbh)))*length(x_C4_RO)  # exponential distribution
y_C4_RO_POW = ((x_C4_RO_dbh)^(-0.7026847))*length(x_C4_RO) # power function distribution
y_C4_RO_WEI = (exp(1/(3.8906190^0.8078659)-(x_C4_RO_dbh/3.8906190)^0.8078659))*length(x_C4_RO) # Weibull distribution
y_C4_RO_QWEI = (1-cumsum(qwei_C4_RO(x_C4_RO_dbh)*(max(x_C4_RO)-min(x_C4_RO))/1000))*length(x_C4_RO) # quasi_Weibull distribution

lines(x_C4_RO_dbh, y_C4_RO_PMETE, col="#000000",lwd=2) #, lty=5)
lines(x_C4_RO_dbh, y_C4_RO_METE, col="#999999",lwd=2) #, lty=5)
lines(x_C4_RO_dbh, y_C4_RO_EXP, col="#D55E00",lwd=2) #, lty=5)
lines(x_C4_RO_dbh, y_C4_RO_POW, col="#009E73",lwd=2) #, lty=5)
lines(x_C4_RO_dbh, y_C4_RO_WEI, col="#CC79A7",lwd=2) #, lty=5)
lines(x_C4_RO_dbh, y_C4_RO_QWEI, col="#0072B2",lwd=2) #, lty=5)
legend("bottomleft", "RO", bty="n",cex=1.5)
```
# Kolmogorov-Smirnov test
## Community-level ISD (parametrized METE, METE, exponential, power, Weibull, quasi-Weibull)
```{r}
# BCI
bci_quad_com_combo = full_join(bci_quad_com_all,bci_2015_live,by="Quadrat")

# parametrized METE samples
ks_pmete_p = NULL

ks_pmete_com = function(d){
   fx_bci = function(x){
  b_com = mean(d$b_q)
  L1_com = mean(d$L1_q)
  L2_com = mean(d$L2_q)
  N_0 = mean(d$N_q)
  be_com = L1_com+L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2) # parametrized mete community-level isd
  return(pdf_com) 
}
  for (i in 1:100){
  sample_plot = samplepdf(length(d$DBH),fx_bci,spdf.lower=1)
  ks_pmete_p = c(ks_pmete_p,ks.test(d$DBH/min(d$DBH),sample_plot)$p)
}
ks_pmete_p_prop = sum(ks_pmete_p<0.05)/100
ks_pmete_ci=binconf(sum(ks_pmete_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_pmete_p_prop,p_value_lo=ks_pmete_ci[2],p_value_up=ks_pmete_ci[3])
return(my_list)
}

qmete_ks_ci_quad_com = bci_quad_com_combo %>% group_by(Quadrat) %>%
   do(p_ks=ks_pmete_com(.)$p_value,p_ks_lo=ks_pmete_com(.)$p_value_lo,p_ks_up=ks_pmete_com(.)$p_value_up) %>% unnest()

# METE samples
ks_mete_p = NULL

# qwei_bci = function(x){
#   al_com = 0.004398291
#   be_com = 3.544376870
#   ga_com = 0.602548292
#   pdf_qwei_com = ((al_com+ga_com)/(be_com^al_com))*(1/Igamma(al_com/(al_com+ga_com),(1/be_com)^(al_com+ga_com),lower=F))*x^(al_com-1)*exp(-(x/be_com)^(al_com+ga_com))
#   return(pdf_qwei_com)
# }

ks_mete_com = function(d){
   gx_bci = function(x){
  S_0 = mean(d$S_q)
  N_0 = mean(d$N_q)
  b_com = 2
  be_com = mean(d$beta_q)
  L2_com = S_0/(sum(x_bci^b_com)-N_0)
  L1_com = be_com-L2_com
  ga_com = L1_com+L2_com*(x^b_com)
  pdf_com = L2_com*(1-exp(-be_com))/(exp(-be_com)-exp(-be_com*(N_0+1)))*b_com*(x^(b_com-1))*exp(-ga_com)*(1-(N_0+1)*exp(-ga_com*N_0)+N_0*exp(-ga_com*(N_0+1)))/((1-exp(-ga_com))^2)
  return(pdf_com)
}
  for (i in 1:100){
  sample_plot = samplepdf(length(d$DBH),gx_bci,spdf.lower=1)
  ks_mete_p = c(ks_mete_p,ks.test(d$DBH/min(d$DBH),sample_plot)$p)
}
ks_mete_p_prop = sum(ks_mete_p<0.05)/100
ks_mete_ci=binconf(sum(ks_mete_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_mete_p_prop,p_value_lo=ks_mete_ci[2],p_value_up=ks_mete_ci[3])
return(my_list)
}

mete_ks_ci_quad_com = bci_quad_com_combo %>% group_by(Quadrat) %>% 
   do(p_ks=ks_mete_com(.)$p_value,p_ks_lo=ks_mete_com(.)$p_value_lo,p_ks_up=ks_mete_com(.)$p_value_up) %>% unnest()

# left-truncated exponential samples
ks_exp_p = NULL
ks_exp_com = function(d){
for (i in 1:100){
  u = runif(length(d$DBH))
  sample_plot_exp = -log(1-u)/(mean(d$p_exp))+1 # quantile function (parameter = mle from original community)
  ks_exp_p = c(ks_exp_p,ks.test(d$DBH/min(d$DBH),sample_plot_exp)$p)
}
ks_exp_p_prop = sum(ks_exp_p<0.05)/100
ks_exp_ci=binconf(sum(ks_exp_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_exp_p_prop,p_value_lo=ks_exp_ci[2],p_value_up=ks_exp_ci[3])
return(my_list)
}

exp_ks_ci_quad_com = bci_quad_com_combo %>% group_by(Quadrat) %>% 
   do(p_ks=ks_exp_com(.)$p_value,p_ks_lo=ks_exp_com(.)$p_value_lo,p_ks_up=ks_exp_com(.)$p_value_up) %>% unnest()

# left-truncated power-law samples
ks_pow_p = NULL
ks_pow_com = function(d){
for (i in 1:100){
  u = runif(length(d$DBH))
  sample_plot_pow = (1-u)^(-1/mean(d$p_pow)) # quantile function (parameter = mle from original community)
  ks_pow_p = c(ks_pow_p,ks.test(d$DBH/min(d$DBH),sample_plot_pow)$p)
}
ks_pow_p_prop = sum(ks_pow_p<0.05)/100
ks_pow_ci=binconf(sum(ks_pow_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_pow_p_prop,p_value_lo=ks_pow_ci[2],p_value_up=ks_pow_ci[3])
return(my_list)
}

pow_ks_ci_quad_com = bci_quad_com_combo %>% group_by(Quadrat) %>% 
   do(p_ks=ks_pow_com(.)$p_value,p_ks_lo=ks_pow_com(.)$p_value_lo,p_ks_up=ks_pow_com(.)$p_value_up) %>% unnest()

# left-truncated Weibull samples
ks_wei_p = NULL
ks_wei_com = function(d){
for (i in 1:100){
  u = runif(length(d$DBH))
  sample_plot_wei = (1-(mean(d$p1_wei)^mean(d$p2_wei))*log(u))^(1/mean(d$p2_wei)) # quantile function (parameter = mle from original community)
  ks_wei_p = c(ks_wei_p,ks.test(d$DBH/min(d$DBH),sample_plot_wei)$p)
}
ks_wei_p_prop = sum(ks_wei_p<0.05)/100
ks_wei_ci=binconf(sum(ks_wei_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_wei_p_prop,p_value_lo=ks_wei_ci[2],p_value_up=ks_wei_ci[3])
return(my_list)
}

wei_ks_ci_quad_com = bci_quad_com_combo %>% group_by(Quadrat) %>% 
   do(p_ks=ks_wei_com(.)$p_value,p_ks_lo=ks_wei_com(.)$p_value_lo,p_ks_up=ks_wei_com(.)$p_value_up) %>% unnest()

# left-truncated quasi-Weibull samples
ks_qwei_p = NULL
ks_qwei_com = function(d){
  qwei_bci = function(x){
  al_pop = mean(d$p1_qwei)
  be_pop = mean(d$p2_qwei)
  ga_pop = mean(d$p3_qwei)
  pdf_qwei_bci = ((al_pop+ga_pop)/(be_pop^al_pop))*(1/Igamma(al_pop/(al_pop+ga_pop),(1/be_pop)^(al_pop+ga_pop),lower=F))*x^(al_pop-1)*exp(-(x/be_pop)^(al_pop+ga_pop))
  return(pdf_qwei_bci)
}
for (i in 1:100){
  u = runif(length(d$DBH))
  sample_plot_qwei = samplepdf(length(d$DBH),qwei_bci,spdf.lower=1) # quantile function (parameter = mle from original community)
  ks_qwei_p = c(ks_qwei_p,ks.test(d$DBH/min(d$DBH),sample_plot_qwei)$p)
}
ks_qwei_p_prop = sum(ks_qwei_p<0.05)/100
ks_qwei_ci=binconf(sum(ks_qwei_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_qwei_p_prop,p_value_lo=ks_qwei_ci[2],p_value_up=ks_qwei_ci[3])
return(my_list)
}

qwei_ks_ci_quad_com = bci_quad_com_combo %>% group_by(Quadrat) %>% 
   do(p_ks=ks_qwei_com(.)$p_value,p_ks_lo=ks_qwei_com(.)$p_value_lo,p_ks_up=ks_qwei_com(.)$p_value_up) %>% unnest()

# BRF
# parametrized METE samples
ks_pmete_p = NULL
for (i in 1:1000){
  sample_plot = samplepdf(length(x_A1_s),fx_A1,spdf.lower=1)
  ks_pmete_p = c(ks_pmete_p,ks.test(x_A1_s,sample_plot)$p)
}
(ks_pmete_p_prop = sum(ks_pmete_p<0.05)/1000)
binconf(sum(ks_pmete_p<0.05),1000,method="all")
# (ks_pmete_p_prop = sum(ks_pmete_p<0.05)/1000)
# write.xlsx2(ks_pmete_p,file="CommunityIndSampleKStest_p_pmete.xlsx",sheetName = "A1",append = F)

# METE samples
ks_mete_p = NULL
for (i in 1:1000){
  sample_plot = samplepdf(length(x_A1_s),gx_A1,spdf.lower=1)
  ks_mete_p = c(ks_mete_p,ks.test(x_A1_s,sample_plot)$p)
}
(ks_mete_p_prop = sum(ks_mete_p<0.05)/1000)
binconf(sum(ks_mete_p<0.05),1000,method="all")
# write.xlsx2(ks_pmete_p,file="CommunityIndSampleKStest_p_pmete.xlsx",sheetName = "A1",append = F)

# left-truncated exponential samples
ks_exp_p = NULL
for (i in 1:1000){
  u = runif(length(x_C4_s))
  sample_plot_exp = -log(1-u)/0.2891313+1 # quantile function (parameter = mle from original community)
  ks_exp_p = c(ks_exp_p,ks.test(x_C4_s,sample_plot_exp)$p)
}
(ks_exp_p_prop = sum(ks_exp_p<0.05)/1000)
binconf(sum(ks_exp_p<0.05),1000,method="all")
# write.xlsx2(ks_exp_p,file="CommunityIndSampleKStest_p_exp.xlsx",sheetName = "C4",append = T)

# left-truncated power function samples
ks_pow_p = NULL
for (i in 1:1000){
  u = runif(length(x_C4_s))
  sample_plot_pow = (1-u)^(-1/0.9141697) # quantile function (parameter = mle from original community)
  ks_pow_p = c(ks_pow_p,ks.test(x_C4_s,sample_plot_pow)$p)
}
(ks_pow_p_prop = sum(ks_pow_p<0.05)/1000)
binconf(sum(ks_pow_p<0.05),1000,method="all")
# write.xlsx2(ks_pow_p,file="CommunityIndSampleKStest_p_pow.xlsx",sheetName = "C4",append = T)

# left-truncated Weibull samples
ks_wei_p = NULL
for (i in 1:1000){
  u = runif(length(x_C4_s))
  sample_plot_wei = (1-(0.4061179^0.4177299)*log(u))^(1/0.4177299) # quantile function (parameter = mle from original community)
  ks_wei_p = c(ks_wei_p,ks.test(x_C4_s,sample_plot_wei)$p)
}
(ks_wei_p_prop = sum(ks_wei_p<0.05)/1000)
binconf(sum(ks_wei_p<0.05),1000,method="all")
# write.xlsx2(ks_wei_p,file="CommunityIndSampleKStest_p_wei.xlsx",sheetName = "C4",append = T)

# left-truncated quasi-Weibull samples
ks_qwei_p = NULL
for (i in 1:1000){
  sample_plot_qwei = samplepdf(length(x_C3_s),qwei_C3,spdf.lower=1)
  ks_qwei_p = c(ks_qwei_p,ks.test(x_C3_s,sample_plot_qwei)$p)
}
(ks_qwei_p_prop = sum(ks_qwei_p<0.05)/1000)
binconf(sum(ks_qwei_p<0.05),1000,method="all")
# write.xlsx2(ks_qwei_p,file="CommunityIndSampleKStest_p_qwei.xlsx",sheetName = "C4",append = T)
```
## Population-level ISD (parametrized METE)
```{r}
bci_sp_pop_combo = inner_join(result_bci_sp_all,bci_2015_live,by="Latin")
# parametrized METE samples
ks_pmete_pop_p = NULL

ks_pmete_pop = function(d){
  fx_bci_sp = function(x){
  b_pop = mean(d$b_pmete)
  n_pop = mean(d$n_sp)
  L2_com = 4.097359e-05
  pdf_pop = b_pop*(x^(b_pop-1))*L2_com*n_pop*exp(-L2_com*n_pop*(x^b_pop-1))
  return(pdf_pop)
}

for (i in 1:100){
  sample_plot_sp = samplepdf(length(d$DBH),fx_bci_sp,spdf.lower=1)
  ks_pmete_pop_p = c(ks_pmete_pop_p,ks.test(d$DBH/min(d$DBH),sample_plot_sp)$p)
}
ks_pmete_pop_p_prop = sum(ks_pmete_pop_p<0.05)/100
ks_pmete_pop_ci = binconf(sum(ks_pmete_pop_p<0.05),100,method="asymptotic")
my_list = list(p_value=ks_pmete_pop_p_prop,p_value_lo=ks_pmete_pop_ci[2],p_value_up=ks_pmete_pop_ci[3])
return(my_list)
}

qmete_ks_ci_sp_pop = bci_sp_pop_combo %>% group_by(Latin) %>%
  do(p_ks=ks_pmete_pop(.)$p_value,p_ks_lo=ks_pmete_pop(.)$p_value_lo,p_ks_up=ks_pmete_pop(.)$p_value_up) %>% unnest()
# write.xlsx2(ks_mete_pop_p,file="PopulationIndSampleKStest_p_mete.xlsx",sheetName = "C4_RO",append = T)
```
# R code references
```{r}
# Condit, R., R. Prez, S. Aguilar, S. Lao, R. Foster, and S. Hubbell. 2019a. Complete data from the Barro Colorado 50-ha plot: 423617 trees, 35 years, v3, DataONE, Dataset. doi: https://doi.org/10.15146/5xcp-0d46. Last accessed on September 29, 2019.
# Condit, R., R. Prez, S. Aguilar, S. Lao, R. Foster, and S. Hubbell. 2019b. BCI 50-ha Plot Taxonomy, v4, DataONE, Dataset. doi: https://doi.org/10.15146/R3FH61. Last accessed on September 29, 2019.
# Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press, Oxford, UK.
# MullerLandau, H. C., et al. 2006. Comparing tropical forest tree size distributions with the predictions of metabolic ecology and equilibrium models. Ecology Letters 9:589-602.
```